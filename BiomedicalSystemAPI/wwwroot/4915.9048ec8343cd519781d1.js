"use strict";var jt=Object.defineProperty,Xt=Object.getOwnPropertySymbols,Kt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable,Vt=(Ft,bt,Y)=>bt in Ft?jt(Ft,bt,{enumerable:!0,configurable:!0,writable:!0,value:Y}):Ft[bt]=Y,Yt=(Ft,bt)=>{for(var Y in bt||(bt={}))Kt.call(bt,Y)&&Vt(Ft,Y,bt[Y]);if(Xt)for(var Y of Xt(bt))$t.call(bt,Y)&&Vt(Ft,Y,bt[Y]);return Ft};(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[4915],{17873:(Ft,bt,Y)=>{Y.d(bt,{Z:()=>mt});const Q=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xab","\xbb"],["\xbb","\xab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],G=["\u0622","\u0623","\u0625","\u0627"],q=["\ufef5","\ufef7","\ufef9","\ufefb"],lt=["\ufef6","\ufef8","\ufefa","\ufefc"],wt=["\u0627","\u0628","\u062a","\u062b","\u062c","\u062d","\u062e","\u062f","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063a","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u06cc","\u0626","\u0624"],vt=["\ufe8d","\ufe8f","\ufe95","\ufe99","\ufe9d","\ufea1","\ufea5","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb1","\ufeb5","\ufeb9","\ufebd","\ufec1","\ufec5","\ufec9","\ufecd","\ufed1","\ufed5","\ufed9","\ufedd","\ufee1","\ufee5","\ufee9","\ufeed","\ufef1","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfc","\ufe89","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe89","\ufe85"],At=["\ufe8e","\ufe90","\ufe96","\ufe9a","\ufe9e","\ufea2","\ufea6","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb2","\ufeb6","\ufeba","\ufebe","\ufec2","\ufec6","\ufeca","\ufece","\ufed2","\ufed6","\ufeda","\ufede","\ufee2","\ufee6","\ufeea","\ufeee","\ufef2","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbfd","\ufe8a","\ufe86","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8a","\ufe86"],D=["\ufe8e","\ufe92","\ufe98","\ufe9c","\ufea0","\ufea4","\ufea8","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb4","\ufeb8","\ufebc","\ufec0","\ufec4","\ufec8","\ufecc","\ufed0","\ufed4","\ufed8","\ufedc","\ufee0","\ufee4","\ufee8","\ufeec","\ufeee","\ufef4","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbff","\ufe8c","\ufe86","\ufe71","\ufe72","\ufe74","\ufe77","\ufe79","\ufe7b","\ufe7d","\ufe7f","\ufe80","\ufe8c","\ufe86"],F=["\ufe8d","\ufe91","\ufe97","\ufe9b","\ufe9f","\ufea3","\ufea7","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb3","\ufeb7","\ufebb","\ufebf","\ufec3","\ufec7","\ufecb","\ufecf","\ufed3","\ufed7","\ufedb","\ufedf","\ufee3","\ufee7","\ufeeb","\ufeed","\ufef3","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfe","\ufe8b","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8b","\ufe85"],st=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062f","\u0630","\u0631","\u0632","\u0648","\u0649"],it=["\u064b","\u064b","\u064c","\u061f","\u064d","\u061f","\u064e","\u064e","\u064f","\u064f","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062a","\u062a","\u062a","\u062a","\u062b","\u062b","\u062b","\u062b","\u062c","\u062c","\u062c","\u062c","\u062d","\u062d","\u062d","\u062d","\u062e","\u062e","\u062e","\u062e","\u062f","\u062f","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063a","\u063a","\u063a","\u063a","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064a","\u064a","\u064a","\u064a","\ufef5","\ufef6","\ufef7","\ufef8","\ufef9","\ufefa","\ufefb","\ufefc","\u061f","\u061f","\u061f"],ot=["\u0621","\u0641"],ht=["\u063a","\u064a"],gt=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Ct=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],E=10,L=11,u=12,M=18,R=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],j=100,z=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],Z=[[M,M,M,M,M,M,M,M,M,6,5,6,8,5,M,M,M,M,M,M,M,M,M,M,M,M,M,M,5,5,5,6,8,4,4,L,L,L,4,4,4,4,4,E,9,E,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,M,M,M,M,M,M,5,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,M,9,4,L,L,L,L,4,4,4,4,0,4,4,M,4,4,L,L,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,1,u,1,u,u,1,u,u,1,u,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,L,L,7,9,7,4,4,u,u,u,u,u,u,u,u,u,u,u,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,3,3,3,3,3,3,3,3,3,3,L,3,3,7,7,7,u,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,u,u,u,u,u,u,u,3,4,u,u,u,u,u,u,7,7,u,u,4,u,u,u,u,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,u,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,u,u,u,u,u,u,u,u,u,u,u,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,u,u,u,u,u,u,u,u,u,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,M,M,M,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,L,L,L,L,L,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,M,M,M,M,M,4,4,4,4,4,M,M,M,M,M,M,2,0,4,4,2,2,2,2,2,2,E,E,4,4,4,0,2,2,2,2,2,2,2,2,2,2,E,E,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,u,1,1,1,1,1,1,1,1,1,1,E,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,u,u,u,u,u,u,u,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,L,4,4,E,E,4,4,4,4,4,L,L,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,M],[4,4,4,L,L,L,4,4,4,4,4,E,9,E,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,L,L,4,4,4,L,L,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];class mt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(m,x,S){if(this.sourceToTarget=[],this.targetToSource=[],!m)return"";if(function(g,m,x){a=[],l=[];for(let S=0;S<x;S++)g[S]=S,m[S]=S,a[S]=S}(this.sourceToTarget,this.targetToSource,m.length),!this.checkParameters(x,S))return m;x=this.inputFormat,S=this.outputFormat;let W=m;const V=o,J=Dt(x.charAt(1)),$=Dt(S.charAt(1)),xt=("I"===x.charAt(0)?"L":x.charAt(0))+J,Lt=("I"===S.charAt(0)?"L":S.charAt(0))+$,Bt=x.charAt(2)+S.charAt(2);V.defInFormat=xt,V.defOutFormat=Lt,V.defSwap=Bt;const Ot=ut(m,xt,Lt,Bt,V);let Gt=!1;return"R"===S.charAt(1)?Gt=!0:"C"!==S.charAt(1)&&"D"!==S.charAt(1)||(Gt="rtl"===this.checkContextual(Ot)),this.sourceToTarget=a,this.targetToSource=function(g){const m=new Array(g.length);for(let x=0;x<g.length;x++)m[g[x]]=x;return m}(this.sourceToTarget),p=this.targetToSource,W=x.charAt(3)===S.charAt(3)?Ot:"S"===S.charAt(3)?function(g,m,x){if(0===m.length)return"";void 0===g&&(g=!0),void 0===x&&(x=!0);const S=(m=String(m)).split("");let W=0,V=1,J=S.length;g||(W=S.length-1,V=-1,J=1);const $=function(g,m,x,S,W){let V=0;const J=[];let $=0;for(let xt=m;xt*x<S;xt+=x)if(tt(g[xt])||Mt(g[xt])){if("\u0644"===g[xt]&&at(g,xt+x,x,S)){g[xt]=Ut(g[xt+x],0===V?q:lt),xt+=x,Ht(g,xt,x,S),W&&(J[$]=xt,$++),V=0;continue}const Lt=g[xt];1===V?g[xt]=et(g,xt+x,x,S)?Tt(g[xt]):Rt(g[xt],At):!0===et(g,xt+x,x,S)?g[xt]=Rt(g[xt],F):g[xt]=Rt(g[xt],vt),Mt(Lt)||(V=1),!0===pt(Lt)&&(V=0)}else V=0;return J}(S,W,V,J,x);let xt="";for(let Lt=0;Lt<S.length;Lt++)x&&A($,$.length,Lt)>-1?(i(p,Lt,!g,-1),a.splice(Lt,1)):xt+=S[Lt];return xt}(Gt,Ot,!0):function(g,m,x){if(0===g.length)return"";void 0===x&&(x=!0),void 0===m&&(m=!0);let S="";const W=(g=String(g)).split("");for(let V=0;V<g.length;V++){let J=!1;if(W[V]>="\ufe70"&&W[V]<"\ufeff"){const $=g.charCodeAt(V);W[V]>="\ufef5"&&W[V]<="\ufefc"?(m?(V>0&&x&&" "===W[V-1]?S=S.substring(0,S.length-1)+"\u0644":(S+="\u0644",J=!0),S+=G[($-65269)/2]):(S+=G[($-65269)/2],S+="\u0644",V+1<g.length&&x&&" "===W[V+1]?V++:J=!0),J&&(i(p,V,!0,1),a.splice(V,0,a[V]))):S+=it[$-65136]}else S+=W[V]}return S}(Ot,Gt,!0),this.sourceToTarget=a,this.targetToSource=p,this.levels=l,W}_inputFormatSetter(m){if(!v.test(m))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=m}_outputFormatSetter(m){if(!v.test(m))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=m}checkParameters(m,x){return m?this._inputFormatSetter(m):m=this.inputFormat,x?this._outputFormatSetter(x):x=this.outputFormat,m!==x}checkContextual(m){let x=ct(m);if("ltr"!==x&&"rtl"!==x){try{x=document.dir.toLowerCase()}catch(S){}"ltr"!==x&&"rtl"!==x&&(x="ltr")}return x}hasBidiChar(m){return N.test(m)}}function ut(g,m,x,S,W){const V=function(g,m,x){if(void 0===m.inFormat&&(m.inFormat=x.defInFormat),void 0===m.outFormat&&(m.outFormat=x.defOutFormat),void 0===m.swap&&(m.swap=x.defSwap),m.inFormat===m.outFormat)return m;const S=m.inFormat.substring(0,1),W=m.outFormat.substring(0,1);let V,J=m.inFormat.substring(1,4),$=m.outFormat.substring(1,4);return"C"===J.charAt(0)&&(V=ct(g),J="ltr"===V||"rtl"===V?V.toUpperCase():"L"===m.inFormat.charAt(2)?"LTR":"RTL",m.inFormat=S+J),"C"===$.charAt(0)&&(V=ct(g),"rtl"===V?$="RTL":"ltr"===V?(V=function(g){const m=g.split("");return m.reverse(),ct(m.join(""))}(g),$=V.toUpperCase()):$="L"===m.outFormat.charAt(2)?"LTR":"RTL",m.outFormat=W+$),m}(g,{inFormat:m,outFormat:x,swap:S},W);if(V.inFormat===V.outFormat)return g;m=V.inFormat,x=V.outFormat,S=V.swap;const J=m.substring(0,1),$=m.substring(1,4),xt=x.substring(0,1),Lt=x.substring(1,4);if(W.inFormat=m,W.outFormat=x,W.swap=S,"L"===J&&"VLTR"===x){if("LTR"===$)return W.dir=P,f(g,W);if("RTL"===$)return W.dir=b,f(g,W)}if("V"===J&&"V"===xt)return W.dir="RTL"===$?b:P,U(g,W);if("L"===J&&"VRTL"===x)return"LTR"===$?(W.dir=P,g=f(g,W)):(W.dir=b,g=f(g,W)),U(g);if("VLTR"===m&&"LLTR"===x)return W.dir=P,f(g,W);if("V"===J&&"L"===xt&&$!==Lt)return g=U(g),"RTL"===$?ut(g,"LLTR","VLTR",S,W):ut(g,"LRTL","VRTL",S,W);if("VRTL"===m&&"LRTL"===x)return ut(g,"LRTL","VRTL",S,W);if("L"===J&&"L"===xt){const Bt=W.swap;return W.swap=Bt.substr(0,1)+"N","RTL"===$?(W.dir=b,g=f(g,W),W.swap="N"+Bt.substr(1,2),W.dir=P,g=f(g,W)):(W.dir=P,g=f(g,W),W.swap="N"+Bt.substr(1,2),g=ut(g,"VLTR","LRTL",W.swap,W)),g}return g}function ct(g){const m=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(g);return m?m[0]<="z"?"ltr":"rtl":""}function f(g,m){const x=g.split(""),S=[];return T(x,S,m),function(g,m,x){if(0!==x.hiLevel&&x.swap.substr(0,1)!==x.swap.substr(1,2))for(let S=0;S<g.length;S++)1===m[S]&&(g[S]=It(g[S]))}(x,S,m),Et(2,x,S,m),Et(1,x,S,m),l=S,x.join("")}function T(g,m,x){const S=g.length,W=x.dir?Ct:gt;let V=0,J=-1;const $=[],xt=[];x.hiLevel=x.dir,x.lastArabic=!1,x.hasUbatAl=!1,x.hasUbatB=!1,x.hasUbatS=!1;for(let Lt=0;Lt<S;Lt++)$[Lt]=C(g[Lt]);for(let Lt=0;Lt<S;Lt++){const Bt=V,Ot=ft(g,$,xt,Lt,x);xt[Lt]=Ot,V=W[Bt][Ot];const Gt=240&V;V&=15;const Nt=W[V][d];if(m[Lt]=Nt,Gt>0)if(16===Gt){for(let Wt=J;Wt<Lt;Wt++)m[Wt]=1;J=-1}else J=-1;if(W[V][c])-1===J&&(J=Lt);else if(J>-1){for(let Wt=J;Wt<Lt;Wt++)m[Wt]=Nt;J=-1}5===$[Lt]&&(m[Lt]=0),x.hiLevel|=Nt}x.hasUbatS&&function(g,m,x,S){for(let W=0;W<x;W++)if(6===g[W]){m[W]=S.dir;for(let V=W-1;V>=0&&8===g[V];V--)m[V]=S.dir}}($,m,S,x)}function C(g){const m=g.charCodeAt(0),x=z[m>>8];return x<j?x:Z[x-j][255&m]}function U(g,m){const x=g.split("");if(m){const S=[];T(x,S,m),l=S}return x.reverse(),a.reverse(),x.join("")}function A(g,m,x){for(let S=0;S<m;S++)if(g[S]===x)return S;return-1}function tt(g){for(let m=0;m<ot.length;m++)if(g>=ot[m]&&g<=ht[m])return!0;return!1}function et(g,m,x,S){for(;m*x<S&&Mt(g[m]);)m+=x;return!!(m*x<S&&tt(g[m]))}function at(g,m,x,S){for(;m*x<S&&Mt(g[m]);)m+=x;let W=" ";if(!(m*x<S))return!1;W=g[m];for(let V=0;V<G.length;V++)if(G[V]===W)return!0;return!1}function Et(g,m,x,S){if(S.hiLevel<g)return;if(1===g&&S.dir===b&&!S.hasUbatB)return m.reverse(),void a.reverse();const W=m.length;let V,J,$,xt,Lt,Bt=0;for(;Bt<W;){if(x[Bt]>=g){for(V=Bt+1;V<W&&x[V]>=g;)V++;for(J=Bt,$=V-1;J<$;J++,$--)xt=m[J],m[J]=m[$],m[$]=xt,Lt=a[J],a[J]=a[$],a[$]=Lt;Bt=V}Bt++}}function ft(g,m,x,S,W){const V=m[S];return{UBAT_L:()=>(W.lastArabic=!1,0),UBAT_R:()=>(W.lastArabic=!1,1),UBAT_ON:()=>4,UBAT_AN:()=>3,UBAT_EN:()=>W.lastArabic?3:2,UBAT_AL:()=>(W.lastArabic=!0,W.hasUbatAl=!0,1),UBAT_WS:()=>4,UBAT_CS:()=>{let J,$;return S<1||S+1>=m.length||2!==(J=x[S-1])&&3!==J||2!==($=m[S+1])&&3!==$?4:(W.lastArabic&&($=3),$===J?$:4)},UBAT_ES:()=>2===(S>0?x[S-1]:5)&&S+1<m.length&&2===m[S+1]?2:4,UBAT_ET:()=>{if(S>0&&2===x[S-1])return 2;if(W.lastArabic)return 4;let J=S+1;const $=m.length;for(;J<$&&m[J]===L;)J++;return J<$&&2===m[J]?2:4},UBAT_NSM:()=>{if("VLTR"===W.inFormat){const J=m.length;let $=S+1;for(;$<J&&m[$]===u;)$++;if($<J){const xt=g[S].charCodeAt[0],Lt=xt>=1425&&xt<=2303||64286===xt,Bt=m[$];if(Lt&&(1===Bt||7===Bt))return 1}}return S<1||5===m[S-1]?4:x[S-1]},UBAT_B:()=>(W.lastArabic=!0,W.hasUbatB=!0,W.dir),UBAT_S:()=>(W.hasUbatS=!0,4),UBAT_LRE:()=>(W.lastArabic=!1,4),UBAT_RLE:()=>(W.lastArabic=!1,4),UBAT_LRO:()=>(W.lastArabic=!1,4),UBAT_RLO:()=>(W.lastArabic=!1,4),UBAT_PDF:()=>(W.lastArabic=!1,4),UBAT_BN:()=>4}[R[V]]()}function It(g){let m,x=0,S=Q.length-1;for(;x<=S;)if(m=Math.floor((x+S)/2),g<Q[m][0])S=m-1;else{if(!(g>Q[m][0]))return Q[m][1];x=m+1}return g}function pt(g){for(let m=0;m<st.length;m++)if(st[m]===g)return!0;return!1}function Tt(g){for(let m=0;m<wt.length;m++)if(g===wt[m])return D[m];return g}function Rt(g,m){for(let x=0;x<wt.length;x++)if(g===wt[x])return m[x];return g}function Mt(g){return g>="\u064b"&&g<="\u0655"}function Dt(g){return"L"===g?"LTR":"R"===g?"RTL":"C"===g?"CLR":"D"===g?"CRL":""}function Ht(g,m,x,S){for(;m*x<S&&Mt(g[m]);)m+=x;return m*x<S&&(g[m]=" ",!0)}function Ut(g,m){for(let x=0;x<G.length;x++)if(g===G[x])return m[x];return g}function i(g,m,x,S){for(let W=0;W<g.length;W++)(g[W]>m||!x&&g[W]===m)&&(g[W]+=S)}let a=[],p=[],l=[];const o={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},d=5,c=6,P=0,b=1,v=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,N=/[\u0591-\u06ff\ufb1d-\ufefc]/},40295:(Ft,bt,Y)=>{Y.d(bt,{E:()=>q});const G=new(Y(17873).Z);function q(lt){if(!G.hasBidiChar(lt))return[lt,!1];let wt;return wt="rtl"===G.checkContextual(lt)?"IDNNN":"ICNNN",[G.bidiTransform(lt,wt,"VLYSN"),!0]}},33821:(Ft,bt,Y)=>{Y.d(bt,{I:()=>G,v:()=>q});var Q=Y(88415);function G(D,F,st=0){const it=(0,Q.uZ)(D,0,vt);for(let ot=0;ot<4;ot++)F[st+ot]=Math.floor(256*At(it*lt[ot]))}function q(D,F=0){let st=0;for(let it=0;it<4;it++)st+=D[F+it]*wt[it];return st}const lt=[1,256,65536,16777216],wt=[1/256,1/65536,1/16777216,1/4294967296],vt=q(new Uint8ClampedArray([255,255,255,255]));function At(D){return D-Math.floor(D)}},30026:(Ft,bt,Y)=>{Y.d(bt,{zY:()=>K,v1:()=>w,GP:()=>lt,wp:()=>st,XV:()=>ht,zv:()=>Ct,QK:()=>gt,ov:()=>it,hh:()=>ot,qh:()=>n});var Q=Y(60161),G=Y(70279),q=Y(46495);function lt(e){const H=(0,Q.d9)(e);return function(e){e&&((0,G.oU)(e)?D(e.rings):(0,G.l9)(e)?D(e.paths):(0,G.aW)(e)&&At(e.points))}(H),H}function wt(e){if(e)for(let H=e.length-1;H>0;--H)e[H][0]-=e[H-1][0],e[H][1]-=e[H-1][1]}function vt(e){if(e)for(const H of e)wt(H)}function At(e){if(e){const H=e.length;for(let St=1;St<H;++St)e[St][0]+=e[St-1][0],e[St][1]+=e[St-1][1]}}function D(e){if(e)for(const H of e)At(H)}function st(e){e&&((0,G.oU)(e)?vt(e.rings):(0,G.l9)(e)?vt(e.paths):(0,G.aW)(e)&&wt(e.points))}function it(e){if(e)for(const H of e)ot(H)}function ot(e){e&&e.reverse()}function ht(e,H,St){return[e[0]+(H[0]-e[0])*St,e[1]+(H[1]-e[1])*St]}function gt(e){return!(!e||0===e.length)&&e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]}function Ct(e){return e[4]}function n(e,H){e[4]=H}class w{constructor(H,St,r,kt){this.acceptPolygon=St,this.acceptPolyline=r,this.geomUnitsPerPoint=kt,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1,H&&((0,G.oU)(H)?St&&(this.multiPath=H.rings,this.isClosed=!0):(0,G.l9)(H)?r&&(this.multiPath=H.paths,this.isClosed=!1):(0,G.YX)(H)&&St&&(this.multiPath=nt(H).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length)),this.internalPlacement=new q.u}next(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const H=this.processPath(this.multiPath[this.pathIndex]);if(H)return H}return this.pathCount=-1,this.pathIndex=-1,this.multiPath=null,null}}class K{constructor(H,St,r,kt){this.inputGeometries=H,this.acceptPolygon=St,this.acceptPolyline=r,this.geomUnitsPerPoint=kt,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1}next(){for(;;){if(!this.multiPath){let H=this.inputGeometries.next();for(;H;){if((0,G.oU)(H)?this.acceptPolygon&&(this.multiPath=H.rings,this.isClosed=!0):(0,G.l9)(H)?this.acceptPolyline&&(this.multiPath=H.paths,this.isClosed=!1):(0,G.YX)(H)&&this.acceptPolygon&&(this.multiPath=nt(H).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length,this.pathIndex=-1;break}H=this.inputGeometries.next()}if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const H=this.processPath(this.multiPath[this.pathIndex]);if(H)return H}this.pathCount=-1,this.pathIndex=-1,this.multiPath=null}}}function nt(e){return{rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}}},25781:(Ft,bt,Y)=>{Y.d(bt,{M:()=>G});Y(60161);class G{constructor(wt){this._geometry=wt}next(){const wt=this._geometry;return this._geometry=null,wt}}},42822:(Ft,bt,Y)=>{Y.d(bt,{h:()=>Ht,W:()=>Ut});var Q=Y(60161),G=Y(70279),q=Y(30026);class lt{static local(){return null===lt.instance&&(lt.instance=new lt),lt.instance}execute(s,i,a){return new wt(s,i,a)}}lt.instance=null;class wt{constructor(s,i,a){this._inputGeometries=s,this._angleTolerance=void 0!==i.angleTolerance?i.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let s=this._inputGeometries.next();for(;s;){if((0,G.oU)(s)){this._isClosed=!0;const i=(0,Q.d9)(s);return this._processMultipath(i.rings),i}if((0,G.l9)(s)){this._isClosed=!1;const i=(0,Q.d9)(s);return this._processMultipath(i.paths),i}if((0,G.YX)(s)){if(this._maxCosAngle)return s;this._isClosed=!0;const i=[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]];return this._processPath(i),{rings:[i]}}s=this._inputGeometries.next()}return null}_processMultipath(s){if(s)for(const i of s)this._processPath(i)}_processPath(s){if(s){let i,a,p,l,o,d,c=s.length,P=s[0];this._isClosed&&++c;for(let b=1;b<c;++b){let v;v=this._isClosed&&b===c-1?s[0]:s[b];const N=v[0]-P[0],g=v[1]-P[1],m=Math.sqrt(N*N+g*g);b>1&&m>0&&p>0&&(i*N+a*g)/m/p<=this._maxCosAngle&&(0,q.qh)(P,1),1===b&&(l=N,o=g,d=m),m>0&&(P=v,i=N,a=g,p=m)}this._isClosed&&p>0&&d>0&&(i*l+a*o)/d/p<=this._maxCosAngle&&(0,q.qh)(s[0],1)}}}const vt=.03;class At{constructor(){this._path=[]}path(){return this._path}addPath(s,i){i||s.reverse(),Array.prototype.push.apply(this._path,s),i||s.reverse()}static mergePath(s,i){i&&Array.prototype.push.apply(s,i)}startPath(s){this._path.push(s)}lineTo(s){this._path.push(s)}close(){const s=this._path;s.length>1&&(s[0][0]===s[s.length-1][0]&&s[0][1]===s[s.length-1][1]||s.push([s[0][0],s[0][1]]))}}class D{constructor(s=0,i=!1){}normalize(s){const i=Math.sqrt(s[0]*s[0]+s[1]*s[1]);s[0]/=i,s[1]/=i}calculateLength(s,i){const a=i[0]-s[0],p=i[1]-s[1];return Math.sqrt(a*a+p*p)}calculateSegLength(s,i){return this.calculateLength(s[i],s[i+1])}calculatePathLength(s){let i=0;const a=s?s.length:0;for(let p=0;p<a-1;++p)i+=this.calculateSegLength(s,p);return i}calculatePathArea(s){let i=0;const a=s?s.length:0;for(let p=0;p<a-1;++p)i+=(s[p+1][0]-s[p][0])*(s[p+1][1]+s[p][1]);return i/2}getCoord2D(s,i,a){return[s[0]+(i[0]-s[0])*a,s[1]+(i[1]-s[1])*a]}getSegCoord2D(s,i,a){return this.getCoord2D(s[i],s[i+1],a)}getAngle(s,i,a){const p=i[0]-s[0],l=i[1]-s[1];return Math.atan2(l,p)}getSegAngle(s,i,a){return this.getAngle(s[i],s[i+1],a)}getAngleCS(s,i,a){const p=i[0]-s[0],l=i[1]-s[1],o=Math.sqrt(p*p+l*l);return o>0?[p/o,l/o]:[1,0]}getSegAngleCS(s,i,a){return this.getAngleCS(s[i],s[i+1],a)}cut(s,i,a,p){return[a<=0?s[i]:this.getSegCoord2D(s,i,a),p>=1?s[i+1]:this.getSegCoord2D(s,i,p)]}addSegment(s,i,a){a&&s.push(i[0]),s.push(i[1])}getSubCurve(s,i,a){const p=[];return this.appendSubCurve(p,s,i,a)?p:null}appendSubCurve(s,i,a,p){const l=i?i.length-1:0;let o=0,d=!0,c=0;for(;c<l;){const P=this.calculateSegLength(i,c);if(0!==P){if(d){if(o+P>a){const b=(a-o)/P;let v=1,N=!1;o+P>=p&&(v=(p-o)/P,N=!0);const g=this.cut(i,c,b,v);if(g&&this.addSegment(s,g,d),N)break;d=!1}}else{if(o+P>p){const b=this.cut(i,c,0,(p-o)/P);b&&this.addSegment(s,b,d);break}this.addSegment(s,[i[c],i[c+1]],d)}o+=P,++c}else++c}return!0}getCIMPointAlong(s,i){const a=s?s.length-1:0;let p=0,l=-1;for(;l<a;){++l;const o=this.calculateSegLength(s,l);if(0!==o){if(p+o>i){const d=(i-p)/o;return this.getCoord2D(s[l],s[l+1],d)}p+=o}}return null}isEmpty(s,i){if(!s||s.length<=1)return!0;const a=s?s.length-1:0;let p=-1;for(;p<a;)if(++p,s[p+1][0]!==s[p][0]||s[p+1][1]!==s[p][1]||i&&s[p+1][2]!==s[p][2])return!1;return!0}offset(s,i,a,p,l){if(!s||s.length<2)return null;let o=0,d=s[o++],c=o;for(;o<s.length;){const N=s[o];N[0]===d[0]&&N[1]===d[1]||(o!==c&&(s[c]=s[o]),d=s[c++]),o++}const P=s[0][0]===s[c-1][0]&&s[0][1]===s[c-1][1];if(P&&--c,c<(P?3:2))return null;const b=[];d=P?s[c-1]:null;let v=s[0];for(let N=0;N<c;N++){const g=N===c-1?P?s[0]:null:s[N+1];if(d)if(g){const m=[g[0]-v[0],g[1]-v[1]];this.normalize(m);const x=[v[0]-d[0],v[1]-d[1]];this.normalize(x);const S=x[0]*m[1]-x[1]*m[0],W=x[0]*m[0]+x[1]*m[1];if(S>=0==i<=0){if(W<1){const V=[m[0]-x[0],m[1]-x[1]];this.normalize(V);const J=Math.sqrt((1+W)/2);if(J>1/p){const $=-Math.abs(i)/J;b.push([v[0]-V[0]*$,v[1]-V[1]*$])}}}else switch(a){case"Mitered":{const V=Math.sqrt((1+W)/2);if(V>0&&1/V<p){const J=[m[0]-x[0],m[1]-x[1]];this.normalize(J);const $=Math.abs(i)/V;b.push([v[0]-J[0]*$,v[1]-J[1]*$]);break}}case"Bevelled":b.push([v[0]+x[1]*i,v[1]-x[0]*i]),b.push([v[0]+m[1]*i,v[1]-m[0]*i]);break;case"Rounded":if(W<1){b.push([v[0]+x[1]*i,v[1]-x[0]*i]);const V=Math.floor(2.5*(1-W));if(V>0){const J=1/V;let $=J;for(let xt=1;xt<V;xt++,$+=J){const Lt=[x[1]*(1-$)+m[1]*$,-x[0]*(1-$)-m[0]*$];this.normalize(Lt),b.push([v[0]+Lt[0]*i,v[1]+Lt[1]*i])}}b.push([v[0]+m[1]*i,v[1]-m[0]*i])}break;default:if(S<0)b.push([v[0]+(x[1]+x[0])*i,v[1]+(x[1]-x[0])*i]),b.push([v[0]+(m[1]-m[0])*i,v[1]-(m[0]+m[1])*i]);else{const V=Math.sqrt((1+Math.abs(W))/2),J=[m[0]-x[0],m[1]-x[1]];this.normalize(J);const $=i/V;b.push([v[0]-J[0]*$,v[1]-J[1]*$])}}}else{const m=[v[0]-d[0],v[1]-d[1]];this.normalize(m),b.push([v[0]+m[1]*i,v[1]-m[0]*i])}else{const m=[g[0]-v[0],g[1]-v[1]];this.normalize(m),b.push([v[0]+m[1]*i,v[1]-m[0]*i])}d=v,v=g}return b.length<(P?3:2)?null:(P&&b.push([b[0][0],b[0][1]]),b)}}const F=1.7320508075688772;class ot{static local(){return null===ot.instance&&(ot.instance=new ot),ot.instance}execute(s,i,a){return new ht(s,i,a)}}ot.instance=null;class ht extends q.zY{constructor(s,i,a){super(s,!1,!0),this._curveHelper=new D,this._width=(void 0!==i.width?i.width:5)*a,this._arrowType=void 0!==i.geometricEffectArrowType?i.geometricEffectArrowType:"OpenEnded",this._offsetFlattenError=vt*a}processPath(s){switch(this._arrowType){case"OpenEnded":default:return this._constructSimpleArrow(s,!0);case"Block":return this._constructSimpleArrow(s,!1);case"Crossed":return this._constructCrossedArrow(s)}}_constructSimpleArrow(s,i){const a=this._curveHelper.calculatePathLength(s);let p=this._width;a<2*p&&(p=a/2);const l=this._curveHelper.getSubCurve(s,0,a-p);if(!l)return null;const o=p/2;if(this._curveHelper.isEmpty(l,!1))return null;const d=this._constructOffset(l,-o);if(!d)return null;const c=this._constructOffset(l,o);if(!c)return null;const P=this._constructArrowBasePoint(d,-o/2);if(!P)return null;const b=this._constructArrowBasePoint(c,o/2);if(!b)return null;const v=s[s.length-1];i||(this._makeControlPoint(c,!0),this._makeControlPoint(d,!0));const N=new At;return N.addPath(c,!0),N.lineTo(b),this._makeControlPoint(N.path()),N.lineTo(v),this._makeControlPoint(N.path()),N.lineTo(P),this._makeControlPoint(N.path()),N.addPath(d,!1),i?{paths:[N.path()]}:(N.close(),{rings:[N.path()]})}_constructCrossedArrow(s){const i=this._curveHelper.calculatePathLength(s);let a=this._width;i<a*(1+F+1)&&(a=i/(1+F+1));const p=this._curveHelper.getSubCurve(s,0,i-a*(1+F));if(!p)return null;const l=a/2;if(this._curveHelper.isEmpty(p,!1))return null;const o=this._constructOffset(p,l);if(!o)return null;const d=this._constructOffset(p,-l);if(!d)return null;const c=this._curveHelper.getSubCurve(s,0,i-a);if(!c||this._curveHelper.isEmpty(c,!1))return null;const P=this._constructOffset(c,l);if(!P)return null;const b=this._constructOffset(c,-l);if(!b)return null;const v=P[P.length-1],N=this._constructArrowBasePoint(P,l/2);if(!N)return null;const g=b[b.length-1],m=this._constructArrowBasePoint(b,-l/2);if(!m)return null;const x=s[s.length-1];this._makeControlPoint(o,!1),this._makeControlPoint(d,!1);const S=new At;return S.addPath(o,!0),this._makeControlPoint(S.path()),S.lineTo(g),S.lineTo(m),this._makeControlPoint(S.path()),S.lineTo(x),this._makeControlPoint(S.path()),S.lineTo(N),this._makeControlPoint(S.path()),S.lineTo(v),this._makeControlPoint(S.path()),S.addPath(d,!1),{paths:[S.path()]}}_constructOffset(s,i){return this._curveHelper.offset(s,i,"Rounded",4,this._offsetFlattenError)}_constructArrowBasePoint(s,i){if(!s||s.length<2)return null;const a=s[s.length-2],p=s[s.length-1],l=[p[0]-a[0],p[1]-a[1]];return this._curveHelper.normalize(l),[p[0]+l[1]*i,p[1]-l[0]*i]}_makeControlPoint(s,i=!1){(0,q.qh)(i?s[0]:s[s.length-1],1)}}class gt{static local(){return null===gt.instance&&(gt.instance=new gt),gt.instance}execute(s,i,a){return new Ct(s,i,a)}}gt.instance=null;class Ct{constructor(s,i,a){this._inputGeometries=s,this._curveHelper=new D,this._size=(void 0!==i.size?i.size:1)*a,this._offsetFlattenError=vt*a}next(){let s=this._inputGeometries.next();for(;s;){if((0,G.YX)(s))if(this._size>0){const i=[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]],a=this._curveHelper.offset(i,this._size,"Rounded",4,this._offsetFlattenError);if(a)return{rings:[a]}}else{if(!(this._size<0))return s;if(Math.min(s.xmax-s.xmin,s.ymax-s.ymin)+2*this._size>0)return{xmin:s.xmin-this._size,xmax:s.xmax+this._size,ymin:s.ymin-this._size,ymax:s.ymax+this._size}}if((0,G.oU)(s)){if(0===this._size)return s;const i=[];for(const a of s.rings){const p=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError);p&&i.push(p)}if(i.length)return{rings:i}}if((0,G.l9)(s)&&this._size>0){const i=[];for(const a of s.paths)if(a&&a.length>1){const p=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError),l=this._curveHelper.offset(a,-this._size,"Rounded",4,this._offsetFlattenError);if(p&&l){for(let o=l.length-1;o>=0;o--)p.push(l[o]);p.push([p[0][0],p[0][1]]),i.push(p)}}if(i.length)return{rings:i}}(0,G.wp)(s)&&this._size,s=this._inputGeometries.next()}return null}}class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(s,i,a){return new w(s,i,a)}}n.instance=null;class w{constructor(s,i,a){var p;this._default_point_size=20,this._inputGeometries=s,this._geomUnitsPerPoint=a,this._rule=null!=(p=i.rule)?p:"FullGeometry",this._default_size=this._default_point_size*a}next(){let s;for(;s=this._inputGeometries.next();){let i;if((0,G.wp)(s)?i=this._processGeom([[[s.x,s.y]]]):(0,G.aW)(s)?i=this._processGeom([s.points]):(0,G.l9)(s)?i=this._processGeom(s.paths):(0,G.oU)(s)&&(i=this._processGeom(s.rings)),i&&i.length)return{paths:i}}return null}_clone(s){return[s[0],s[1]]}_mid(s,i){return[(s[0]+i[0])/2,(s[1]+i[1])/2]}_mix(s,i,a,p){return[s[0]*i+a[0]*p,s[1]*i+a[1]*p]}_add(s,i){return[s[0]+i[0],s[1]+i[1]]}_add2(s,i,a){return[s[0]+i,s[1]+a]}_sub(s,i){return[s[0]-i[0],s[1]-i[1]]}_dist(s,i){return Math.sqrt((s[0]-i[0])*(s[0]-i[0])+(s[1]-i[1])*(s[1]-i[1]))}_norm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}_normalize(s,i=1){const a=i/this._norm(s);s[0]*=a,s[1]*=a}_leftPerpendicular(s){const i=s[1],a=-s[0];s[0]=i,s[1]=a}_leftPerp(s){return[s[1],-s[0]]}_rightPerpendicular(s){const i=-s[1],a=s[0];s[0]=i,s[1]=a}_rightPerp(s){return[-s[1],s[0]]}_dotProduct(s,i){return s[0]*i[0]+s[1]*i[1]}_crossProduct(s,i){return-(s[0]*i[1]-s[1]*i[0])}_rotateDirect(s,i,a){a=-a;const p=s[0]*i-s[1]*a,l=s[0]*a+s[1]*i;s[0]=p,s[1]=l}_makeCtrlPt(s){const i=[s[0],s[1]];return(0,q.qh)(i,1),i}_addAngledTicks(s,i,a,p){const l=this._sub(a,i);this._normalize(l);const o=this._crossProduct(l,this._sub(p,i));let d;d=o>0?this._rightPerp(l):this._leftPerp(l);const c=Math.abs(o)/2,P=[];P.push([i[0]+(d[0]-l[0])*c,i[1]+(d[1]-l[1])*c]),P.push(i),P.push(a),P.push([a[0]+(d[0]+l[0])*c,a[1]+(d[1]+l[1])*c]),s.push(P)}_addBezier2(s,i,a,p,l){if(0==l--)return void s.push(p);const o=this._mid(i,a),d=this._mid(a,p),c=this._mid(o,d);this._addBezier2(s,i,o,c,l),this._addBezier2(s,c,d,p,l)}_addBezier3(s,i,a,p,l,o){if(0==o--)return void s.push(l);const d=this._mid(i,a),c=this._mid(a,p),P=this._mid(p,l),b=this._mid(d,c),v=this._mid(c,P),N=this._mid(b,v);this._addBezier3(s,i,d,b,N,o),this._addBezier3(s,N,v,P,l,o)}_add90DegArc(s,i,a,p,l){const o=null!=l?l:this._crossProduct(this._sub(a,i),this._sub(p,i))>0,d=this._mid(i,a),c=this._sub(d,i);o?this._leftPerpendicular(c):this._rightPerpendicular(c),d[0]+=c[0],d[1]+=c[1],this._addBezier3(s,i,this._mix(i,.33333,d,.66667),this._mix(a,.33333,d,.66667),a,4)}_addArrow(s,i,a){const p=i[0],l=i[1],o=i[i.length-1],d=this._sub(p,l);this._normalize(d);const c=this._crossProduct(d,this._sub(o,l)),P=.5*c,b=this._leftPerp(d),v=[o[0]-b[0]*c,o[1]-b[1]*c],N=i.length-1,g=[];g.push(a?[-b[0],-b[1]]:b);let m=[-d[0],-d[1]];for(let x=1;x<N-1;x++){const S=this._sub(i[x+1],i[x]);this._normalize(S);const W=this._dotProduct(S,m),V=this._crossProduct(S,m),J=Math.sqrt((1+W)/2),$=this._sub(S,m);this._normalize($),$[0]/=J,$[1]/=J,g.push(V<0?[-$[0],-$[1]]:$),m=S}g.push(this._rightPerp(m));for(let x=g.length-1;x>0;x--)s.push([i[x][0]+g[x][0]*P,i[x][1]+g[x][1]*P]);s.push([v[0]+g[0][0]*P,v[1]+g[0][1]*P]),s.push([v[0]+g[0][0]*c,v[1]+g[0][1]*c]),s.push(p),s.push([v[0]-g[0][0]*c,v[1]-g[0][1]*c]),s.push([v[0]-g[0][0]*P,v[1]-g[0][1]*P]);for(let x=1;x<g.length;x++)s.push([i[x][0]-g[x][0]*P,i[x][1]-g[x][1]*P])}_cp2(s,i,a){return s.length>=2?s[1]:this._add2(s[0],i*this._default_size,-a*this._default_size)}_cp3(s,i,a,p){if(s.length>=3)return s[2];const l=this._mix(s[0],1-a,i,a),o=this._sub(i,s[0]);return this._normalize(o),this._rightPerpendicular(o),[l[0]+o[0]*p*this._default_size,l[1]+o[1]*p*this._default_size]}_arrowPath(s){if(s.length>2)return s;const i=s[0],a=this._cp2(s,-4,0),p=this._sub(i,a);this._normalize(p);const l=this._rightPerp(p);return[i,a,[i[0]+(l[0]-p[0])*this._default_size,i[1]+(l[1]-p[1])*this._default_size]]}_arrowLastSeg(s){const i=s[0],a=this._cp2(s,-4,0);let p;if(s.length>=3)p=s[s.length-1];else{const l=this._sub(i,a);this._normalize(l);const o=this._rightPerp(l);p=[i[0]+(o[0]-l[0])*this._default_size,i[1]+(o[1]-l[1])*this._default_size]}return[a,p]}_processGeom(s){if(!s)return null;const i=[];for(const a of s){if(!a||0===a.length)continue;const p=a.length;let l=a[0];switch(this._rule){case"PerpendicularFromFirstSegment":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,4),c=[];c.push(d),c.push(this._mid(l,o)),i.push(c);break}case"ReversedFirstSegment":{const o=this._cp2(a,0,-1);i.push([o,l]);break}case"PerpendicularToSecondSegment":{const o=this._cp2(a,-4,1),d=this._cp3(a,o,.882353,-1.94),c=[];c.push(this._mid(o,d)),c.push(l),i.push(c);break}case"SecondSegmentWithTicks":{const o=this._cp2(a,-4,1),d=this._cp3(a,o,.882353,-1.94),c=this._sub(d,o);let P;P=this._crossProduct(c,this._sub(l,o))>0?this._rightPerp(P):this._leftPerp(c);const b=[];b.push([o[0]+(P[0]-c[0])/3,o[1]+(P[1]-c[1])/3]),b.push(o),b.push(d),b.push([d[0]+(P[0]+c[0])/3,d[1]+(P[1]+c[1])/3]),i.push(b);break}case"DoublePerpendicular":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,3),c=this._mid(l,o),P=this._sub(c,d);this._normalize(P);const b=this._crossProduct(P,this._sub(l,d));this._leftPerpendicular(P);const v=[];v.push(l),v.push([d[0]+P[0]*b,d[1]+P[1]*b]),i.push(v);const N=[];N.push([d[0]-P[0]*b,d[1]-P[1]*b]),N.push(o),i.push(N);break}case"OppositeToFirstSegment":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,3),c=this._mid(l,o),P=this._sub(c,d);this._normalize(P);const b=this._crossProduct(P,this._sub(l,d));this._leftPerpendicular(P);const v=[];v.push([d[0]+P[0]*b,d[1]+P[1]*b]),v.push([d[0]-P[0]*b,d[1]-P[1]*b]),i.push(v);break}case"TriplePerpendicular":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,4),c=this._mid(l,o),P=this._sub(c,d);this._normalize(P);const b=this._crossProduct(P,this._sub(l,d));this._leftPerpendicular(P);const v=[];v.push([d[0]+P[0]*b*.8,d[1]+P[1]*b*.8]),v.push([c[0]+.8*(l[0]-c[0]),c[1]+.8*(l[1]-c[1])]),i.push(v),i.push([d,c]);const N=[];N.push([d[0]-P[0]*b*.8,d[1]-P[1]*b*.8]),N.push([c[0]+.8*(o[0]-c[0]),c[1]+.8*(o[1]-c[1])]),i.push(N);break}case"HalfCircleFirstSegment":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,4),c=this._mid(l,o);let P=this._sub(o,l);const b=Math.cos(Math.PI/18),v=Math.sin(Math.PI/18),N=Math.sqrt((1+b)/2),g=Math.sqrt((1-b)/2),m=[];let x;this._crossProduct(P,this._sub(d,l))>0?(m.push(l),P=this._sub(l,c),x=o):(m.push(o),P=this._sub(o,c),x=l),this._rotateDirect(P,N,g),P[0]/=N,P[1]/=N;for(let S=1;S<=18;S++)m.push(this._add(c,P)),this._rotateDirect(P,b,v);m.push(x),i.push(m);break}case"HalfCircleSecondSegment":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,1,-1);let c=this._sub(l,o);this._normalize(c);const P=this._crossProduct(c,this._sub(d,o))/2;this._leftPerpendicular(c);const b=[o[0]+c[0]*P,o[1]+c[1]*P];c=this._sub(o,b);const v=Math.cos(Math.PI/18);let N=Math.sin(Math.PI/18);P>0&&(N=-N);const g=[o];for(let m=1;m<=18;m++)this._rotateDirect(c,v,N),g.push(this._add(b,c));i.push(g);break}case"HalfCircleExtended":{const o=this._cp2(a,0,-2),d=this._cp3(a,o,1,-1);let c;if(p>=4)c=a[3];else{const m=this._sub(l,o);c=this._add(d,m)}const P=this._dist(o,d)/2/.75,b=this._sub(o,l);this._normalize(b,P);const v=this._sub(d,c);this._normalize(v,P);const N=[c,d];i.push(N);const g=[this._clone(d)];this._addBezier3(g,d,this._add(d,v),this._add(o,b),o,4),g.push(l),i.push(g);break}case"OpenCircle":{const o=this._cp2(a,-2,0),d=this._sub(o,l),c=Math.cos(Math.PI/18),P=-Math.sin(Math.PI/18),b=[o];for(let v=1;v<=33;v++)this._rotateDirect(d,c,P),b.push(this._add(l,d));i.push(b);break}case"CoverageEdgesWithTicks":{const o=this._cp2(a,0,-1);let d,c;if(p>=3)d=a[2];else{const N=this._sub(o,l),g=this._leftPerp(N);d=[l[0]+g[0]-.25*N[0],l[1]+g[1]-.25*N[1]]}if(p>=4)c=a[3];else{const N=this._mid(l,o),g=this._sub(l,o);this._normalize(g),this._leftPerpendicular(g);const m=this._crossProduct(g,this._sub(d,N));this._rightPerpendicular(g),c=[d[0]+g[0]*m*2,d[1]+g[1]*m*2]}const P=this._sub(o,l);let b,v;b=this._crossProduct(P,this._sub(d,l))>0?this._rightPerp(P):this._leftPerp(P),v=[],v.push(d),v.push(l),v.push([l[0]+(b[0]-P[0])/3,l[1]+(b[1]-P[1])/3]),i.push(v),b=this._crossProduct(P,this._sub(c,o))>0?this._rightPerp(b):this._leftPerp(P),v=[],v.push([o[0]+(b[0]+P[0])/3,o[1]+(b[1]+P[1])/3]),v.push(o),v.push(c),i.push(v);break}case"GapExtentWithDoubleTicks":{const o=this._cp2(a,0,2),d=this._cp3(a,o,0,1);let c;if(p>=4)c=a[3];else{const P=this._sub(o,l);c=this._add(d,P)}this._addAngledTicks(i,l,o,this._mid(d,c)),this._addAngledTicks(i,d,c,this._mid(l,o));break}case"GapExtentMidline":{const o=this._cp2(a,2,0),d=this._cp3(a,o,0,1);let c;if(p>=4)c=a[3];else{const b=this._sub(o,l);c=this._add(d,b)}const P=[];P.push(this._mid(l,d)),P.push(this._mid(o,c)),i.push(P);break}case"Chevron":{const o=this._cp2(a,-1,-1);let d;if(p>=3)d=a[2];else{const c=this._sub(o,l);this._leftPerpendicular(c),d=this._add(l,c)}i.push([o,this._makeCtrlPt(l),d]);break}case"PerpendicularWithArc":{const o=this._cp2(a,0,-2),d=this._cp3(a,o,.5,-1);let c=this._sub(o,l);const P=this._norm(c);c[0]/=P,c[1]/=P;const b=this._crossProduct(c,this._sub(d,l));let v=this._dotProduct(c,this._sub(d,l));v<.05*P?v=.05*P:v>.95*P&&(v=.95*P);const N=[l[0]+c[0]*v,l[1]+c[1]*v];this._leftPerpendicular(c);let g=[];g.push([N[0]-c[0]*b,N[1]-c[1]*b]),g.push([N[0]+c[0]*b,N[1]+c[1]*b]),i.push(g);const m=[o[0]+c[0]*b,o[1]+c[1]*b];c=this._sub(o,m);const x=Math.cos(Math.PI/18);let S=Math.sin(Math.PI/18);b<0&&(S=-S),g=[l,o];for(let W=1;W<=9;W++)this._rotateDirect(c,x,S),g.push(this._add(m,c));i.push(g);break}case"ClosedHalfCircle":{const o=this._cp2(a,2,0),d=this._mid(l,o),c=this._sub(o,d),P=Math.cos(Math.PI/18),b=Math.sin(Math.PI/18),v=[l,o];for(let N=1;N<=18;N++)this._rotateDirect(c,P,b),v.push(this._add(d,c));i.push(v);break}case"TripleParallelExtended":{const o=this._cp2(a,0,-2),d=this._cp3(a,o,1,-2),c=this._mid(l,o),P=this._sub(d,o);this._normalize(P);const b=Math.abs(this._crossProduct(P,this._sub(c,o)))/2,v=this._dist(o,d),N=[o,l];N.push([l[0]+P[0]*v*.5,l[1]+P[1]*v*.5]),i.push(N);const g=[];g.push([c[0]-P[0]*b,c[1]-P[1]*b]),g.push([c[0]+P[0]*v*.375,c[1]+P[1]*v*.375]),(0,q.qh)(g[g.length-1],1),g.push([c[0]+P[0]*v*.75,c[1]+P[1]*v*.75]),i.push(g);const m=[o,d];i.push(m);break}case"ParallelWithTicks":{const o=this._cp2(a,3,0),d=this._cp3(a,o,.5,-1),c=this._sub(d,o);this._normalize(c);const P=this._crossProduct(c,this._sub(d,l));this._leftPerpendicular(c),this._addAngledTicks(i,l,o,d),this._addAngledTicks(i,this._mix(l,1,c,P),this._mix(o,1,c,P),this._mid(l,o));break}case"Parallel":{const o=this._cp2(a,3,0),d=this._cp3(a,o,.5,-1),c=this._sub(o,l);this._normalize(c);const P=this._leftPerp(c),b=this._crossProduct(c,this._sub(d,l));let v=[l,o];i.push(v),v=[],v.push([l[0]+P[0]*b,l[1]+P[1]*b]),v.push([o[0]+P[0]*b,o[1]+P[1]*b]),i.push(v);break}case"PerpendicularToFirstSegment":{const o=this._cp2(a,3,0),d=this._cp3(a,o,.5,-1),c=this._mid(l,o),P=this._sub(o,l);this._normalize(P);const b=this._crossProduct(P,this._sub(d,l));this._leftPerpendicular(P);const v=[];v.push([c[0]-P[0]*b*.25,c[1]-P[1]*b*.25]),v.push([c[0]+P[0]*b*1.25,c[1]+P[1]*b*1.25]),i.push(v);break}case"ParallelOffset":{const o=this._cp2(a,3,0),d=this._cp3(a,o,.5,-1),c=this._sub(o,l);this._normalize(c);const P=this._crossProduct(c,this._sub(d,l));this._leftPerpendicular(c);const b=[];b.push([l[0]-c[0]*P,l[1]-c[1]*P]),b.push([o[0]-c[0]*P,o[1]-c[1]*P]),i.push(b);const v=[];v.push([l[0]+c[0]*P,l[1]+c[1]*P]),v.push([o[0]+c[0]*P,o[1]+c[1]*P]),i.push(v);break}case"OffsetOpposite":{const o=this._cp2(a,3,0),d=this._cp3(a,o,.5,-1),c=this._sub(o,l);this._normalize(c);const P=this._crossProduct(c,this._sub(d,l));this._leftPerpendicular(c);const b=[];b.push([l[0]-c[0]*P,l[1]-c[1]*P]),b.push([o[0]-c[0]*P,o[1]-c[1]*P]),i.push(b);break}case"OffsetSame":{const o=this._cp2(a,3,0),d=this._cp3(a,o,.5,-1),c=this._sub(o,l);this._normalize(c);const P=this._crossProduct(c,this._sub(d,l));this._leftPerpendicular(c);const b=[];b.push([l[0]+c[0]*P,l[1]+c[1]*P]),b.push([o[0]+c[0]*P,o[1]+c[1]*P]),i.push(b);break}case"CircleWithArc":{let o=this._cp2(a,3,0);const d=this._cp3(a,o,.5,-1);let c,P;if(p>=4)c=a[3],P=this._crossProduct(this._sub(c,o),this._sub(d,o))>0;else{c=o,P=this._crossProduct(this._sub(c,l),this._sub(d,l))>0;const m=24*this._geomUnitsPerPoint,x=this._sub(c,l);this._normalize(x,m);const S=Math.sqrt(2)/2;this._rotateDirect(x,S,P?S:-S),o=this._add(l,x)}const b=this._sub(o,l),v=Math.cos(Math.PI/18),N=Math.sin(Math.PI/18),g=[o];for(let m=1;m<=36;m++)this._rotateDirect(b,v,N),g.push(this._add(l,b));this._add90DegArc(g,o,c,d,P),(0,q.qh)(g[g.length-8],1),i.push(g);break}case"DoubleJog":{let o,d,c=this._cp2(a,-3,1);if(o=p>=3?a[2]:this._add(l,this._sub(l,c)),p>=4)d=a[3];else{const W=l;l=c,d=o;const V=this._dist(l,W),J=this._dist(d,W);let $=30*this._geomUnitsPerPoint;.5*V<$&&($=.5*V),.5*J<$&&($=.5*J),c=this._mix(l,$/V,W,(V-$)/V),o=this._mix(d,$/J,W,(J-$)/J)}const P=this._mid(l,c),b=this._mid(d,o),v=this._dist(l,c),N=this._dist(o,d);let g=Math.min(v,N)/8;g=Math.min(g,24*this._geomUnitsPerPoint);const m=Math.cos(Math.PI/4);let x=this._sub(l,c);this._normalize(x,g),this._crossProduct(x,this._sub(d,c))>0?this._rotateDirect(x,m,-m):this._rotateDirect(x,m,m);let S=[];S.push(c),S.push(this._add(P,x)),S.push(this._sub(P,x)),S.push(l),i.push(S),x=this._sub(d,o),this._normalize(x,g),this._crossProduct(x,this._sub(l,o))<0?this._rotateDirect(x,m,m):this._rotateDirect(x,m,-m),S=[],S.push(o),S.push(this._add(b,x)),S.push(this._sub(b,x)),S.push(d),i.push(S);break}case"PerpendicularOffset":{const o=this._cp2(a,-4,1),d=this._cp3(a,o,.882353,-1.94),c=this._sub(d,o);this._crossProduct(c,this._sub(l,o))>0?this._rightPerpendicular(c):this._leftPerpendicular(c);const P=[c[0]/8,c[1]/8],b=this._sub(this._mid(o,d),P);i.push([b,l]);break}case"LineExcludingLastSegment":{const o=this._arrowPath(a),d=[];let c=o.length-2;for(;c--;)d.push(o[c]);i.push(d);break}case"MultivertexArrow":{const o=this._arrowPath(a),d=[];this._addArrow(d,o,!1),i.push(d);break}case"CrossedArrow":{const o=this._arrowPath(a),d=[];this._addArrow(d,o,!0),i.push(d);break}case"ChevronArrow":{const[o,d]=this._arrowLastSeg(a),c=10*this._geomUnitsPerPoint,P=this._sub(l,o);this._normalize(P);const b=this._crossProduct(P,this._sub(d,o)),v=this._leftPerp(P),N=[d[0]-v[0]*b*2,d[1]-v[1]*b*2],g=[];g.push([d[0]+P[0]*c,d[1]+P[1]*c]),g.push(l),g.push([N[0]+P[0]*c,N[1]+P[1]*c]),i.push(g);break}case"ChevronArrowOffset":{const[o,d]=this._arrowLastSeg(a),c=this._sub(l,o);this._normalize(c);const P=this._crossProduct(c,this._sub(d,o));this._leftPerpendicular(c);const b=[d[0]-c[0]*P,d[1]-c[1]*P],v=[];v.push([b[0]+c[0]*P*.5,b[1]+c[1]*P*.5]),v.push(this._mid(b,l)),v.push([b[0]-c[0]*P*.5,b[1]-c[1]*P*.5]),i.push(v);break}case"PartialFirstSegment":{const[o,d]=this._arrowLastSeg(a),c=this._sub(l,o);this._normalize(c);const P=this._crossProduct(c,this._sub(d,o));this._leftPerpendicular(c);const b=[d[0]-c[0]*P,d[1]-c[1]*P];i.push([o,b]);break}case"Arch":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,1),c=this._sub(l,o),P=this._mix(d,1,c,.55),b=this._mix(d,1,c,-.55),v=[l];this._addBezier2(v,l,P,d,4),this._addBezier2(v,d,b,o,4),i.push(v);break}case"CurvedParallelTicks":{const o=this._cp2(a,-4,1),d=this._cp3(a,o,.882353,-1.94),c=this._sub(d,o);this._crossProduct(c,this._sub(l,o))>0?this._rightPerpendicular(c):this._leftPerpendicular(c);const P=[c[0]/8,c[1]/8],b=this._sub(this._mid(o,d),P),v=this._sub(this._mix(o,.75,d,.25),P),N=this._sub(this._mix(o,.25,d,.75),P),g=[o];this._addBezier2(g,o,v,b,3),this._addBezier2(g,b,N,d,3),i.push(g);for(let m=0;m<8;m++){const x=g[2*m+1],S=[this._clone(x)];S.push(this._add(x,[c[0]/4,c[1]/4])),i.push(S)}break}case"Arc90Degrees":{const o=this._cp2(a,0,-1),d=this._cp3(a,o,.5,1),c=[o];this._add90DegArc(c,o,l,d),i.push(c);break}default:i.push(a)}}return i}}class K{static local(){return null===K.instance&&(K.instance=new K),K.instance}execute(s,i,a){return new nt(s,i,a)}}K.instance=null;class nt extends q.zY{constructor(s,i,a){super(s,!0,!0),this._curveHelper=new D,this._beginCut=(void 0!==i.beginCut?i.beginCut:1)*a,this._endCut=(void 0!==i.endCut?i.endCut:1)*a,this._middleCut=(void 0!==i.middleCut?i.middleCut:0)*a,this._invert=void 0!==i.invert&&i.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(s){const i=this._beginCut,a=this._endCut,p=this._middleCut,l=this._curveHelper.calculatePathLength(s),o=[];if(this._invert){if(0!==i||0!==a||0!==p)if(i+a+p>=l)o.push(s);else{let d=this._curveHelper.getSubCurve(s,0,i);d&&o.push(d),d=this._curveHelper.getSubCurve(s,.5*(l-p),.5*(l+p)),d&&o.push(d),d=this._curveHelper.getSubCurve(s,l-a,a),d&&o.push(d)}}else if(0===i&&0===a&&0===p)o.push(s);else if(!(i+a+p>=l))if(0===p){const d=this._curveHelper.getSubCurve(s,i,l-a);d&&o.push(d)}else{let d=this._curveHelper.getSubCurve(s,i,.5*(l-p));d&&o.push(d),d=this._curveHelper.getSubCurve(s,.5*(l+p),l-a),d&&o.push(d)}return 0===o.length?null:{paths:o}}}class H{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(s,i,a=!0){if(this._setEmpty(),!s||0===s.length)return!1;for(let p=0;p<s.length;p++){let l=Math.abs(s[p]);a&&l<1e-7&&(l=1e-7),this._values.push(l),this._length+=l}return i&&1&s.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(s){const i=this._values?this._values.length:0;for(let a=0;a<i;++a)this._values[a]*=s;this._length*=s,this.extPtGap*=s,this.ctrlPtGap*=s}addValue(s){this._length+=s,this._values.push(s)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class St{constructor(){this.reset()}reset(){this.segment=-1,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return-1!==this.segment}copyTo(s){s.segment=this.segment,s.segmentLength=this.segmentLength,s.abscissa=this.abscissa,s.isPathEnd=this.isPathEnd,s.isPartEnd=this.isPartEnd}}class r extends D{constructor(s=0,i=!1){super(s,i),this._tolerance=vt,this._currentPosition=new St}updateTolerance(s){this._tolerance=vt*s}init(s,i,a=!0){return a?(this._patternLength=i.length(),this._partExtPtGap=i.extPtGap,this._partCtrlPtGap=i.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._path=s,this._seg=-1,this.setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(s,i=0){const a=new St;return!!this._nextPosition(s,a,null,i)&&(a.copyTo(this._currentPosition),!0)}curPointAndAngle(s){s.pt=this._getPoint(this._currentPosition);const[i,a]=this._getAngle(this._currentPosition);s.ca=i,s.sa=a}nextPointAndAngle(s,i,a=0){const p=new St;if(!this._nextPosition(s,p,null,a))return!1;p.copyTo(this._currentPosition),i.pt=this._getPoint(p);const[l,o]=this._getAngle(p);return i.ca=l,i.sa=o,!0}nextCurve(s){if(0===s)return null;const i=[],a=new St;return this._nextPosition(s,a,i,1)?(a.copyTo(this._currentPosition),i):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){if(-1===this._currentPosition.segment)throw new Error("missing segment");return this._path[this._currentPosition.segment+1]}_nextPosition(s,i,a,p){if(this._currentPosition.isPathEnd)return!1;let l=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(l/=this._currentPosition.segmentLength),this._currentPosition.copyTo(i);i.abscissa+s*this._partLengthRatio>i.segmentLength+this._tolerance;){if(a){if(0===a.length)if(0===l){const d=this._path[i.segment];a.push([d[0],d[1]])}else a.push(this.getSegCoord2D(this._path,i.segment,l));const o=this._path[i.segment+1];a.push([o[0],o[1]])}if(l=0,s-=(i.segmentLength-i.abscissa)/this._partLengthRatio,this._partSegCount)i.segment=this.nextSegment(),i.segmentLength=this.calculateSegLength(this._path,i.segment),i.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart())return 0!==p&&(i.segmentLength=this.calculateSegLength(this._path,i.segment),i.isPartEnd=!0,1===p?(i.abscissa=i.segmentLength,i.isPathEnd=!0):i.abscissa=i.segmentLength+s,!0);this._currentPosition.copyTo(i)}}if(i.abscissa+=s*this._partLengthRatio,a){if(0===a.length)if(0===l){const d=this._path[i.segment];a.push([d[0],d[1]])}else a.push(this.getSegCoord2D(this._path,i.segment,l));const o=i.abscissa/i.segmentLength;if(1===o){const d=this._path[i.segment+1];a.push([d[0],d[1]])}else a.push(this.getSegCoord2D(this._path,i.segment,o))}return this._partSegCount||Math.abs(i.abscissa-i.segmentLength)<this._tolerance&&(i.isPathEnd=this._partIsLast,i.isPartEnd=!0),!0}_getPoint(s){if(-1===s.segment)throw new Error("missing segment");const i=s.segmentLength<=0?0:s.abscissa/s.segmentLength;return this.getSegCoord2D(this._path,s.segment,i)}_getAngle(s){if(-1===s.segment)throw new Error("missing segment");const i=s.segmentLength<=0?0:s.abscissa/s.segmentLength;return this.getSegAngleCS(this._path,s.segment,i)}setPosAtNextPart(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===(0,q.zv)(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}let s=this._partSegCount;for(;s;)this.previousSegment(),--s;this._currentPosition.segment=this.nextSegment(),this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const i=this.getStartPointIndex();this._ctrlPtBegin=1===(0,q.zv)(this._path[i]);let a=i+this._partSegCount+1;if(a>=this._path.length&&(a=0),this._ctrlPtEnd=1===(0,q.zv)(this._path[a]),this._patternLength>0){const p=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,l=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let o=Math.round((this._partLength-(p+l))/this._patternLength);o<=0&&(o=p+l>0?0:1),this._partLengthRatio=this._partLength/(p+l+o*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}hasNextSegment(){return this._seg<this._path.length-2}previousSegment(){return--this._seg}nextSegment(){return++this._seg}getStartPointIndex(){return this._seg}getEndPointIndex(){return this._seg+1}}class kt{static local(){return null===kt.instance&&(kt.instance=new kt),kt.instance}execute(s,i,a){return new _t(s,i,a)}}kt.instance=null;class _t extends q.zY{constructor(s,i,a){var p,l;super(s,!0,!0),this._walker=new r,this._walker.updateTolerance(a),this._endings=i.lineDashEnding,this._customDashPos=-(null!=(p=i.offsetAlongLine)?p:0)*a,this._offsetAtEnd=(null!=(l=i.customEndingOffset)?l:0)*a,this._pattern=new H,this._pattern.init(i.dashTemplate,!0),this._pattern.scale(a)}processPath(s){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[s]};if(!this.iteratePath){let p=!0;switch(this._endings){case"HalfPattern":case"HalfGap":default:this._pattern.extPtGap=0;break;case"FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case"FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case"NoConstraint":this.isClosed||(p=!1);break;case"Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const l=this._walker.calculatePathLength(s);if(this._pattern.isEmpty()||l<.1*this._pattern.length())return{paths:[s]};if(!this._walker.init(s,this._pattern,p))return{paths:[s]}}let i;if(this.iteratePath)i=this._pattern.nextValue();else{let p;switch(this._endings){case"HalfPattern":default:p=.5*this._pattern.firstValue();break;case"HalfGap":p=.5*-this._pattern.lastValue();break;case"FullGap":p=-this._pattern.lastValue();break;case"FullPattern":p=0;break;case"NoConstraint":case"Custom":p=-this._customDashPos}let l=p/this._pattern.length();l-=Math.floor(l),p=l*this._pattern.length(),this._pattern.reset(),i=this._pattern.nextValue();let o=!1;for(;p>=i;)p-=i,i=this._pattern.nextValue(),o=!o;i-=p,o?(this._walker.nextPosition(i),i=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(i),i=this._pattern.nextValue(),this._walker.nextPosition(i),i=this._pattern.nextValue())}let a=this._walker.nextCurve(i);return a?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),At.mergePath(a,this._firstCurve),this._firstCurve=null)):(i=this._pattern.nextValue(),!this._walker.nextPosition(i)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(a=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,a=this._firstCurve,this._firstCurve=null),{paths:[a]}}}class E{static local(){return null===E.instance&&(E.instance=new E),E.instance}execute(s,i,a){return new L(s,i,a)}}E.instance=null;class L{constructor(s,i,a){switch(this._inputGeometries=s,this._curveHelper=new D,this._width=(void 0!==i.width?i.width:2)*a,i.method){case"Mitered":default:this._method="Mitered";break;case"Bevelled":this._method="Bevelled";break;case"Rounded":case"TrueBuffer":this._method="Rounded";break;case"Square":this._method="Square"}this._option=i.option,this._offsetFlattenError=vt*a}next(){let s=this._inputGeometries.next();for(;s;){if((0,G.YX)(s)&&this._width>0){if(Math.min(s.xmax-s.xmin,s.ymax-s.ymin)-2*this._width<0)return s;const i=[];return i.push([[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]),i.push([[s.xmin+this._width,s.ymin+this._width],[s.xmax-this._width,s.ymin+this._width],[s.xmax-this._width,s.ymax-this._width],[s.xmin+this._width,s.ymax-this._width],[s.xmin+this._width,s.ymin+this._width]]),{rings:i}}if((0,G.oU)(s)&&this._width>0){const i=[];for(const a of s.rings){const p=this._curveHelper.calculatePathLength(a),l=this._curveHelper.offset(a,this._width,this._method,4,this._offsetFlattenError);l&&(p<0&&l.reverse(),i.push(l))}if(i.length)return{rings:i}}s=this._inputGeometries.next()}return null}}class u{static local(){return null===u.instance&&(u.instance=new u),u.instance}execute(s,i,a){return new rt(s,i,a)}}u.instance=null;class rt extends q.zY{constructor(s,i,a){super(s,!1,!0),this._curveHelper=new D,this._length=(void 0!==i.length?i.length:20)*a,this._angle=void 0!==i.angle?i.angle:225,this._position=void 0!==i.position?i.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(s){if(this._curveHelper.isEmpty(s,!1))return null;const i=s[0],a=s[s.length-1],p=[a[0]-i[0],a[1]-i[1]];this._curveHelper.normalize(p);const l=[i[0]+(a[0]-i[0])*this._position/100,i[1]+(a[1]-i[1])*this._position/100],o=Math.cos((90-this._angle)/180*Math.PI);let d=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(d=-d),this._mirror=!this._mirror,{paths:[[i,[l[0]-this._length/2*o,l[1]-this._length/2*d],[l[0]+this._length/2*o,l[1]+this._length/2*d],a]]}}}class X{static local(){return null===X.instance&&(X.instance=new X),X.instance}execute(s,i,a){return new h(s,i,a)}}X.instance=null;class h{constructor(s,i,a){this._inputGeometries=s,this._offsetX=void 0!==i.offsetX?i.offsetX*a:0,this._offsetY=void 0!==i.offsetY?-i.offsetY*a:0}next(){let s=this._inputGeometries.next();for(;s;){if((0,G.YX)(s))return{xmin:s.xmin+this._offsetX,xmax:s.xmax+this._offsetX,ymin:s.ymin+this._offsetY,ymax:s.ymax+this._offsetY};if((0,G.oU)(s)){const i=(0,Q.d9)(s);return this._moveMultipath(i.rings,this._offsetX,this._offsetY),i}if((0,G.l9)(s)){const i=(0,Q.d9)(s);return this._moveMultipath(i.paths,this._offsetX,this._offsetY),i}if((0,G.aW)(s)){const i=(0,Q.d9)(s);return this._movePath(i.points,this._offsetX,this._offsetY),i}if((0,G.wp)(s))return{x:s.x+this._offsetX,y:s.y+this._offsetY};s=this._inputGeometries.next()}return null}_moveMultipath(s,i,a){if(s)for(const p of s)this._movePath(p,i,a)}_movePath(s,i,a){if(s)for(const p of s)p[0]+=i,p[1]+=a}}class y{static local(){return null===y.instance&&(y.instance=new y),y.instance}execute(s,i,a,p){return new k(s,i,a,p)}}y.instance=null;class k{constructor(s,i,a,p){var l;this._inputGeometries=s,this._curveHelper=new D,this._offset=(null!=(l=i.offset)?l:1)*a,p||(this._offset=-this._offset),this._method=i.method,this._option=i.option,this._offsetFlattenError=vt*a}next(){let s=this._inputGeometries.next();for(;s;){if(0===this._offset)return s;if((0,G.YX)(s)){if("Rounded"===this._method&&this._offset>0){const i=[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]],a=this._curveHelper.offset(i,this._offset,this._method,4,this._offsetFlattenError);return a?{rings:[a]}:null}if(Math.min(s.xmax-s.xmin,s.ymax-s.ymin)+2*this._offset>0)return{xmin:s.xmin-this._offset,xmax:s.xmax+this._offset,ymin:s.ymin-this._offset,ymax:s.ymax+this._offset}}if((0,G.oU)(s)){const i=[];for(const a of s.rings){const p=this._curveHelper.offset(a,this._offset,this._method,4,this._offsetFlattenError);p&&i.push(p)}if(i.length)return{rings:i}}if((0,G.l9)(s)){const i=[];for(const a of s.paths){const p=this._curveHelper.offset(a,this._offset,this._method,4,this._offsetFlattenError);p&&i.push(p)}if(i.length)return{paths:i}}s=this._inputGeometries.next()}return null}}class M{static local(){return null===M.instance&&(M.instance=new M),M.instance}execute(s,i,a){return new R(s,i,a)}}M.instance=null;class R{constructor(s,i,a){this._inputGeometries=s,this._reverse=void 0===i.reverse||i.reverse}next(){let s=this._inputGeometries.next();for(;s;){if(!this._reverse)return s;if((0,G.l9)(s)){const i=(0,Q.d9)(s);return(0,q.ov)(i.paths),i}s=this._inputGeometries.next()}return null}}var ct,yt,j=Y(7401),z=Y(15783);class Z{static local(){return null===Z.instance&&(Z.instance=new Z),Z.instance}execute(s,i,a){return new mt(s,i,a)}}Z.instance=null;class mt{constructor(s,i,a){this._inputGeometries=s,this._rotateAngle=void 0!==i.angle?-i.angle*Math.PI/180:0}next(){let s=this._inputGeometries.next();for(;s;){if(0===this._rotateAngle)return s;const i=(0,j.Ue)();(0,z.$P)(i,s);const a=(i[2]+i[0])/2,p=(i[3]+i[1])/2;if((0,G.YX)(s)){const l={rings:[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]};return this._rotateMultipath(l.rings,a,p),l}if((0,G.oU)(s)){const l=(0,Q.d9)(s);return this._rotateMultipath(l.rings,a,p),l}if((0,G.l9)(s)){const l=(0,Q.d9)(s);return this._rotateMultipath(l.paths,a,p),l}if((0,G.aW)(s)){const l=(0,Q.d9)(s);return this._rotatePath(l.points,a,p),l}if((0,G.wp)(s))return s;s=this._inputGeometries.next()}return null}_rotateMultipath(s,i,a){if(s)for(const p of s)this._rotatePath(p,i,a)}_rotatePath(s,i,a){if(s){const p=Math.cos(this._rotateAngle),l=Math.sin(this._rotateAngle);for(const o of s){const d=o[0]-i,c=o[1]-a;o[0]=i+d*p-c*l,o[1]=a+d*l+c*p}}}}class ut{static local(){return null===ut.instance&&(ut.instance=new ut),ut.instance}execute(s,i,a){return new dt(s,i,a)}}ut.instance=null;class dt{constructor(s,i,a){this._inputGeometries=s,this._xFactor=void 0!==i.xScaleFactor?i.xScaleFactor:1.15,this._yFactor=void 0!==i.yScaleFactor?i.yScaleFactor:1.15}next(){let s=this._inputGeometries.next();for(;s;){if(1===this._xFactor&&1===this._yFactor)return s;const i=(0,j.Ue)();(0,z.$P)(i,s);const a=(i[2]+i[0])/2,p=(i[3]+i[1])/2;if((0,G.YX)(s)){const l={rings:[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]};return this._scaleMultipath(l.rings,a,p),l}if((0,G.oU)(s)){const l=(0,Q.d9)(s);return this._scaleMultipath(l.rings,a,p),l}if((0,G.l9)(s)){const l=(0,Q.d9)(s);return this._scaleMultipath(l.paths,a,p),l}if((0,G.aW)(s)){const l=(0,Q.d9)(s);return this._scalePath(l.points,a,p),l}if((0,G.wp)(s))return s;s=this._inputGeometries.next()}return null}_scaleMultipath(s,i,a){if(s)for(const p of s)this._scalePath(p,i,a)}_scalePath(s,i,a){if(s)for(const p of s){const l=(p[0]-i)*this._xFactor,o=(p[1]-a)*this._yFactor;p[0]=i+l,p[1]=a+o}}}class Pt{static local(){return null===Pt.instance&&(Pt.instance=new Pt),Pt.instance}execute(s,i,a){return new zt(s,i,a)}}Pt.instance=null;class zt{constructor(s,i,a){this._inputGeometries=s,this._height=(void 0!==i.amplitude?i.amplitude:2)*a,this._period=(void 0!==i.period?i.period:3)*a,this._style=i.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new H,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new r,this._walker.updateTolerance(a)}next(){let s=this._inputGeometries.next();for(;s;){if(0===this._height||0===this._period)return s;if((0,G.l9)(s)){const i=this._processGeom(s.paths);if(i.length)return{paths:i}}if((0,G.oU)(s)){const i=this._processGeom(s.rings);if(i.length)return{rings:i}}s=this._inputGeometries.next()}return null}_processGeom(s){const i=[];for(const a of s)if(this._walker.init(a,this._pattern))switch(this._style){case"Sinus":default:i.push(this._constructCurve(a,!1));break;case"Square":i.push(this._constructSquare(a));break;case"Triangle":i.push(this._constructTriangle(a));break;case"Random":i.push(this._constructCurve(a,!0))}else i.push(a);return i}_constructCurve(s,i){const a=new At,p=this._walker.calculatePathLength(s);let l=Math.round(p/this._period);0===l&&(l=1);const o=16*l+1,d=p/l,c=this._period/16,P=1/o,b=2*Math.PI*p/d,v=2*Math.PI*Math.random(),N=2*Math.PI*Math.random(),g=2*Math.PI*Math.random(),m=.75-Math.random()/2,x=.75-Math.random()/2,S={};this._walker.curPointAndAngle(S),a.startPath(S.pt);let W=0;for(;;){if(!this._walker.nextPointAndAngle(c,S)){a.lineTo(s[s.length-1]);break}{const V=W;let J;if(W+=P,i){const $=this._height/2*(1+.3*Math.sin(m*b*V+v));J=$*Math.sin(b*V+N),J+=$*Math.sin(x*b*V+g),J/=2}else J=.5*this._height*Math.sin(.5*b*V);a.lineTo([S.pt[0]-J*S.sa,S.pt[1]+J*S.ca])}}return a.path()}_constructSquare(s){const i=new At,a=this._walker.calculatePathLength(s);Math.round(a/this._period);let p=!0;for(;;){let l=!1;if(this._walker.curPositionIsValid()){const o={};this._walker.curPointAndAngle(o);const d={};if(this._walker.nextPointAndAngle(this._period,d)){const c={};this._walker.nextPointAndAngle(this._period,c)&&(p?(i.startPath(o.pt),p=!1):i.lineTo(o.pt),i.lineTo([o.pt[0]-this._height/2*o.sa,o.pt[1]+this._height/2*o.ca]),i.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),i.lineTo([d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca]),i.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca]),l=!0)}}if(!l){i.lineTo(this._walker.getPathEnd());break}}return i.path()}_constructTriangle(s){const i=new At,a=this._walker.calculatePathLength(s);Math.round(a/this._period);let p=!0;for(;;){let l=!1;if(this._walker.curPositionIsValid()){const o={};this._walker.curPointAndAngle(o);const d={};if(this._walker.nextPointAndAngle(this._period/2,d)){const c={};this._walker.nextPointAndAngle(this._period,c)&&(this._walker.nextPosition(this._period/2)&&(p?(i.startPath(o.pt),p=!1):i.lineTo(o.pt),i.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),i.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca])),l=!0)}}if(!l){i.lineTo(this._walker.getPathEnd());break}}return i.path()}}(yt=ct||(ct={})).NoConstraint="NoConstraint",yt.WithMarkers="WithMarkers",yt.WithFullGap="WithFullGap",yt.WithHalfGap="WithHalfGap",yt.Custom="Custom";class O{static local(){return null===O.instance&&(O.instance=new O),O.instance}execute(s,i,a){return new _(s,i,a)}}O.instance=null;class _ extends q.v1{constructor(s,i,a){var p,l,o,d;super(s,!0,!0),this._geometryWalker=new r,this._geometryWalker.updateTolerance(a),this._angleToLine=null==(p=i.angleToLine)||p,this._offset=(null!=(l=i.offset)?l:0)*a,this._originalEndings=i.endings,this._offsetAtEnd=(null!=(o=i.customEndingOffset)?o:0)*a,this._position=-(null!=(d=i.offsetAlongLine)?d:0)*a,this._pattern=new H,this._pattern.init(i.placementTemplate,!1),this._pattern.scale(a),this._endings=this._originalEndings}processPath(s){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath)i=this._pattern.nextValue();else{this._originalEndings===ct.WithFullGap&&this.isClosed?this._endings=ct.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let p,l=!0;switch(this._endings){case ct.NoConstraint:p=-this._position,p=this._adjustPosition(p),l=!1;break;case ct.WithHalfGap:default:p=-this._pattern.lastValue()/2;break;case ct.WithFullGap:p=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case ct.WithMarkers:p=0;break;case ct.Custom:p=-this._position,p=this._adjustPosition(p),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(s,this._pattern,l))return null;this._pattern.reset();let o=0;for(;p>o;)p-=o,o=this._pattern.nextValue();o-=p,i=o,this.iteratePath=!0}const a={};return this._geometryWalker.nextPointAndAngle(i,a)?this._endings===ct.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===ct.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca),this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(s){let i=s/this._pattern.length();return i-=Math.floor(i),i*this._pattern.length()}}class f{static local(){return null===f.instance&&(f.instance=new f),f.instance}execute(s,i,a){return new T(s,i,a)}}f.instance=null;class T extends q.v1{constructor(s,i,a){super(s,!1,!0),this._curveHelper=new D,this._angleToLine=void 0===i.angleToLine||i.angleToLine,this._offset=void 0!==i.offset?i.offset*a:0,this._type=i.extremityPlacement,this._position=void 0!==i.offsetAlongLine?i.offsetAlongLine*a:0,this._beginProcessed=!1}processPath(s){let i;switch(this._type){case"Both":default:this._beginProcessed?(i=this._atExtremities(s,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(i=this._atExtremities(s,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case"JustBegin":i=this._atExtremities(s,this._position,!0);break;case"JustEnd":i=this._atExtremities(s,this._position,!1);case"None":}return i}_atExtremities(s,i,a){const p=s.length;if(p<2)return null;const l=a?1:p-2,o=a?p:-1,d=a?1:-1;let c,P=0,b=a?s[0]:s[p-1];for(let v=l;v!==o;v+=d){c=b,b=s[v];const N=this._curveHelper.calculateLength(c,b);if(P+N>i){const g=(i-P)/N,[m,x]=this._curveHelper.getAngleCS(c,b,g),S=(0,q.XV)(c,b,g);return this.internalPlacement.setTranslate(S[0]-this._offset*x,S[1]+this._offset*m),this._angleToLine&&this.internalPlacement.setRotateCS(-m,-x),this.internalPlacement}P+=N}return null}}class I{static local(){return null===I.instance&&(I.instance=new I),I.instance}execute(s,i,a){return new B(s,i,a)}}I.instance=null;class B extends q.v1{constructor(s,i,a){super(s,!0,!0),this._walker=new r,this._walker.updateTolerance(a),this._angleToLine=void 0===i.angleToLine||i.angleToLine,this._offset=void 0!==i.offset?i.offset*a:0,this._beginGap=void 0!==i.beginPosition?i.beginPosition*a:0,this._endGap=void 0!==i.endPosition?i.endPosition*a:0,this._flipFirst=void 0===i.flipFirst||i.flipFirst,this._pattern=new H,this._pattern.init(i.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(s){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath){const d=this._pattern.nextValue()*this._subPathLen,c=this._beginGap+d;i=c-this._prevPos,this._prevPos=c}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=this._walker.calculatePathLength(s)-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(s,this._pattern,!1))return null;this._pattern.reset();const d=this._pattern.nextValue()*this._subPathLen,c=this._beginGap+d;i=c-this._prevPos,this._prevPos=c,this.iteratePath=!0}const a={};if(!this._walker.nextPointAndAngle(i,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);const p=this._isFirst&&this._flipFirst;let l,o;return this._angleToLine?(l=a.ca,o=a.sa):(l=1,o=0),p&&(l=-l,o=-o),this.internalPlacement.setRotateCS(l,o),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}var C=Y(46495);class A{static local(){return null===A.instance&&(A.instance=new A),A.instance}execute(s,i,a){return new tt(s,i,a)}}A.instance=null;class tt{constructor(s,i,a){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._stepX=(void 0!==i.stepX?Math.abs(i.stepX):16)*a,this._stepY=(void 0!==i.stepY?Math.abs(i.stepY):16)*a,0!==this._stepX&&0!==this._stepY&&s&&function(yt){return void 0!==yt.rings}(s)&&s.rings){if(this._gridType=void 0!==i.gridType?i.gridType:"Fixed","Random"===this._gridType)this._randomness=void 0!==i.randomness?i.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0;else{if(this._randomness=0,this._gridAngle=void 0!==i.gridAngle?i.gridAngle:0,this._shiftOddRows=void 0!==i.shiftOddRows&&i.shiftOddRows,this._offsetX=void 0!==i.offsetX?i.offsetX*a:0,this._offsetY=void 0!==i.offsetY?i.offsetY*a:0,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginX=0,this._graphicOriginY=0,this._internalPlacement=new C.u,this._calculateMinMax(s),this._geometry=s}}next(){return this._geometry?this._nextInside():null}_calculateMinMax(s){let i,a,p,l,o,d,c,P;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,o=d=Number.MAX_VALUE,c=P=-Number.MAX_VALUE;for(const b of s.rings){const v=b?b.length:0;for(let N=0;N<v;++N)i=b[N][0]-this._graphicOriginX-this._offsetX,a=b[N][1]-this._graphicOriginY-this._offsetY,p=this._cosAngle*i-this._sinAngle*a,l=this._sinAngle*i+this._cosAngle*a,o=Math.min(o,p),c=Math.max(c,p),d=Math.min(d,l),P=Math.max(P,l)}o+=this._graphicOriginX,c+=this._graphicOriginX,d+=this._graphicOriginY,P+=this._graphicOriginY,this._xMin=Math.round(o/this._stepX),this._xMax=Math.round(c/this._stepX),this._yMin=Math.round(d/this._stepY),this._yMax=Math.round(P/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let s=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(s+=.5*this._stepX);const i=this._currentY*this._stepY+this._offsetY;let a,p;return this._currentX++,"Random"===this._gridType?(a=this._graphicOriginX+s+this._stepX*this._randomness*(.5-Math.random())*2/3,p=this._graphicOriginY+i+this._stepY*this._randomness*(.5-Math.random())*2/3):(a=this._graphicOriginX+this._cosAngle*s+this._sinAngle*i,p=this._graphicOriginY-this._sinAngle*s+this._cosAngle*i),this._internalPlacement.setTranslate(a,p),this._internalPlacement}}}class at{static local(){return null===at.instance&&(at.instance=new at),at.instance}execute(s,i,a){return new Et(s,i,a)}}at.instance=null;class Et extends q.v1{constructor(s,i,a){super(s,!0,!0),this._curveHelper=new D,this._angleToLine=void 0===i.angleToLine||i.angleToLine,this._offset=void 0!==i.offset?i.offset*a:0,this._relativeTo=i.relativeTo,this._position=void 0!==i.startPointOffset?i.startPointOffset*a:0,this._epsilon=.001*a}processPath(s){const i=this._position;if("SegmentMidpoint"===this._relativeTo){for(this.iteratePath||(this._segmentCount=s.length,this._curSegment=1,this.iteratePath=!0);this._curSegment<this._segmentCount;){const p=this._curSegment;this._curSegment++;const l=s[p-1],o=s[p],d=this._curveHelper.calculateLength(l,o);if(d<this._epsilon)continue;const c=.5+this._position/d,[P,b]=this._curveHelper.getAngleCS(l,o,c),v=(0,q.XV)(l,o,c);return this.internalPlacement.setTranslate(v[0]-this._offset*b,v[1]+this._offset*P),this._angleToLine&&this.internalPlacement.setRotateCS(P,b),this.internalPlacement}return this.iteratePath=!1,null}"LineEnd"===this._relativeTo&&(0,q.hh)(s);const a=this.onLine(s,i);return"LineEnd"===this._relativeTo&&(0,q.hh)(s),a}onLine(s,i){let a,p=!1;switch(this._relativeTo){case"LineMiddle":default:a=this._curveHelper.calculatePathLength(s)/2+i;break;case"LineBeginning":a=i;break;case"LineEnd":a=i,p=!0}const l=s.length;let o,d=0,c=s[0];for(let P=1;P<l;++P){o=c,c=s[P];const b=this._curveHelper.calculateLength(o,c);if(d+b>a){const v=(a-d)/b,[N,g]=this._curveHelper.getAngleCS(o,c,v),m=(0,q.XV)(o,c,v),x=p?this._offset:-this._offset;return this.internalPlacement.setTranslate(m[0]-x*g,m[1]+x*N),this._angleToLine&&(p?this.internalPlacement.setRotateCS(-N,-g):this.internalPlacement.setRotateCS(N,g)),this.internalPlacement}d+=b}return null}}class ft{static local(){return null===ft.instance&&(ft.instance=new ft),ft.instance}execute(s,i,a){return new pt(s,i,a)}}ft.instance=null;class pt extends q.v1{constructor(s,i,a){super(s,!0,!0),this._curveHelper=new D,this._angleToLine=void 0===i.angleToLine||i.angleToLine,this._offset=void 0!==i.offset?i.offset*a:0,this._endPoints=void 0===i.placeOnEndPoints||i.placeOnEndPoints,this._controlPoints=void 0===i.placeOnControlPoints||i.placeOnControlPoints,this._regularVertices=void 0===i.placeOnRegularVertices||i.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(s){if(this.iteratePath||(this._preparePath(s),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const i=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(i[2]);let a=i[0],p=i[1];if(0!==this._offset){const l=Math.cos(i[2]),o=Math.sin(i[2]);a-=this._offset*o,p+=this._offset*l}return this.internalPlacement.setTranslate(a,p),this._tagIterator++,this.internalPlacement}_preparePath(s){this._tags.length=0,this._tagIterator=0;const i=(0,q.QK)(s),a=s.length-1;let p,l,o=0,d=0,c=0,P=0,b=0;for(;o<a;){o++,p=s[o-1],l=s[o];const v=(0,q.zv)(p),N=(0,q.zv)(l);(this._angleToLine||0!==this._offset)&&(P=this._curveHelper.getAngle(p,l,0)),1===o?i?(d=P,c=v):(this._endPoints||this._controlPoints&&1===v)&&this._tags.push([p[0],p[1],P]):1===v?this._controlPoints&&this._tags.push([p[0],p[1],Tt(b,P)]):this._regularVertices&&this._tags.push([p[0],p[1],Tt(b,P)]),(this._angleToLine||0!==this._offset)&&(b=this._curveHelper.getAngle(p,l,1)),o===a&&(i?1===N||1===c?this._controlPoints&&this._tags.push([l[0],l[1],Tt(b,d)]):this._regularVertices&&this._tags.push([l[0],l[1],Tt(b,d)]):(this._endPoints||this._controlPoints&&1===N)&&this._tags.push([l[0],l[1],b]))}this._tagIterator=0}}function Tt(yt,s){const i=Math.PI;for(;Math.abs(s-yt)>i+2e-15;)s-yt>i?s-=2*i:s+=2*i;return(yt+s)/2}class Mt{static local(){return null===Mt.instance&&(Mt.instance=new Mt),Mt.instance}execute(s,i,a){return new Dt(s,i,a)}}Mt.instance=null;class Dt{constructor(s,i,a){this._geometry=s,this._offsetX=void 0!==i.offsetX?i.offsetX*a:0,this._offsetY=void 0!==i.offsetY?i.offsetY*a:0,this._method=void 0!==i.method?i.method:"OnPolygon",this._internalPlacement=new C.u}next(){const s=this._geometry;return this._geometry=null,s&&function(yt){return void 0!==yt.rings}(s)?this._polygonCenter(s):null}_polygonCenter(s){let i=!1;switch(this._method){default:{const a=(0,j.Ue)();(0,z.$P)(a,s),this._internalPlacement.setTranslate((a[2]+a[0])/2+this._offsetX,(a[3]+a[1])/2-this._offsetY),i=!0;break}}return i?this._internalPlacement:null}}function Ht(yt){if(!yt)return null;switch(yt.type){case"CIMGeometricEffectAddControlPoints":return lt.local();case"CIMGeometricEffectArrow":return ot.local();case"CIMGeometricEffectBuffer":return gt.local();case"CIMGeometricEffectControlMeasureLine":return n.local();case"CIMGeometricEffectCut":return K.local();case"CIMGeometricEffectDashes":return kt.local();case"CIMGeometricEffectDonut":return E.local();case"CIMGeometricEffectJog":return u.local();case"CIMGeometricEffectMove":return X.local();case"CIMGeometricEffectOffset":return y.local();case"CIMGeometricEffectReverse":return M.local();case"CIMGeometricEffectRotate":return Z.local();case"CIMGeometricEffectScale":return ut.local();case"CIMGeometricEffectWave":return Pt.local()}return null}function Ut(yt){if(!yt)return null;switch(yt.type){case"CIMMarkerPlacementAlongLineSameSize":return O.local();case"CIMMarkerPlacementAtExtremities":return f.local();case"CIMMarkerPlacementAtRatioPositions":return I.local();case"CIMMarkerPlacementInsidePolygon":return A.local();case"CIMMarkerPlacementOnLine":return at.local();case"CIMMarkerPlacementOnVertices":return ft.local();case"CIMMarkerPlacementPolygonCenter":return Mt.local()}return null}},46495:(Ft,bt,Y)=>{Y.d(bt,{u:()=>Q});class Q{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)&&(this.rz=Math.atan2(this.rz_s,this.rz_c)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rz_c=1,this.rz_s=0}setTranslate(lt,wt){this.tx=lt,this.ty=wt}setTranslateZ(lt){this.tz=lt}setRotateCS(lt,wt){this.rz=void 0,this.rz_c=lt,this.rz_s=wt}setRotate(lt){this.rz=lt,this.rz_c=void 0,this.rz_s=void 0}setRotateY(lt){this.ry=lt}setScale(lt){this.s=lt}setMeasure(lt){this.m=lt}}},64345:(Ft,bt,Y)=>{Y.d(bt,{Z:()=>vt});var Q=Y(49996),G=Y(30351),q=Y(61414),lt=Y(7808);const wt=";base64,";class vt{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(F){var st;return null!=(st=this._resourceMap.get(F))?st:null}fetchResource(F,st){var it=this;return(0,Q.Z)(function*(){const ot={width:0,height:0},ht=it._resourceMap,gt=ht.get(F);if(gt)return ot.width=gt.width,ot.height=gt.height,ot;let Ct=it._inFlightResourceMap.get(F);return Ct||(Ct=function(D,F){if(D.includes(wt)){const st=new Image;return st.src=D,st.decode().then(()=>({ok:!0,value:st})).catch(it=>(0,lt.D_)(it)?{ok:!1,error:it}:{ok:!1,error:new q.Z("invalid-resource",`Could not fetch requested resource at ${D}`)})}return(0,G.default)(D,Yt({responseType:"image"},F)).then(st=>({ok:!0,value:st.data})).catch(st=>(0,lt.D_)(st)?{ok:!1,error:st}:{ok:!1,error:new q.Z("invalid-resource",`Could not fetch requested resource at ${D}`)})}(F,st),it._inFlightResourceMap.set(F,Ct),Ct=Ct.then(n=>{if(it._inFlightResourceMap.delete(F),n.ok){ht.set(F,n.value);const w=n.value;return ot.width=w.width,ot.height=w.height,ot}return ot}),Ct)})()}deleteResource(F){this._inFlightResourceMap.delete(F),this._resourceMap.delete(F)}}},52390:(Ft,bt,Y)=>{Y.d(bt,{cD:()=>_t,uQ:()=>r,Tu:()=>kt,zA:()=>H,x1:()=>L,et:()=>rt,g:()=>u});var Q=Y(40295),G=Y(22345),q=Y(18502),lt=Y(52872),wt=Y(75244),vt=Y(7401),At=Y(15783),D=Y(70279),F=Y(25781),st=Y(42822),it=Y(46495),ot=Y(64345),ht=Y(49198),gt=Y(16120),Ct=Y(48197),n=Y(30603),w=Y(20800);const K=Math.PI/180,e=G.Z.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class H{constructor(h){this._t=h}static createIdentity(){return new H([1,0,0,0,1,0])}clone(){const h=this._t;return new H(h.slice())}transform(h){const y=this._t;return[y[0]*h[0]+y[1]*h[1]+y[2],y[3]*h[0]+y[4]*h[1]+y[5]]}static createScale(h,y){return new H([h,0,0,0,y,0])}scale(h,y){const k=this._t;return k[0]*=h,k[1]*=h,k[2]*=h,k[3]*=y,k[4]*=y,k[5]*=y,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(h,y){return new H([0,0,h,0,0,y])}translate(h,y){const k=this._t;return k[2]+=h,k[5]+=y,this}static createRotate(h){const y=Math.cos(h),k=Math.sin(h);return new H([y,-k,0,k,y,0])}rotate(h){return H.multiply(this,H.createRotate(h),this)}static multiply(h,y,k){const M=h._t,R=y._t,j=M[0]*R[0]+M[3]*R[1],z=M[1]*R[0]+M[4]*R[1],Z=M[2]*R[0]+M[5]*R[1]+R[2],mt=M[0]*R[3]+M[3]*R[4],ut=M[1]*R[3]+M[4]*R[4],dt=M[2]*R[3]+M[5]*R[4]+R[5],Pt=k._t;return Pt[0]=j,Pt[1]=z,Pt[2]=Z,Pt[3]=mt,Pt[4]=ut,Pt[5]=dt,k}invert(){const h=this._t;let y=h[0]*h[4]-h[1]*h[3];if(0===y)return new H([0,0,0,0,0,0]);y=1/y;const k=(h[1]*h[5]-h[2]*h[4])*y,M=(h[2]*h[3]-h[0]*h[5])*y,R=h[4]*y,j=-h[1]*y,z=-h[3]*y,Z=h[0]*y;return new H([R,j,k,z,Z,M])}}class St{constructor(h,y){this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._flippedYs=!1,this._placementPool=new lt.Z(it.u,null,null,100),this._earlyReturn=!1,this._mapRotation=0,this._resourceManager=h||new ot.Z,this._transfos.push(y||H.createIdentity()),this._sizeTransfos.push(y?y.scaleRatio():1)}setTransform(h,y){this._transfos=[h||H.createIdentity()],this._sizeTransfos=[y||(h?h.scaleRatio():1)]}setGeomUnitsPerPoint(h){this._geomUnitsPerPoint=h}setFlippedYs(h){this._flippedYs=h}transformPt(h){return this._transfos[this._transfos.length-1].transform(h)}transformSize(h){return h*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(h){return this._transfos[this._transfos.length-1].invert().transform(h)}reverseTransformSize(h){return h/this._sizeTransfos[this._sizeTransfos.length-1]}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}flippedYs(){return!this.isEmbedded()&&this._flippedYs}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(h,y){const k=y?h.scaleRatio():1;H.multiply(h,this.back(),h),this._transfos.push(h),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*k)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(h,y){if(h)switch(h.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(h,y);break;case"CIMTextSymbol":this.drawTextSymbol(h,y)}}drawMultiLayerSymbol(h,y){if(!h)return;const k=h.symbolLayers;if(!k)return;const M=h.effects;if(M&&M.length>0){const R=this.executeEffects(M,y);if(R){let j=R.next();for(;j;)this.drawSymbolLayers(k,j),j=R.next()}}else this.drawSymbolLayers(k,y)}executeEffects(h,y){let k=new F.M(y);for(const M of h){const R=(0,st.h)(M);R&&(k=R.execute(k,M,this.geomUnitsPerPoint(),this.flippedYs()))}return k}drawSymbolLayers(h,y){let k=h.length;for(;k--;){const M=h[k];if(!M||!1===M.enable)continue;const R=M.effects;if(R&&R.length>0){const j=this.executeEffects(R,y);if(j){let z=null;for(;(z=j.next())&&(this.drawSymbolLayer(M,z),!this._earlyReturn););}}else this.drawSymbolLayer(M,y);if(this._earlyReturn)return}}drawSymbolLayer(h,y){switch(h.type){case"CIMSolidFill":this.drawSolidFill(y,h.color);break;case"CIMHatchFill":this.drawHatchFill(y,h);break;case"CIMPictureFill":this.drawPictureFill(y,h);break;case"CIMGradientFill":this.drawGradientFill(y,h);break;case"CIMSolidStroke":this.drawSolidStroke(y,h.color,h.width,h.capStyle,h.joinStyle,h.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(y,h);break;case"CIMGradientStroke":this.drawGradientStroke(y,h);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(h,y)}}drawHatchFill(h,y){const k=this._buildHatchPolyline(y,h,this.geomUnitsPerPoint());k&&(this.pushClipPath(h),this.drawMultiLayerSymbol(y.lineSymbol,k),this.popClipPath())}drawPictureFill(h,y){}drawGradientFill(h,y){}drawPictureStroke(h,y){}drawGradientStroke(h,y){}drawMarkerLayer(h,y){const k=h.markerPlacement;if(k){const M=(0,st.W)(k);if(M){const R="CIMMarkerPlacementInsidePolygon"===k.type;R&&this.pushClipPath(y);const j=M.execute(y,k,this.geomUnitsPerPoint());if(j){let z=null;for(;(z=j.next())&&(this.drawMarker(h,z),!this._earlyReturn););}R&&this.popClipPath()}}else{const M=this._placementPool.acquire();if((0,D.wp)(y))M.tx=y.x,M.ty=y.y,this.drawMarker(h,M);else for(const R of y.points)if(M.tx=R[0],M.ty=R[1],this.drawMarker(h,M),this._earlyReturn)break;this._placementPool.release(M)}}drawMarker(h,y){switch(h.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(h,y);break;case"CIMVectorMarker":this.drawVectorMarker(h,y)}}drawPictureMarker(h,y){var k,M,R,j,z;if(!h)return;const Z=this._resourceManager.getResource(h.url),mt=null!=(k=h.size)?k:10;if((0,q.Wi)(Z)||mt<=0)return;const ut=Z.width,dt=Z.height;if(!ut||!dt)return;const Pt=ut/dt,zt=null!=(M=h.scaleX)?M:1,ct=H.createIdentity(),O=h.anchorPoint;if(O){let C=O.x,U=O.y;"Absolute"!==h.anchorPointUnits&&(C*=mt*Pt*zt,U*=mt),ct.translate(-C,-U)}let _=null!=(R=h.rotation)?R:0;h.rotateClockwise&&(_=-_),this._mapRotation&&(_+=this._mapRotation),_&&ct.rotate(_*K);let f=null!=(j=h.offsetX)?j:0,T=null!=(z=h.offsetY)?z:0;if(f||T){if(this._mapRotation){const C=K*this._mapRotation,U=Math.cos(C),A=Math.sin(C),tt=f*A+T*U;f=f*U-T*A,T=tt}ct.translate(f,T)}const I=this.geomUnitsPerPoint();1!==I&&ct.scale(I,I);const B=y.getAngle();B&&ct.rotate(B),ct.translate(y.tx,y.ty),this.push(ct,!1),this.drawImage(h.url,mt,h.scaleX),this.pop()}drawVectorMarker(h,y){var k,M,R,j;if(!h)return;const z=h.markerGraphics;if(!z)return;const Z=null!=(k=h.size)?k:10,mt=h.frame,ut=mt?mt.ymax-mt.ymin:0,dt=Z&&ut?Z/ut:1,Pt=H.createIdentity();mt&&Pt.translate(.5*-(mt.xmax+mt.xmin),.5*-(mt.ymax+mt.ymin));const zt=h.anchorPoint;if(zt){let I=zt.x,B=zt.y;"Absolute"!==h.anchorPointUnits?mt&&(I*=mt.xmax-mt.xmin,B*=mt.ymax-mt.ymin):(I/=dt,B/=dt),Pt.translate(-I,-B)}1!==dt&&Pt.scale(dt,dt);let ct=null!=(M=h.rotation)?M:0;h.rotateClockwise&&(ct=-ct),this._mapRotation&&(ct+=this._mapRotation),ct&&Pt.rotate(ct*K);let O=null!=(R=h.offsetX)?R:0,_=null!=(j=h.offsetY)?j:0;if(O||_){if(this._mapRotation){const I=K*this._mapRotation,B=Math.cos(I),C=Math.sin(I),U=O*C+_*B;O=O*B-_*C,_=U}Pt.translate(O,_)}const f=this.geomUnitsPerPoint();1!==f&&Pt.scale(f,f);const T=y.getAngle();T&&Pt.rotate(T),Pt.translate(y.tx,y.ty),this.push(Pt,h.scaleSymbolsProportionally);for(const I of z)if(I&&I.symbol&&I.geometry||e.error("Invalid marker graphic",I),this.drawSymbol(I.symbol,I.geometry),this._earlyReturn)break;this.pop()}drawTextSymbol(h,y){var k,M,R,j;if(!h||!(0,D.wp)(y)||(null!=(k=h.height)?k:10)<=0)return;const z=H.createIdentity();let Z=null!=(M=h.angle)?M:0;Z=-Z,Z&&z.rotate(Z*K);const mt=null!=(R=h.offsetX)?R:0,ut=null!=(j=h.offsetY)?j:0;(mt||ut)&&z.translate(mt,ut);const dt=this.geomUnitsPerPoint();1!==dt&&z.scale(dt,dt),z.translate(y.x,y.y),this.push(z,!1),this.drawText(h),this.pop()}_buildHatchPolyline(h,y,k){let M=(void 0!==h.separation?h.separation:4)*k,R=void 0!==h.rotation?h.rotation:0;if(0===M)return null;M<0&&(M=-M);let j=0;const z=.5*M;for(;j>z;)j-=M;for(;j<-z;)j+=M;const Z=(0,vt.Ue)();(0,At.$P)(Z,y),Z[0]-=z,Z[1]-=z,Z[2]+=z,Z[3]+=z;const mt=[[Z[0],Z[1]],[Z[0],Z[3]],[Z[2],Z[3]],[Z[2],Z[1]]];for(;R>180;)R-=180;for(;R<0;)R+=180;const ut=Math.cos(R*K),dt=Math.sin(R*K),Pt=-M*dt,zt=M*ut;let ct,O,_,f;j=(void 0!==h.offsetX?h.offsetX*k:0)*dt-(void 0!==h.offsetY?h.offsetY*k:0)*ut,ct=_=Number.MAX_VALUE,O=f=-Number.MAX_VALUE;for(const tt of mt){const et=tt[0],at=tt[1],Et=ut*et+dt*at,ft=-dt*et+ut*at;ct=Math.min(ct,Et),_=Math.min(_,ft),O=Math.max(O,Et),f=Math.max(f,ft)}_=Math.floor(_/M)*M;let T=ut*ct-dt*_-Pt*j/M,I=dt*ct+ut*_-zt*j/M,B=ut*O-dt*_-Pt*j/M,C=dt*O+ut*_-zt*j/M;const U=1+Math.round((f-_)/M),A=[];for(let tt=0;tt<U;tt++)T+=Pt,I+=zt,B+=Pt,C+=zt,A.push([[T,I],[B,C]]);return{paths:A}}}class r extends St{constructor(h,y){super(h,y),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new ht.Z(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return(0,vt.al)(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(h){if(h&&!(this._clipCount>0))if((0,D.oU)(h))this._processPath(h.rings,0);else if((0,D.l9)(h))this._processPath(h.paths,0);else if((0,D.YX)(h)){const y=E(h);y&&this._processPath(y.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(h,y,k){if(!h||this._clipCount>0)return;const M=.5*this.transformSize(k);if((0,D.oU)(h))this._processPath(h.rings,M);else if((0,D.l9)(h))this._processPath(h.paths,M);else if((0,D.YX)(h)){const R=E(h);R&&this._processPath(R.rings,M)}else console.error("drawSolidStroke unexpected geometry type!")}pushClipPath(h){this.drawSolidFill(h),++this._clipCount}popClipPath(){--this._clipCount}drawImage(h,y,k){let M=k*y,R=y;const j=this._resourceManager.getResource(h);!y&&(0,q.pC)(j)&&(M=k*j.width,R=j.height),this._merge(this.transformPt([-M/2,-R/2]),0),this._merge(this.transformPt([-M/2,R/2]),0),this._merge(this.transformPt([M/2,-R/2]),0),this._merge(this.transformPt([M/2,R/2]),0)}drawText(h){this._textRasterizer||(this._textRasterizer=new gt.d)}_processPath(h,y){if(h)for(const k of h){const M=k?k.length:0;if(M>1){this._merge(this.transformPt(k[0]),y);for(let R=1;R<M;++R)this._merge(this.transformPt(k[R]),y)}}}_merge(h,y){h[0]-y<this._xmin&&(this._xmin=h[0]-y),h[0]+y>this._xmax&&(this._xmax=h[0]+y),h[1]-y<this._ymin&&(this._ymin=h[1]-y),h[1]+y>this._ymax&&(this._ymax=h[1]+y)}}class kt extends St{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0}hitTest(h,y,k,M,R,j){const z=j*(0,wt.F2)(1);this.setTransform(),this.setGeomUnitsPerPoint(z),this._searchPoint=[(h[0]+h[2])/2,(h[1]+h[3])/2],this._searchDistPoint=(h[2]-h[0])/2/z,this._textInfo=M;const Z=y&&("CIMPointSymbol"===y.type&&"Map"!==y.angleAlignment||"CIMTextSymbol"===y.type);return this._mapRotation=Z?R:0,this._earlyReturn=!1,this.drawSymbol(y,k),this._earlyReturn}drawSolidFill(h,y){this._hitTestFill(h)}drawHatchFill(h,y){this._hitTestFill(h)}drawPictureFill(h,y){this._hitTestFill(h)}drawGradientFill(h,y){this._hitTestFill(h)}drawSolidStroke(h,y,k,M,R,j){this._hitTestStroke(h,k)}drawPictureStroke(h,y){this._hitTestStroke(h,y.width)}drawGradientStroke(h,y){this._hitTestStroke(h,y.width)}pushClipPath(h){}popClipPath(){}drawImage(h,y,k){const M=this._resourceManager.getResource(h);if((0,q.Wi)(M)||0===M.height||0===y)return;const R=y*this.geomUnitsPerPoint(),j=R*k*(M.width/M.height),z=this.reverseTransformPt(this._searchPoint),Z=this._searchDistPoint;Math.abs(z[0])<j/2+Z&&Math.abs(z[1])<R/2+Z&&(this._earlyReturn=!0)}drawText(h){var y,k;const M=this._textInfo;if(!M)return;const R=M.get(h);if(!R)return;const{text:j,mosaicItem:z}=R;if(!z||0===z.glyphMosaicItems.length)return;const Z=null!=(y=h.height)?y:10,mt=rt(h.lineGapType,null!=(k=h.lineGap)?k:0,Z),ut=(0,Q.E)(j)[1],dt=z.glyphMosaicItems,Pt=(0,w.Nr)(dt,ut,{scale:Z/n.Ex,angle:0,xOffset:0,yOffset:0,hAlign:L(h.horizontalAlignment),vAlign:u(h.verticalAlignment),maxLineWidth:512,lineHeight:n.xm*Math.max(.25,Math.min(mt||1,4)),decoration:h.font.decoration||"none",isCIM:!0}),zt=this.reverseTransformPt(this._searchPoint),ct=zt[0],O=zt[1];for(const _ of Pt.glyphs)if(ct>_.xTopLeft&&ct<_.xBottomRight&&O>-_.yBottomRight&&O<-_.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(h){let y=null;if((0,D.YX)(h)){const R=h;y=[[[R.xmin,R.ymin],[R.xmin,R.ymax],[R.xmax,R.ymax],[R.xmax,R.ymin],[R.xmin,R.ymin]]]}else if((0,D.oU)(h))y=h.rings;else{if(!(0,D.l9)(h))return;y=h.paths}const k=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(k,y)&&(this._earlyReturn=!0);const M=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(k,y,M)&&(this._earlyReturn=!0)}_hitTestStroke(h,y){let k=null;if((0,D.YX)(h)){const z=h;k=[[[z.xmin,z.ymin],[z.xmin,z.ymax],[z.xmax,z.ymax],[z.xmax,z.ymin],[z.xmin,z.ymin]]]}else if((0,D.oU)(h))k=h.rings;else{if(!(0,D.l9)(h))return;k=h.paths}const M=this.reverseTransformPt(this._searchPoint),R=y*this.geomUnitsPerPoint(),j=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(M,k,R/2+j)&&(this._earlyReturn=!0)}_pointInPolygon(h,y){let k=0;for(const M of y){const R=M.length;for(let j=1;j<R;++j){const z=M[j-1],Z=M[j];z[1]>h[1]!=Z[1]>h[1]&&((Z[0]-z[0])*(h[1]-z[1])-(Z[1]-z[1])*(h[0]-z[0])>0?k++:k--)}}return 0!==k}_nearLine(h,y,k){for(const M of y){const R=M.length;for(let j=1;j<R;++j){const z=M[j-1],Z=M[j];let mt=(Z[0]-z[0])*(Z[0]-z[0])+(Z[1]-z[1])*(Z[1]-z[1]);if(0===mt)continue;mt=Math.sqrt(mt);const ut=((Z[0]-z[0])*(h[1]-z[1])-(Z[1]-z[1])*(h[0]-z[0]))/mt;if(Math.abs(ut)<k){const dt=((Z[0]-z[0])*(h[0]-z[0])+(Z[1]-z[1])*(h[1]-z[1]))/mt;if(dt>-k&&dt<mt+k)return!0}}}return!1}}class _t extends St{constructor(h,y,k){super(y,k),this._ctx=h}drawSolidFill(h,y){if(!h)return;if((0,D.oU)(h))this._buildPath(h.rings,!0);else if((0,D.l9)(h))this._buildPath(h.paths,!0);else if((0,D.YX)(h))this._buildPath(E(h).rings,!0);else{if(!(0,D.aW)(h))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const k=this._ctx;k.fillStyle="string"==typeof y?y:"rgba("+Math.round(y[0])+","+Math.round(y[1])+","+Math.round(y[2])+","+y[3]/255+")",k.fill("evenodd")}drawSolidStroke(h,y,k,M,R,j){if(!h||!y||0===k)return;if((0,D.oU)(h))this._buildPath(h.rings,!0);else if((0,D.l9)(h))this._buildPath(h.paths,!1);else{if(!(0,D.YX)(h))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(E(h).rings,!0)}const z=this._ctx;z.strokeStyle="string"==typeof y?y:"rgba("+Math.round(y[0])+","+Math.round(y[1])+","+Math.round(y[2])+","+y[3]/255+")",z.lineWidth=this.transformSize(k)+.5,this._setCapStyle(M),this._setJoinStyle(R),z.miterLimit=j,z.stroke()}pushClipPath(h){if(this._ctx.save(),(0,D.oU)(h))this._buildPath(h.rings,!0);else if((0,D.l9)(h))this._buildPath(h.paths,!0);else{if(!(0,D.YX)(h))return;this._buildPath(E(h).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(h,y,k){const M=this._resourceManager.getResource(h);if((0,q.Wi)(M))return;const R=this._ctx,j=R.canvas.width,z=R.canvas.height;let Z=y*k*(M.width/M.height),mt=k*y;y||(Z=k*M.width,mt=k*M.height),this._ctx.drawImage(M,0,0,M.width,M.height,0,0,Math.min(this.transformSize(Z),j),Math.min(this.transformSize(mt),z))}drawText(h){this._textRasterizer||(this._textRasterizer=new gt.d)}_buildPath(h,y){const k=this._ctx;if(k.beginPath(),h)for(const M of h){const R=M?M.length:0;if(R>1){let j=this.transformPt(M[0]);k.moveTo(j[0],j[1]);for(let z=1;z<R;++z)j=this.transformPt(M[z]),k.lineTo(j[0],j[1]);y&&k.closePath()}}}_setCapStyle(h){switch(h){case"Butt":this._ctx.lineCap="butt";break;case"Round":this._ctx.lineCap="round";break;case"Square":this._ctx.lineCap="square"}}_setJoinStyle(h){switch(h){case"Bevel":this._ctx.lineJoin="bevel";break;case"Round":this._ctx.lineJoin="round";break;case"Miter":this._ctx.lineJoin="miter"}}}const E=X=>X?{spatialReference:X.spatialReference,rings:[[[X.xmin,X.ymin],[X.xmin,X.ymax],[X.xmax,X.ymax],[X.xmax,X.ymin],[X.xmin,X.ymin]]]}:null,L=X=>{switch(X){case"Left":return Ct.M7.Left;case"Right":return Ct.M7.Right;case"Center":case"Justify":return Ct.M7.Center}},u=X=>{switch(X){case"Top":return Ct.TR.Top;case"Center":return Ct.TR.Center;case"Bottom":return Ct.TR.Bottom;case"Baseline":return Ct.TR.Baseline}},rt=(X,h,y)=>{switch(X){case"ExtraLeading":return 1+h/y;case"Multiple":return h;case"Exact":return h/y}}},14915:(Ft,bt,Y)=>{Y.d(bt,{IV:()=>rt,B$:()=>X,E0:()=>y,fN:()=>h,U1:()=>dt,rW:()=>kt});var Q=Y(28503),G=Y(40295),q=Y(33821),lt=Y(60161),wt=Y(22345),vt=Y(88415),At=Y(18502),D=Y(75244),F=Y(7401),st=Y(15783),it=Y(46495),ot=Y(52390),ht=Y(56314),gt=Y(14437),Ct=Y(30603),n=Y(20800);const w=Math.PI,K=w/2,H=96/72,St=Math.PI/180,r=wt.Z.getLogger("esri.symbols.cim.CIMSymbolHelper");function kt(O){if(!O||!O.type)return null;let _;switch(O.type){case"cim":return O.data;case"web-style":return O;case"simple-marker":_=X.fromSimpleMarker(O);break;case"picture-marker":_=X.fromPictureMarker(O);break;case"simple-line":_=X.fromSimpleLineSymbol(O);break;case"simple-fill":_=X.fromSimpleFillSymbol(O);break;case"picture-fill":_=X.fromPictureFillSymbol(O);break;case"text":_=X.fromTextSymbol(O)}return{type:"CIMSymbolReference",symbol:_}}function _t(O,_){switch(_.type){case"CIMSymbolReference":return _t(O,_.symbol);case"CIMPointSymbol":{const f={x:0,y:0};O.drawSymbol(_,f);break}case"CIMLineSymbol":{const f={paths:[[[0,0],[0,1]]]};O.drawSymbol(_,f);break}case"CIMPolygonSymbol":{const f={rings:[[[0,0],[0,1],[0,0]]]};O.drawSymbol(_,f);break}case"CIMTextSymbol":{const f={x:0,y:0};O.drawSymbol(_,f);break}case"CIMVectorMarker":{const f=new it.u;O.drawMarker(_,f);break}}return O.envelope()}function E(O){if(!O)return 0;switch(O.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(O.offset);default:return 0}}function L(O){if(!O)return 0;switch(O.type){case"CIMGeometricEffectArrow":return Math.abs(.5*O.width);case"CIMGeometricEffectBuffer":return Math.abs(O.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(O.length);case"CIMGeometricEffectJog":return Math.abs(.5*O.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,ht.NA)(O.offsetX)),Math.abs((0,ht.NA)(O.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(O.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(O.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(O.fromWidth),Math.abs(O.toWidth));case"CIMGeometricEffectWave":return Math.abs(O.amplitude)}}function u(O){if(!O)return 0;let _=0;for(const f of O)_+=L(f);return _}class rt{getSymbolInflateSize(_,f,T,I,B){return _||(_=[0,0,0,0]),f?this._getInflateSize(_,f,T,I,B):_}static SafeSize(_){const f=Math.max(Math.abs(_[0]),Math.abs(_[2])),T=Math.max(Math.abs(_[1]),Math.abs(_[3]));return Math.sqrt(f*f+T*T)}_vectorMarkerBounds(_,f,T,I){let B=!0;const C=(0,F.Ue)();if(f&&f.markerGraphics)for(const U of f.markerGraphics){const A=[0,0,0,0];U.geometry&&((0,st.$P)(C,U.geometry),A[0]=0,A[1]=0,A[2]=0,A[3]=0,this.getSymbolInflateSize(A,U.symbol,T,0,I),C[0]+=A[0],C[1]+=A[1],C[2]+=A[2],C[3]+=A[3],B?(_[0]=C[0],_[1]=C[1],_[2]=C[2],_[3]=C[3],B=!1):(_[0]=Math.min(_[0],C[0]),_[1]=Math.min(_[1],C[1]),_[2]=Math.max(_[2],C[2]),_[3]=Math.max(_[3],C[3])))}return _}_getInflateSize(_,f,T,I,B){if(void 0!==f.symbolLayers){const C=this._getLayersInflateSize(_,f.symbolLayers,T,I,B),U=u(f.effects);return U>0&&(C[0]-=U,C[1]-=U,C[2]+=U,C[3]+=U),C}return this._getTextInflatedSize(_,f,B)}_getLayersInflateSize(_,f,T,I,B){let C=!0;if(!f)return _;for(const U of f){if(!U)continue;let A=[0,0,0,0];switch(U.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const et=U;let at=et.width;"Square"===et.capStyle||"Miter"===et.joinStyle?at/=1.4142135623730951:at/=2,A[0]=-at,A[1]=-at,A[2]=at,A[3]=at;break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const et=U;if("CIMVectorMarker"===U.type){const pt=U;if(A=this._vectorMarkerBounds(A,pt,T,B),pt.frame){const Tt=(pt.frame.xmin+pt.frame.xmax)/2,Rt=(pt.frame.ymin+pt.frame.ymax)/2;A[0]-=Tt,A[1]-=Rt,A[2]-=Tt,A[3]-=Rt;const Mt=pt.size/(pt.frame.ymax-pt.frame.ymin);A[0]*=Mt,A[1]*=Mt,A[2]*=Mt,A[3]*=Mt}}else if("CIMPictureMarker"===U.type){const pt=U,Tt=T.getResource(pt.url);let Rt=1;(0,At.pC)(Tt)&&Tt.height&&(Rt=Tt.width/Tt.height);const Mt=et.size/2,Dt=et.size*Rt*pt.scaleX/2;A=[-Dt,-Mt,Dt,Mt]}else{const pt=et.size/2;A=[-pt,-pt,pt,pt]}if(et.anchorPoint){let pt,Tt;"Absolute"===et.anchorPointUnits?(pt=et.anchorPoint.x,Tt=et.anchorPoint.y):(pt=et.anchorPoint.x*(A[2]-A[0]),Tt=et.anchorPoint.y*(A[3]-A[1])),A[0]-=pt,A[1]-=Tt,A[2]-=pt,A[3]-=Tt}let at=(0,ht.NA)(et.rotation);if(et.rotateClockwise&&(at=-at),I&&(at-=I),at){const pt=St*at,Tt=Math.cos(pt),Rt=Math.sin(pt),Mt=(0,F.Ue)([gt.B1,gt.B1,-gt.B1,-gt.B1]);(0,F.Ho)(Mt,[A[0]*Tt-A[1]*Rt,A[0]*Rt+A[1]*Tt]),(0,F.Ho)(Mt,[A[0]*Tt-A[3]*Rt,A[0]*Rt+A[3]*Tt]),(0,F.Ho)(Mt,[A[2]*Tt-A[1]*Rt,A[2]*Rt+A[1]*Tt]),(0,F.Ho)(Mt,[A[2]*Tt-A[3]*Rt,A[2]*Rt+A[3]*Tt]),A=Mt}let Et=(0,ht.NA)(et.offsetX),ft=(0,ht.NA)(et.offsetY);if(I){const pt=St*I,Tt=Math.cos(pt),Rt=Math.sin(pt),Mt=Et*Rt+ft*Tt;Et=Et*Tt-ft*Rt,ft=Mt}A[0]+=Et,A[1]+=ft,A[2]+=Et,A[3]+=ft;const It=E(et.markerPlacement);It>0&&(A[0]-=It,A[1]-=It,A[2]+=It,A[3]+=It);break}}const tt=u(U.effects);tt>0&&(A[0]-=tt,A[1]-=tt,A[2]+=tt,A[3]+=tt),C?(_[0]=A[0],_[1]=A[1],_[2]=A[2],_[3]=A[3],C=!1):(_[0]=Math.min(_[0],A[0]),_[1]=Math.min(_[1],A[1]),_[2]=Math.max(_[2],A[2]),_[3]=Math.max(_[3],A[3]))}return _}_getTextInflatedSize(_,f,T){var I,B;const C=null!=(I=f.height)?I:10;if(_[0]=-C/2,_[1]=-C/2,_[2]=C/2,_[3]=C/2,!T)return _;const U=T.get(f);if(!U)return _;const{text:A,mosaicItem:tt}=U;if(!tt||0===tt.glyphMosaicItems.length)return _;const et=(0,ot.et)(f.lineGapType,null!=(B=f.lineGap)?B:0,C),at=(0,G.E)(A)[1],Et=tt.glyphMosaicItems,ft=(0,n.Nr)(Et,at,{scale:C/Ct.Ex,angle:(0,ht.NA)(f.angle),xOffset:(0,ht.NA)(f.offsetX),yOffset:(0,ht.NA)(f.offsetY),hAlign:(0,ot.x1)(f.horizontalAlignment),vAlign:(0,ot.g)(f.verticalAlignment),maxLineWidth:512,lineHeight:Ct.xm*Math.max(.25,Math.min(et||1,4)),decoration:f.font.decoration||"none",isCIM:!0}).boundsT;return _[0]=ft.x-ft.halfWidth,_[1]=-ft.y-ft.halfHeight,_[2]=ft.x+ft.halfWidth,_[3]=-ft.y+ft.halfHeight,_}}class X{static getEnvelope(_,f){const T=new ot.uQ(f);if(Array.isArray(_)){let I;for(const B of _)I?I.union(_t(T,B)):I=_t(T,B);return I}return _t(T,_)}static getTextureAnchor(_,f){const T=this.getEnvelope(_,f);if(!T)return[0,0,0];const I=(T.x+.5*T.width)*H,B=-(T.y+.5*T.height)*H,C=T.width*H+2,U=T.height*H+2;return[I/C,B/U,U]}static rasterize(_,f,T,I,B=!0){const C=T||this.getEnvelope(f,I);if(!C)return[null,0,0,0,0];const U=(C.x+.5*C.width)*H,A=(C.y+.5*C.height)*H;_.width=C.width*H,_.height=C.height*H,T||(_.width+=2,_.height+=2);const tt=_.getContext("2d"),et=ot.zA.createScale(H,-H);et.translate(.5*_.width-U,.5*_.height+A);const at=new ot.cD(tt,I,et);switch(f.type){case"CIMPointSymbol":{const It={type:"point",x:0,y:0};at.drawSymbol(f,It);break}case"CIMVectorMarker":{const It=new it.u;at.drawMarker(f,It);break}}const Et=tt.getImageData(0,0,_.width,_.height),ft=new Uint8Array(Et.data);if(B){let It;for(let pt=0;pt<ft.length;pt+=4)It=ft[pt+3]/255,ft[pt]=ft[pt]*It,ft[pt+1]=ft[pt+1]*It,ft[pt+2]=ft[pt+2]*It}return[ft,_.width,_.height,-U/_.width,-A/_.height]}static fromTextSymbol(_){const{angle:f,color:T,font:I,haloColor:B,haloSize:C,horizontalAlignment:U,kerning:A,text:tt,verticalAlignment:et,xoffset:at,yoffset:Et}=_;let ft,It,pt,Tt,Rt;I&&(ft=I.family,It=I.style,pt=I.weight,Tt=I.size,Rt=I.decoration);let Mt=!1;return tt&&(Mt=(0,G.E)(tt)[1]),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:f,blockProgression:2,depth3D:1,extrapolateBaselines:!0,fontEffects:0,fontEncoding:1,fontFamilyName:ft||"Arial",fontStyleName:Z(It,pt),fontType:0,haloSize:C,height:Tt,hinting:1,horizontalAlignment:R(null!=U?U:"center"),kerning:A,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:(0,ht.NA)(at),offsetY:(0,ht.NA)(Et),strikethrough:"line-through"===Rt,underline:"underline"===Rt,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:z(T)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:z(B)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:Mt?1:0,verticalAlignment:j(null!=et?et:"baseline"),verticalGlyphOrientation:0,wordSpacing:100,billboardMode3D:2},textString:tt}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(_){const{height:f,outline:T,width:I,xoffset:B,xscale:C,yoffset:U,yscale:A}=_,tt=[],et={type:"CIMPolygonSymbol",symbolLayers:tt};if(T){const{cap:pt,join:Tt,miterLimit:Rt,width:Mt}=T;tt.push({type:"CIMSolidStroke",color:z(T.color),capStyle:k(pt),joinStyle:M(Tt),miterLimit:Rt,width:Mt})}let at=_.url;"esriPFS"===_.type&&_.imageData&&(at=_.imageData);const Et="angle"in _?_.angle:0,ft=I*(C||1),It=f*(A||1);return tt.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:at,height:It,width:ft,offsetX:(0,ht.NA)(B),offsetY:(0,ht.NA)(U),rotation:(0,ht.NA)(-Et),colorSubstitutions:null}),et}static fromSimpleFillSymbol(_){const{color:f,style:T,outline:I}=_,B=[],C={type:"CIMPolygonSymbol",symbolLayers:B};let U=null;if(I){const{cap:A,join:tt,style:et}=I;"solid"!==et&&"none"!==et&&"esriSLSSolid"!==et&&"esriSLSNull"!==et&&(U=[{type:"CIMGeometricEffectDashes",dashTemplate:dt(et,A),lineDashEnding:"NoConstraint",scaleDash:!0}]),B.push({type:"CIMSolidStroke",color:z(I.color),capStyle:k(A),joinStyle:M(tt),miterLimit:I.miterLimit,width:I.width,effects:U})}if(T&&"solid"!==T&&"none"!==T&&"esriSFSSolid"!==T&&"esriSFSNull"!==T){const A={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:z(f),capStyle:"Butt",joinStyle:"Miter",width:.75}]};let tt=0;const et=(0,vt.fp)(Math.ceil(window.devicePixelRatio)),at=ct(T)?8*et:10*et;switch(T){case"vertical":case"esriSFSVertical":tt=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":tt=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":tt=45;break;case"cross":case"esriSFSCross":tt=0}B.push({type:"CIMHatchFill",lineSymbol:A,offsetX:0,offsetY:0,rotation:tt,separation:at}),"cross"===T||"esriSFSCross"===T?B.push({type:"CIMHatchFill",lineSymbol:(0,lt.d9)(A),offsetX:0,offsetY:0,rotation:90,separation:at}):"diagonal-cross"!==T&&"esriSFSDiagonalCross"!==T||B.push({type:"CIMHatchFill",lineSymbol:(0,lt.d9)(A),offsetX:0,offsetY:0,rotation:45,separation:at})}else!T||"solid"!==T&&"esriSFSSolid"!==T||B.push({type:"CIMSolidFill",enable:!0,color:z(f)});return C}static fromSimpleLineSymbol(_){const{cap:f,color:T,join:I,marker:B,miterLimit:C,style:U,width:A}=_;let tt=null;"solid"!==U&&"none"!==U&&"esriSLSSolid"!==U&&"esriSLSNull"!==U&&(tt=[{type:"CIMGeometricEffectDashes",dashTemplate:dt(U,f),lineDashEnding:"NoConstraint",scaleDash:!0}]);const et=[];if(B){let at;switch(B.placement){case"begin-end":at="Both";break;case"begin":at="JustBegin";break;case"end":at="JustEnd";break;default:at="None"}const Et=X.fromSimpleMarker(B,A,T).symbolLayers[0];Et.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:at,offsetAlongLine:0},et.push(Et)}return"none"!==U&&"esriSLSNull"!==U&&et.push({type:"CIMSolidStroke",color:z(T),capStyle:k(f),joinStyle:M(I),miterLimit:C,width:A,effects:tt}),{type:"CIMLineSymbol",symbolLayers:et}}static fromPictureMarker(_){const{angle:f,height:T,width:I,xoffset:B,yoffset:C}=_;let U=_.url;return"esriPMS"===_.type&&_.imageData&&(U=_.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:"Picture",tintColor:null,url:U,size:T,width:I,offsetX:(0,ht.NA)(B),offsetY:(0,ht.NA)(C),rotation:(0,ht.NA)(-f)}]}}static fromSimpleMarker(_,f,T){var I;const{style:B}=_,C=null!=(I=_.color)?I:T;if("path"===B){const et=[];if("outline"in _&&_.outline){const ft=_.outline;et.push({type:"CIMSolidStroke",enable:!0,width:(0,D.F2)(Math.round((0,D.Wz)(ft.width))),color:z(ft.color)})}et.push({type:"CIMSolidFill",enable:!0,color:z(C),path:_.path});const[at,Et]=zt("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,ht.NA)(-_.angle),size:(0,ht.NA)(_.size||6),offsetX:(0,ht.NA)(_.xoffset),offsetY:(0,ht.NA)(_.yoffset),frame:at,markerGraphics:[{type:"CIMMarkerGraphic",geometry:Et,symbol:{type:"CIMPolygonSymbol",symbolLayers:et}}]}]}}const[U,A]=zt(B);let tt;if(A&&U){const et=[];if("outline"in _&&_.outline){const Et=_.outline;et.push({type:"CIMSolidStroke",enable:!0,width:(0,D.F2)(Math.round((0,D.Wz)(Et.width))),color:z(Et.color)})}else!f||"line-marker"!==_.type||"cross"!==_.style&&"x"!==_.style||et.push({type:"CIMSolidStroke",enable:!0,width:f,color:z(C)});et.push({type:"CIMSolidFill",enable:!0,color:z(C)});const at={type:"CIMPolygonSymbol",symbolLayers:et};tt={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,ht.NA)(-_.angle),size:(0,ht.NA)(_.size||6*f),offsetX:(0,ht.NA)(_.xoffset),offsetY:(0,ht.NA)(_.yoffset),frame:U,markerGraphics:[{type:"CIMMarkerGraphic",geometry:A,symbol:at}]}]}}return tt}static fromCIMHatchFill(_){var f;const T=null!=(f=_.separation)?f:4,I=T/2;let C=this._getLineSymbolPeriod(_.lineSymbol)||4;for(;C<4;)C*=2;const U=C/2;return{type:"CIMVectorMarker",frame:{xmin:-U,xmax:U,ymin:-I,ymax:I},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-U,0],[U,0]]]},symbol:_.lineSymbol}],size:T}}static _getLineSymbolPeriod(_){if(_){const f=this._getEffectsRepeat(_.effects);if(f)return f;if(_.symbolLayers)for(const T of _.symbolLayers){const I=this._getEffectsRepeat(T.effects);if(I)return I;if(T){const B=this._getPlacementRepeat(T.markerPlacement);if(B)return B}}}return 0}static _getEffectsRepeat(_){if(_)for(const f of _)if(f)switch(f.type){case"CIMGeometricEffectDashes":{const T=f.dashTemplate;if(T&&T.length){let I=0;for(const B of T)I+=B;return 1&T.length&&(I*=2),I}break}case"CIMGeometricEffectWave":return f.period;default:r.error(`unsupported geometric effect type ${f.type}`)}return 0}static _getPlacementRepeat(_){if(_)switch(_.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const f=_.placementTemplate;if(f&&f.length){let T=0;for(const I of f)T+=I;return 1&f.length&&(T*=2),T}break}}return 0}static fromCIMInsidePolygon(_){const f=_.markerPlacement,T=Yt({type:_.type},_);let I,B,C,U;return T.markerPlacement=null,T.anchorPoint=null,!0===f.shiftOddRows?(B=f.stepX/2,C=f.stepY,U=2*f.stepY,I=[{x:-B,y:0},{x:B,y:0},{x:0,y:C},{x:0,y:-C}].map(A=>({type:"CIMMarkerGraphic",geometry:A,symbol:{type:"CIMPointSymbol",symbolLayers:[T]}}))):(B=f.stepX/2,C=f.stepY/2,U=f.stepY,I=[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[T]}}]),{type:"CIMVectorMarker",frame:{xmin:-B,xmax:B,ymin:-C,ymax:C},markerGraphics:I,size:U}}static getFillColor(_){if(!_)return null;switch(_.type){case"CIMPolygonSymbol":if(_.symbolLayers)for(const f of _.symbolLayers){const T=X.getFillColor(f);if(null!=T)return T}break;case"CIMTextSymbol":return X.getFillColor(_.symbol);case"CIMSolidFill":return _.color}}static getStrokeColor(_){if(_)switch(_.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(_.symbolLayers)for(const f of _.symbolLayers){const T=X.getStrokeColor(f);if(void 0!==T)return T}break;case"CIMTextSymbol":return X.getStrokeColor(_.symbol);case"CIMSolidStroke":return _.color}}static getStrokeWidth(_){if(_)switch(_.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(_.symbolLayers)for(const f of _.symbolLayers){const T=X.getStrokeWidth(f);if(void 0!==T)return T}break;case"CIMTextSymbol":return X.getStrokeWidth(_.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return _.width}}static getSize(_){if(_)switch(_.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{let f=0;if(_.symbolLayers)for(const T of _.symbolLayers){const I=X.getSize(T);I>f&&(f=I)}return f}case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":return _.width;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":return _.size}}static getMarkerScaleRatio(_){if(_&&"CIMVectorMarker"===_.type&&!1!==_.scaleSymbolsProportionally&&_.frame){const f=_.frame.ymax-_.frame.ymin;return _.size/f}return 1}}class h{static rasterizeSimpleFill(_,f,T){"solid"!==f&&"none"!==f&&"esriSFSSolid"!==f&&"esriSFSNull"!==f||console.error("Unexpected: style does not require rasterization");const I=(0,vt.fp)(Math.ceil(T)),B=ct(f)?8*I:16*I,C=2*I;_.width=B,_.height=B;const U=_.getContext("2d");U.strokeStyle="#FFFFFF",U.lineWidth=I,U.beginPath(),"vertical"!==f&&"cross"!==f&&"esriSFSCross"!==f&&"esriSFSVertical"!==f||(U.moveTo(B/2,-C),U.lineTo(B/2,B+C)),"horizontal"!==f&&"cross"!==f&&"esriSFSCross"!==f&&"esriSFSHorizontal"!==f||(U.moveTo(-C,B/2),U.lineTo(B+C,B/2)),"forward-diagonal"!==f&&"diagonal-cross"!==f&&"esriSFSDiagonalCross"!==f&&"esriSFSForwardDiagonal"!==f||(U.moveTo(-C,-C),U.lineTo(B+C,B+C),U.moveTo(B-C,-C),U.lineTo(B+C,C),U.moveTo(-C,B-C),U.lineTo(C,B+C)),"backward-diagonal"!==f&&"diagonal-cross"!==f&&"esriSFSBackwardDiagonal"!==f&&"esriSFSDiagonalCross"!==f||(U.moveTo(B+C,-C),U.lineTo(-C,B+C),U.moveTo(C,-C),U.lineTo(-C,C),U.moveTo(B+C,B-C),U.lineTo(B-C,B+C)),U.stroke();const A=U.getImageData(0,0,_.width,_.height),tt=new Uint8Array(A.data);let et;for(let at=0;at<tt.length;at+=4)et=tt[at+3]/255,tt[at]=tt[at]*et,tt[at+1]=tt[at+1]*et,tt[at+2]=tt[at+2]*et;return[tt,_.width,_.height]}static rasterizeSimpleLine(_,f){return this.rasterizeDash(_,f)}static rasterizeDash(_,f){const T="Butt"===f,I="Square"===f,B=!T&&!I;_.length%2==1&&(_=[..._,..._]);const C=15.5;let A=0;for(const Mt of _)A+=Mt;const tt=Math.round(A*C),et=new Float32Array(31*tt);let Et=0,ft=0,It=.5,pt=!0;for(const Mt of _){for(Et=ft,ft+=Mt*C;It<=ft;){let Dt=.5;for(;Dt<31;){const Ht=(Dt-.5)*tt+It-.5,Ut=B?(Dt-C)*(Dt-C):Math.abs(Dt-C);et[Ht]=pt?T?Math.max(Math.max(Et+7.75-It,Ut),Math.max(It-ft+7.75,Ut)):Ut:B?Math.min((It-Et)*(It-Et)+Ut,(It-ft)*(It-ft)+Ut):I?Math.min(Math.max(It-Et,Ut),Math.max(ft-It,Ut)):Math.min(Math.max(It-Et+7.75,Ut),Math.max(ft+7.75-It,Ut)),Dt++}It++}pt=!pt}const Tt=et.length,Rt=new Uint8Array(4*Tt);for(let Mt=0;Mt<Tt;++Mt){const Dt=(B?Math.sqrt(et[Mt]):et[Mt])/C;(0,q.I)(Dt,Rt,4*Mt)}return[Rt,tt,31]}}class y{static findApplicableOverrides(_,f,T){if(f){if(_.primitiveName){let I=!1;for(const B of T)if(B.primitiveName===_.primitiveName){I=!0;break}if(!I)for(const B of f)B.primitiveName===_.primitiveName&&T.push(B)}switch(_.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(_.effects)for(const I of _.effects)y.findApplicableOverrides(I,f,T);if(_.symbolLayers)for(const I of _.symbolLayers)y.findApplicableOverrides(I,f,T);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(_.effects)for(const I of _.effects)y.findApplicableOverrides(I,f,T);if(_.markerPlacement&&y.findApplicableOverrides(_.markerPlacement,f,T),"CIMVectorMarker"===_.type){if(_.markerGraphics)for(const I of _.markerGraphics)y.findApplicableOverrides(I,f,T),y.findApplicableOverrides(I.symbol,f,T)}else"CIMCharacterMarker"===_.type?y.findApplicableOverrides(_.symbol,f,T):"CIMHatchFill"===_.type&&y.findApplicableOverrides(_.lineSymbol,f,T)}}}static applyOverrides(_,f,T,I){if(!f)return;const B=C=>C&&C.charAt(0).toLowerCase()+C.substr(1);if(_.primitiveName)for(const C of f)if(C.primitiveName===_.primitiveName){const U=B(C.propertyName);if(I&&I.push({cim:_,nocapPropertyName:U,value:_[U]}),C.expression&&(C.value=y.toValue(C.propertyName,C.expression)),T){let A=!1;for(const tt of T)tt.primitiveName===_.primitiveName&&(A=!0);A||T.push(C)}_[U]=C.value}switch(_.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(_.effects)for(const C of _.effects)y.applyOverrides(C,f,T,I);if(_.symbolLayers)for(const C of _.symbolLayers)y.applyOverrides(C,f,T,I);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(_.effects)for(const C of _.effects)y.applyOverrides(C,f,T,I);if("CIMVectorMarker"===_.type&&_.markerGraphics)for(const C of _.markerGraphics)y.applyOverrides(C,f,T,I),y.applyOverrides(C.symbol,f,T,I)}}static restoreOverrides(_){for(const f of _)f.cim[f.nocapPropertyName]=f.value}static buildOverrideKey(_){let f="";for(const T of _)void 0!==T.value&&(f+=`${T.primitiveName}${T.propertyName}${JSON.stringify(T.value)}`);return f}static toValue(_,f){if("DashTemplate"===_)return f.split(" ").map(T=>Number(T));if("Color"===_){const T=new Q.Z(f).toRgba();return T[3]*=255,T}return f}}const k=O=>{if(!O)return"Butt";switch(O){case"butt":return"Butt";case"square":return"Square";case"round":return"Round"}},M=O=>{if(!O)return"Miter";switch(O){case"miter":return"Miter";case"round":return"Round";case"bevel":return"Bevel"}},R=O=>{if(!O)return"Center";switch(O){case"left":return"Left";case"right":return"Right";case"center":return"Center";case"justify":return"Justify"}},j=O=>{if(!O)return"Center";switch(O){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},z=O=>{if(!O)return[0,0,0,0];const{r:_,g:f,b:T,a:I}=O;return[_,f,T,255*I]},Z=(O,_)=>{const f=mt(_),T=ut(O);return f&&T?`${f}-${T}`:`${f}${T}`},mt=O=>{if(!O)return"";switch(O.toLowerCase()){case"bold":case"bolder":return"bold"}return""},ut=O=>{if(!O)return"";switch(O.toLowerCase()){case"italic":case"oblique":return"italic"}return""},dt=(O,_)=>{const f="butt"===_;switch(O){case"dash":case"esriSLSDash":return f?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return f?[4,3,1,3]:[3,4,0,4];case"dot":case"esriSLSDot":return f?[1,3]:[0,4];case"long-dash":case"esriSLSLongDash":return f?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return f?[8,3,1,3]:[7,4,0,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return f?[8,3,1,3,1,3]:[7,4,0,4,0,4];case"short-dash":case"esriSLSShortDash":return f?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return f?[4,1,1,1]:[3,2,0,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return f?[4,1,1,1,1,1]:[3,2,0,2,0,2];case"short-dot":case"esriSLSShortDot":return f?[1,1]:[0,2];case"solid":case"esriSLSSolid":case"none":return r.error("Unexpected: style does not require rasterization"),[0,0];default:return r.error(`Tried to rasterize SLS, but found an unexpected style: ${O}!`),[0,0]}};const zt=O=>{const f=50;let T,I;const B=O;if("circle"===B||"esriSMSCircle"===B){let U=Math.acos(.995),A=Math.ceil(w/U/4);0===A&&(A=1),U=K/A,A*=4;const tt=[];tt.push([f,0]);for(let et=1;et<A;et++)tt.push([f*Math.cos(et*U),-f*Math.sin(et*U)]);tt.push([f,0]),T={rings:[tt]},I={xmin:-f,ymin:-f,xmax:f,ymax:f}}else if("cross"===B||"esriSMSCross"===B){const C=0;T={rings:[[[C,f],[C,C],[f,C],[f,-C],[C,-C],[C,-f],[-C,-f],[-C,-C],[-f,-C],[-f,C],[-C,C],[-C,f],[C,f]]]},I={xmin:-f,ymin:-f,xmax:f,ymax:f}}else if("diamond"===B||"esriSMSDiamond"===B)T={rings:[[[-f,0],[0,f],[f,0],[0,-f],[-f,0]]]},I={xmin:-f,ymin:-f,xmax:f,ymax:f};else if("square"===B||"esriSMSSquare"===B)T={rings:[[[-f,-f],[-f,f],[f,f],[f,-f],[-f,-f]]]},I={xmin:-f,ymin:-f,xmax:f,ymax:f};else if("x"===B||"esriSMSX"===B){const C=0;T={rings:[[[0,C],[f-C,f],[f,f-C],[C,0],[f,C-f],[f-C,-f],[0,-C],[C-f,-f],[-f,C-f],[-C,0],[-f,f-C],[C-f,f],[0,C]]]},I={xmin:-f,ymin:-f,xmax:f,ymax:f}}else if("triangle"===B||"esriSMSTriangle"===B){const C=57.735026918962575,U=-C,A=2/3*100,tt=A-100;T={rings:[[[U,tt],[0,A],[C,tt],[U,tt]]]},I={xmin:U,ymin:tt,xmax:C,ymax:A}}else"arrow"===B&&(T={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},I={xmin:-f,ymin:-f,xmax:f,ymax:f});return[I,T]},ct=O=>"vertical"===O||"horizontal"===O||"cross"===O||"esriSFSCross"===O||"esriSFSVertical"===O||"esriSFSHorizontal"===O},49198:(Ft,bt,Y)=>{Y.d(bt,{Z:()=>Q});class Q{constructor(q=0,lt=0,wt=0,vt=0){this.x=q,this.y=lt,this.width=wt,this.height=vt}get isEmpty(){return this.width<=0||this.height<=0}union(q){this.x=Math.min(this.x,q.x),this.y=Math.min(this.y,q.y),this.width=Math.max(this.width,q.width),this.height=Math.max(this.height,q.height)}}},16120:(Ft,bt,Y)=>{Y.d(bt,{d:()=>lt});var Q=Y(75244);class lt{constructor(){}rasterizeText(D,F){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const st=this._textRasterizationCanvas,it=st.getContext("2d");this.setFontProperties(it,F),this.parameters=F,this.textLines=D.split(/\r?\n/),this.lineHeight=this.computeLineHeight();const ot=this.computeTextWidth(it,F),{decoration:ht,weight:gt}=F.font;this.lineThroughWidthOffset=ht&&"line-through"===ht?.1*this.lineHeight:0;const Ct=this.lineHeight*this.textLines.length;var At;st.width=ot+2*this.lineThroughWidthOffset,st.height=Ct,this.renderedLineHeight=Math.round(this.lineHeight*F.pixelRatio),this.renderedHaloSize=F.halo.size*F.pixelRatio,this.renderedWidth=ot*F.pixelRatio,this.renderedHeight=Ct*F.pixelRatio,this.lineThroughWidthOffset*=F.pixelRatio,this.fillStyle=`rgba(${(At=F.color).slice(0,3).toString()},${At[3]})`,this.haloStyle=function(At){return`rgb(${At.slice(0,3).toString()})`}(F.halo.color);const n=this.renderedLineHeight,w=this.renderedHaloSize;this.setFontProperties(it,F);const K=function(At,D){return"center"===At?.5*D:"right"===At?D:0}(it.textAlign,this.renderedWidth)+w,nt=w,e=w>0;let H=this.lineThroughWidthOffset,St=0;e&&this.renderHalo(it,K,nt,H,St,F),St+=nt,H+=K;for(const L of this.textLines)it.globalCompositeOperation="destination-out",it.fillStyle="rgb(0, 0, 0)",it.fillText(L,H,St),it.globalCompositeOperation="source-over",it.fillStyle=this.fillStyle,it.fillText(L,H,St),ht&&"none"!==ht&&this.renderDecoration(it,H,St,ht,gt),St+=n;const r=this.renderedWidth+2*this.lineThroughWidthOffset,kt=this.renderedHeight,_t=it.getImageData(0,0,r,kt),E=new Uint8Array(_t.data);if(F.premultiplyColors){let L;for(let u=0;u<E.length;u+=4)L=E[u+3]/255,E[u]=E[u]*L,E[u+1]=E[u+1]*L,E[u+2]=E[u+2]*L}return{size:[r,kt],image:new Uint32Array(E.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}renderHalo(D,F,st,it,ot,ht){const gt=this.renderedWidth,Ct=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=gt,this._haloRasterizationCanvas.height=Ct;const n=this._haloRasterizationCanvas,w=n.getContext("2d");w.clearRect(0,0,gt,Ct),this.setFontProperties(w,ht);const{decoration:K,weight:nt}=ht.font;w.fillStyle=this.haloStyle,w.strokeStyle=this.haloStyle;const e=this.renderedHaloSize<3;w.lineJoin=e?"miter":"round",e?this.renderHaloEmulated(w,F,st,K,nt):this.renderHaloNative(w,F,st,K,nt),D.globalAlpha=this.parameters.halo.color[3],D.drawImage(n,0,0,gt,Ct,it,ot,gt,Ct),D.globalAlpha=1}renderHaloEmulated(D,F,st,it,ot){const ht=this.renderedLineHeight,gt=this.renderedHaloSize;for(const Ct of this.textLines){for(const[n,w]of vt)D.fillText(Ct,F+gt*n,st+gt*w);it&&"none"!==it&&this.renderDecoration(D,F,st,it,ot),st+=ht}}renderHaloNative(D,F,st,it,ot){const ht=this.renderedLineHeight,gt=this.renderedHaloSize;for(const Ct of this.textLines){const n=2*gt,w=5,K=.1;for(let nt=0;nt<w;nt++){const e=1-(w-1)*K+nt*K;D.lineWidth=e*n,D.strokeText(Ct,F,st),it&&"none"!==it&&this.renderDecoration(D,F,st,it,ot)}st+=ht}}setFontProperties(D,F){const st=F.font,it=`${st.style} ${st.weight} ${(0,Q.F2)(F.size*F.pixelRatio)}px ${st.family}, sans-serif`;let ot;switch(D.font=it,D.textBaseline="top",F.horizontalAlignment){case"left":default:ot="left";break;case"right":ot="right";break;case"center":ot="center"}D.textAlign=ot}computeTextSize(D,F){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const st=this._textRasterizationCanvas,it=st.getContext("2d");this.setFontProperties(it,F),this.parameters=F,this.textLines=D.split(/\r?\n/),this.lineHeight=this.computeLineHeight();const ot=this.computeTextWidth(it,F),ht=this.lineHeight*this.textLines.length;return st.width=ot,st.height=ht,[ot*F.pixelRatio,ht*F.pixelRatio]}computeTextWidth(D,F){let st=0;for(const ot of this.textLines)st=Math.max(st,D.measureText(ot).width);const it=F.font;return("italic"===it.style||"oblique"===it.style||"string"==typeof it.weight&&("bold"===it.weight||"bolder"===it.weight)||"number"==typeof it.weight&&it.weight>600)&&(st+=.3*D.measureText("w").width),st+=2*this.parameters.halo.size,Math.round(st)}computeLineHeight(){let D=1.275*this.parameters.size;const F=this.parameters.font.decoration;return F&&"underline"===F&&(D*=1.3),Math.round(D+2*this.parameters.halo.size)}renderDecoration(D,F,st,it,ot){const ht=.9*this.lineHeight,gt="bold"===ot?.06:"bolder"===ot?.09:.04;switch(D.textAlign){case"center":F-=this.renderedWidth/2;break;case"right":F-=this.renderedWidth}const Ct=D.textBaseline;if("underline"===it)switch(Ct){case"top":st+=ht;break;case"middle":st+=ht/2}else if("line-through"===it)switch(Ct){case"top":st+=ht/1.5;break;case"middle":st+=ht/3}D.save(),D.beginPath(),D.strokeStyle=D.fillStyle,D.lineWidth=Math.ceil(ht*gt),D.moveTo(F-this.lineThroughWidthOffset,st),D.lineTo(F+this.renderedWidth+2*this.lineThroughWidthOffset,st),D.stroke(),D.restore()}}const vt=[];{const At=16;for(let D=0;D<360;D+=360/At)vt.push([Math.cos(Math.PI*D/180),Math.sin(Math.PI*D/180)])}},14437:(Ft,bt,Y)=>{Y.d(bt,{_U:()=>q,DT:()=>D,B1:()=>Q,JJ:()=>G,sX:()=>w,k3:()=>Ct,DQ:()=>ot,Or:()=>ht});const Q=Number.POSITIVE_INFINITY,G=Math.PI,q=2*G,wt=128/G,D=G/180,it=1/Math.LN2;function ot(nt,e){return(nt%=e)>=0?nt:nt+e}function ht(nt){return ot(nt*wt,256)}function Ct(nt){return Math.log(nt)*it}function w(nt,e,H){return nt*(1-H)+e*H}},16434:(Ft,bt,Y)=>{Y.d(bt,{Z:()=>Q});class Q{constructor(q=0,lt=0,wt=0,vt=0){this.x=q,this.y=lt,this.width=wt,this.height=vt}get isEmpty(){return this.width<=0||this.height<=0}union(q){this.x=Math.min(this.x,q.x),this.y=Math.min(this.y,q.y),this.width=Math.max(this.width,q.width),this.height=Math.max(this.height,q.height)}}},48197:(Ft,bt,Y)=>{var Q,G,F;function q(F){switch(F){case"left":return Q.Left;case"right":return Q.Right;case"center":case"justify":return Q.Center}}function lt(F){switch(F){case"top":return G.Top;case"middle":return G.Center;case"baseline":return G.Baseline;case"bottom":return G.Bottom}}function wt(F){switch(F){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[Q.Right,G.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[Q.Center,G.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[Q.Left,G.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[Q.Right,G.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[Q.Center,G.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[Q.Left,G.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[Q.Right,G.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[Q.Center,G.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[Q.Left,G.Top];default:return console.debug(`Found invalid placement type ${F}`),[Q.Center,G.Center]}}function vt(F){switch(F){case Q.Right:return-1;case Q.Center:return 0;case Q.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${F}`),0}}function At(F){switch(F){case G.Top:return 1;case G.Center:return 0;case G.Bottom:case G.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${F}`),0}}function D(F){switch(F){case"left":return Q.Left;case"right":return Q.Right;case"center":case"justify":return Q.Center}}Y.d(bt,{M7:()=>Q,TR:()=>G,qv:()=>wt,Hd:()=>D,kH:()=>q,g:()=>vt,b7:()=>lt,tf:()=>At}),(F=Q||(Q={}))[F.Left=-1]="Left",F[F.Center=0]="Center",F[F.Right=1]="Right",function(F){F[F.Top=1]="Top",F[F.Center=0]="Center",F[F.Bottom=-1]="Bottom",F[F.Baseline=2]="Baseline"}(G||(G={}))},20800:(Ft,bt,Y)=>{Y.d(bt,{Nr:()=>kt});var Q=Y(62039),G=Y(63319),q=Y(68292),lt=Y(74181),wt=Y(48197),vt=Y(47677),At=Y(16434);class D{constructor(E,L,u,rt){this.center=(0,lt.f)(E,L),this.centerT=(0,lt.c)(),this.halfWidth=u/2,this.halfHeight=rt/2,this.width=u,this.height=rt}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(E){this.center[0]=E}set y(E){this.center[1]=E}clone(){return new D(this.x,this.y,this.width,this.height)}serialize(E){return E.writeF32(this.center[0]),E.writeF32(this.center[1]),E.push(this.width),E.push(this.height),E}findCollisionDelta(E,L=4){const u=Math.abs(E.centerT[0]-this.centerT[0]),rt=Math.abs(E.centerT[1]-this.centerT[1]),X=(E.halfWidth+this.halfWidth+L)/u,h=(E.halfHeight+this.halfHeight+L)/rt,y=Math.min(X,h);return Math.log2(y)}extend(E){const L=Math.min(this.xmin,E.xmin),u=Math.min(this.ymin,E.ymin),rt=Math.max(this.xmax,E.xmax)-L,X=Math.max(this.ymax,E.ymax)-u,h=L+rt/2,y=u+X/2;this.width=rt,this.height=X,this.halfWidth=rt/2,this.halfHeight=X/2,this.x=h,this.y=y}static deserialize(E){const L=E.readF32(),u=E.readF32(),rt=E.readInt32(),X=E.readInt32();return new D(L,u,rt,X)}}const Ct=Math.PI/180;class n{constructor(E,L,u,rt){this._rotationT=(0,G.c)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const X=u.rect,h=new Float32Array(8);E*=rt,L*=rt;const y=u.code?X.width*rt:u.metrics.width,k=u.code?X.height*rt:u.metrics.height;h[0]=E,h[1]=L,h[2]=E+y,h[3]=L,h[4]=E,h[5]=L+k,h[6]=E+y,h[7]=L+k,this._data=h,this._setTextureCoords(X),this._scale=rt,this._mosaic=u,this.x=E,this.y=L,this.maxOffset=Math.max(E+y,L+k)}get width(){return this._mosaic.metrics.width*this._scale}get mosaic(){return this._mosaic}set angle(E){this._angle=E,(0,Q.i)(this._rotationT),(0,Q.r)(this._rotationT,this._rotationT,-E),this._setOffsets(this._data)}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(this._data),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:E,width:L}=this._mosaic.metrics,u=L*this._scale,rt=Math.abs(E)*this._scale,X=new Float32Array(8);X[0]=this.x,X[1]=this.y,X[2]=this.x+u,X[3]=this.y,X[4]=this.x,X[5]=this.y+rt,X[6]=this.x+u,X[7]=this.y+rt;const h=(0,Q.m)((0,G.c)(),this._rotationT,this._T);(0,G.t)(X,X,h);let y=1/0,k=1/0,M=0,R=0;for(let ut=0;ut<4;ut++){const dt=X[2*ut],Pt=X[2*ut+1];y=Math.min(y,dt),k=Math.min(k,Pt),M=Math.max(M,dt),R=Math.max(R,Pt)}const j=M-y,z=R-k,Z=y+j/2,mt=k+z/2;this._bounds=new D(Z,mt,j,z)}return this._bounds}setTransform(E){this._T=E,this._offsets=null}_setOffsets(E){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const L=this._offsets,u=new Float32Array(8),rt=(0,Q.m)((0,G.c)(),this._rotationT,this._T);(0,G.t)(u,E,rt),L.upperLeft=(0,vt.UJ)(8*u[0],8*u[1]),L.upperRight=(0,vt.UJ)(8*u[2],8*u[3]),L.lowerLeft=(0,vt.UJ)(8*u[4],8*u[5]),L.lowerRight=(0,vt.UJ)(8*u[6],8*u[7])}_setTextureCoords({x:E,y:L,width:u,height:rt}){this._texcoords={upperLeft:(0,vt.UJ)(E,L),upperRight:(0,vt.UJ)(E+u,L),lowerLeft:(0,vt.UJ)(E,L+rt),lowerRight:(0,vt.UJ)(E+u,L+rt)}}}const w=(_t,E)=>({code:0,page:0,sdf:!0,rect:new At.Z(0,0,11,8),textureBinding:E,metrics:{advance:0,height:4,width:_t,left:0,top:0}});class K{constructor(E,L,u){this._rotation=0,this._decorate(E,L,u),this.glyphs=E,this.bounds=this._createBounds(E),this.isMultiline=L.length>1,this._hasRotation=0!==u.angle,this._T=this._createGlyphTransform(this.bounds,u);for(const rt of E)rt.setTransform(this._T)}setRotation(E){if(0===E&&0===this._rotation)return;this._rotation=E;const L=this._T,u=(0,Q.b)((0,G.c)(),E);(0,Q.m)(L,u,L);for(const rt of this.glyphs)rt.setTransform(this._T)}_decorate(E,L,u){if(!u.decoration||"none"===u.decoration||!E.length)return;const rt=u.scale,X="underline"===u.decoration?30:20,h=E[0].textureBinding;for(const y of L){const k=y.startX*rt,M=y.startY*rt,R=(y.width+y.glyphWidthEnd)*rt;E.push(new n(k,M+X*rt,w(R,h),1))}}get boundsT(){const E=this.bounds,L=(0,q.s)((0,lt.c)(),E.x,E.y);if((0,q.t)(L,L,this._T),this._hasRotation){const u=Math.max(E.width,E.height);return new D(L[0],L[1],u,u)}return new D(L[0],L[1],E.width,E.height)}_createBounds(E){let L=1/0,u=1/0,rt=0,X=0;for(const k of E)L=Math.min(L,k.xTopLeft),u=Math.min(u,k.yTopLeft),rt=Math.max(rt,k.xTopLeft+k.width),X=Math.max(X,k.yBottomRight);const h=rt-L,y=X-u;return new D(L+h/2,u+y/2,h,y)}_createGlyphTransform(E,L){const u=Ct*L.angle,rt=(0,G.c)(),X=(0,lt.c)();return(0,Q.t)(rt,rt,(0,q.s)(X,L.xOffset,-L.yOffset)),L.isCIM?(0,Q.r)(rt,rt,u):((0,Q.t)(rt,rt,(0,q.s)(X,E.x,E.y)),(0,Q.r)(rt,rt,u),(0,Q.t)(rt,rt,(0,q.s)(X,-E.x,-E.y))),rt}}class nt{constructor(E,L,u,rt,X,h){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(L,u)),this.end=Math.max(0,Math.max(L,u)),this.end<E.length&&(this.glyphWidthEnd=E[this.end].metrics.width),this.width=rt,this.yMin=X,this.yMax=h}}const e=_t=>10===_t,H=_t=>32===_t;function kt(_t,E,L){const u=L.scale,rt=new Array,X=function(_t,E,L){const u=new Array,rt=1/L.scale,X=L.maxLineWidth*rt,h=E?_t.length-1:0,y=E?-1:_t.length,k=E?-1:1;let M=h,R=0,j=0,z=M,Z=z,mt=0,ut=1/0,dt=0;for(;M!==y;){const{code:zt,metrics:ct}=_t[M],O=Math.abs(ct.top);if(e(zt)||H(zt)||(ut=Math.min(ut,O),dt=Math.max(dt,O+ct.height)),e(zt))M!==h&&(u.push(new nt(_t,z,M-k,R,ut,dt)),ut=1/0,dt=0),R=0,z=M+k,Z=M+k,j=0;else if(H(zt))Z=M+k,j=0,mt=ct.advance,R+=ct.advance;else if(R>X){if(Z!==z){const _=Z-2*k;R-=mt,u.push(new nt(_t,z,_,R-j,ut,dt)),ut=1/0,dt=0,z=Z,R=j}else u.push(new nt(_t,z,M-k,R,ut,dt)),ut=1/0,dt=0,z=M,Z=M,R=0;R+=ct.advance,j+=ct.advance}else R+=ct.advance,j+=ct.advance;M+=k}const Pt=new nt(_t,z,M-k,R,ut,dt);return Pt.start>=0&&Pt.end<_t.length&&u.push(Pt),u}(_t,E,L),h=function(_t,E){let L=0;for(let X=0;X<_t.length;X++){const{width:h}=_t[X];L=Math.max(h,L)}const u="underline"===E.decoration?4:0,rt=_t[0].yMin;return{x:0,y:rt,height:_t[_t.length-1].yMax+E.lineHeight*(_t.length-1)+u-rt,width:L}}(X,L),{vAlign:y,hAlign:k}=L,M=y===wt.TR.Baseline?1:0,R=M?0:y-1,j=(1-M)*-h.y+R*(h.height/2)+-26*(M?1:0);for(let z=0;z<X.length;z++){const{start:Z,end:mt,width:ut}=X[z];let dt=-1*(k+1)*(ut/2)-3;const Pt=z*L.lineHeight+j-3;X[z].startX=dt,X[z].startY=Pt;for(let zt=Z;zt<=mt;zt++){const ct=_t[zt];if(e(ct.code))continue;const O=new n(dt+ct.metrics.left,Pt-ct.metrics.top,ct,u);dt+=ct.metrics.advance,rt.push(O)}}return new K(rt,X,L)}}}]);
//# sourceMappingURL=4915.9048ec8343cd519781d1.js.map