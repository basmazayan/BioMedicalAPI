"use strict";var x=Object.defineProperty,M=Object.defineProperties,A=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,b=(n,a,i)=>a in n?x(n,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[a]=i,w=(n,a)=>{for(var i in a||(a={}))B.call(a,i)&&b(n,i,a[i]);if(p)for(var i of p(a))S.call(a,i)&&b(n,i,a[i]);return n},m=(n,a)=>M(n,A(a));(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[9074],{59074:(n,a,i)=>{i.r(a),i.d(a,{default:()=>R});var o=i(79076),u=(i(22345),i(55865),i(45072),i(30627),i(72062),i(96410)),C=(i(20316),i(1907)),L=(i(59450),i(42909),i(30905),i(36079),i(86550),i(84700));class O extends L.Z{constructor(){super(...arguments),this._lastWidth=0,this._lastHeight=0,this.requiresDedicatedFBO=!1}dispose(){this._renderTarget&&(this._renderTarget.dispose(),this._renderTarget=null)}doRender(t){const r=this.createRenderParams(t),{context:s,painter:l,profiler:h}=r;this._prevFBO=s.getBoundFramebufferObject(),h.recordContainerStart(this.name);const y=this._getFbo(r),V=l.getRenderTarget();s.bindFramebuffer(y),l.setRenderTarget(y),s.setDepthWriteEnabled(!0),s.setColorMask(!0,!0,!0,!0),s.setClearColor(0,0,0,0),s.setClearDepth(1),s.clear(s.gl.COLOR_BUFFER_BIT|s.gl.DEPTH_BUFFER_BIT),s.setDepthWriteEnabled(!1);for(const c of this.children)c.beforeRender(t);for(const c of this.children)c.processRender(r);for(const c of this.children)c.afterRender(t);l.setRenderTarget(V),s.bindFramebuffer(this._prevFBO),l.beforeRenderLayer(r,this._clippingInfos?255:0,this.computedOpacity),s.setStencilTestEnabled(!1),s.setStencilWriteMask(0),l.blitTexture(s,y.colorTexture,9728),l.compositeLayer(r,this.computedOpacity),h.recordContainerEnd()}createRenderParams(t){return m(w({},super.createRenderParams(t)),{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1})}_getFbo(t){const{context:r,painter:s}=t,{width:l,height:h}=r.getViewport();if(l!==this._lastWidth||h!==this._lastHeight)if(this._lastWidth=l,this._lastHeight=h,this._renderTarget)this._renderTarget.resize(l,h);else{const y={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:l,height:h},V={colorTarget:0,depthStencilTarget:3};this._renderTarget=new C.Z(r,V,y,s.getSharedStencilBuffer())}return this._renderTarget}}var T=i(78081),F=i(97750),f=i(81713),g=i(94911),E=i(96121);let d=class extends E.Z{constructor(e){super(e),this.type="group",this.layerViews=new F.Z}initialize(){this.handles.add([this.layerViews.on("change",e=>this._layerViewsChangeHandler(e)),this.layerViews.on("after-changes",()=>this._layerViewsAfterChangesHandler()),this.layer.watch("visibilityMode",()=>this._visibilityModeHandler(),!0),this.watch("visible",()=>this._visibleHandler(),!0)],"grouplayerview"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]}),this._layerViewsAfterChangesHandler()}set layerViews(e){this._set("layerViews",(0,f.Z)(e,this._get("layerViews")))}isUpdating(){return this.layerViews.some(e=>e.updating)}get updatingProgress(){return 0===this.layerViews.length?1:this.layerViews.reduce((e,t)=>e+t.updatingProgress,0)/this.layerViews.length}_hasLayerViewVisibleOverrides(){return this.layerViews.some(e=>e._isOverridden("visible"))}_findLayerViewForLayer(e){return e&&this.layerViews.find(t=>t.layer===e)}_firstVisibleOnLayerOrder(){const e=this.layer.layers.find(t=>{const r=this._findLayerViewForLayer(t);return r&&r.visible});return e&&this._findLayerViewForLayer(e)}_enforceExclusiveVisibility(e){this._hasLayerViewVisibleOverrides()&&(e||!(e=this._firstVisibleOnLayerOrder())&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.getItemAt(0))),this.layerViews.forEach(t=>{t.visible=t===e}))}_layerViewsChangeHandler(e){this.handles.remove("grouplayerview:visible"),this.handles.add(this.layerViews.map(s=>s.watch("visible",l=>this._layerViewVisibleHandler(l,s),!0)).toArray(),"grouplayerview:visible");const t=e.added[e.added.length-1];let r=null;t&&t.visible&&(r=t),this._enforceVisibility(r)}_layerViewsAfterChangesHandler(){this.handles.remove("grouplayerview:updating"),this.handles.add(this.layerViews.map(e=>e.watch("updating",()=>this._updateUpdating(),!0)).toArray(),"grouplayerview:updating"),this._updateUpdating()}_enforceVisibility(e){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case"inherited":{const t=this.visible;this.layerViews.forEach(r=>{r.visible=t});break}case"exclusive":this._enforceExclusiveVisibility(e)}}_visibilityModeHandler(){this._enforceVisibility()}_layerViewVisibleHandler(e,t){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case"inherited":e!==this.visible&&(t.visible=this.visible);break;case"exclusive":this._enforceExclusiveVisibility(e&&t)}}_visibleHandler(){var e;this._hasLayerViewVisibleOverrides()&&"inherited"===(null==(e=this.layer)?void 0:e.visibilityMode)&&this._enforceVisibility()}_updateUpdating(){this.notifyChange("updating")}};(0,o._)([(0,g.Cb)({cast:f.R})],d.prototype,"layerViews",null),(0,o._)([(0,g.Cb)()],d.prototype,"view",void 0),(0,o._)([(0,g.Cb)({readOnly:!0})],d.prototype,"updatingProgress",null),d=(0,o._)([(0,u.j)("esri.views.layers.GroupLayerView")],d);const H=d;let v=class extends((0,T.y)(H)){constructor(){super(...arguments),this.container=new O}attach(){this._updateStageChildren(),this.handles.add(this.layerViews.on("after-changes",()=>this._updateStageChildren()),"grouplayerview2d")}detach(){this.handles.remove("grouplayerview2d"),this.container.removeAllChildren()}update(e){}moveStart(){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,t)=>this.container.addChildAt(e.container,t))}};v=(0,o._)([(0,u.j)("esri.views.2d.layers.GroupLayerView2D")],v);const R=v}}]);
//# sourceMappingURL=9074.e4a335fc2c3717f238fc.js.map