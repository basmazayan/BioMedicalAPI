"use strict";var ie=Object.defineProperty,B=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,U=(O,_,t)=>_ in O?ie(O,_,{enumerable:!0,configurable:!0,writable:!0,value:t}):O[_]=t,A=(O,_)=>{for(var t in _||(_={}))ne.call(_,t)&&U(O,t,_[t]);if(B)for(var t of B(_))se.call(_,t)&&U(O,t,_[t]);return O};(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[747],{60747:(O,_,t)=>{t.r(_),t.d(_,{default:()=>le});var K=t(49996),l=t(79076),J=(t(61243),t(99326)),h=(t(85700),t(97750)),x=t(61414),v=t(60161),d=t(18502),Z=t(32810),w=t(47914),I=t(68364),y=t(94911),E=(t(55865),t(38650)),R=t(96410),G=t(88445),C=t(19784),F=t(31582),z=t(35169),$=t(33830),V=t(48092),X=t(2045),H=t(19109),Q=t(88945),Y=t(46839),k=t(32617),q=t(41099),j=t(66536),ee=t(42247),te=t(41159),N=t(85076),re=t(51159),b=t(96583),L=t(70157);function D(r){return r.layers.some(e=>null!=e.layerDefinition.visibilityField)}const W=new j.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),oe=new j.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0});let S=class extends V.Z{constructor(){super(...arguments),this.visibilityMode="inherited"}initialize(){for(const r of this.graphics)r.sourceLayer=this.layer;this.graphics.on("after-add",r=>{r.item.sourceLayer=this.layer}),this.graphics.on("after-remove",r=>{r.item.sourceLayer=null})}get sublayers(){return this.graphics}};(0,l._)([(0,y.Cb)({readOnly:!0})],S.prototype,"sublayers",null),(0,l._)([(0,y.Cb)()],S.prototype,"layer",void 0),(0,l._)([(0,y.Cb)({readOnly:!0})],S.prototype,"visibilityMode",void 0),S=(0,l._)([(0,R.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],S);const T=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",layerId:"polygonLayer",title:"Polygons",identifyingSymbol:(new ee.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",layerId:"polylineLayer",title:"Polylines",identifyingSymbol:(new te.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",layerId:"multipointLayer",title:"Multipoints",identifyingSymbol:(new N.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"pointLayer",title:"Points",identifyingSymbol:(new N.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"textLayer",title:"Text",identifyingSymbol:(new re.Z).toJSON()}];let a=class extends((0,Q.h)((0,q.M)((0,Y.q)((0,k.I)((0,Z.R)(X.Z)))))){constructor(r){super(r),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=b.Z.WGS84,this.sublayers=new h.Z(T.map(e=>new S({id:e.layerId,title:e.title,layer:this}))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(r,e,o){return{operations:{supportsMapNotesEditing:!D(e)&&"portal-item"!==(null==o?void 0:o.origin)}}}readFeatureCollections(r,e,o){if(!D(e))return null;const n=e.layers.map(s=>{const i=new $.default;return i.read(s,o),i});return new h.Z({items:n})}readLegacyfeatureCollectionJSON(r,e){return D(e)?(0,v.d9)(e.featureCollection):null}readFullExtent(r,e){if(!e.layers.length||e.layers.every(n=>!n.layerDefinition.extent))return new L.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:b.Z.WGS84});const o=b.Z.fromJSON(e.layers[0].layerDefinition.spatialReference);return e.layers.reduce((n,s)=>{const i=s.layerDefinition.extent;return i?L.Z.fromJSON(i).union(n):n},new L.Z({spatialReference:o}))}readMinScale(r,e){for(const o of e.layers)if(null!=o.layerDefinition.minScale)return o.layerDefinition.minScale;return 0}readMaxScale(r,e){for(const o of e.layers)if(null!=o.layerDefinition.maxScale)return o.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(r,e){return e.layers.length?b.Z.fromJSON(e.layers[0].layerDefinition.spatialReference):b.Z.WGS84}readSublayers(r,e,o){if(D(e))return null;const n=[];for(let i=0;i<e.layers.length;i++){var s;const{layerDefinition:p,featureSet:u}=e.layers[i],c=null!=(s=p.geometryType)?s:u.geometryType,g=T.find(m=>{var f,M,P;return c===m.geometryTypeJSON&&(null==(f=p.drawingInfo)||null==(M=f.renderer)||null==(P=M.symbol)?void 0:P.type)===m.identifyingSymbol.type});if(g){const m=new S({id:g.layerId,title:p.name,layer:this,graphics:u.features.map(({geometry:f,symbol:M,attributes:P,popupInfo:ae})=>J.Z.fromJSON({attributes:P,geometry:f,symbol:M,popupTemplate:ae}))});n.push(m)}}return new h.Z(n)}writeSublayers(r,e,o,n){const{minScale:s,maxScale:i}=this;if((0,d.Wi)(r))return;const p=r.some(m=>m.graphics.length>0);var u;if(!this.capabilities.operations.supportsMapNotesEditing)return void(p&&(null==n||null==(u=n.messages)||u.push(new x.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer"))));const c=[];let g=this.spatialReference.toJSON();e:for(const m of r)for(const f of m.graphics)if((0,d.pC)(f.geometry)){g=f.geometry.spatialReference.toJSON();break e}for(const m of T){const f=r.find(M=>m.layerId===M.id);this._writeMapNoteSublayer(c,f,m,s,i,g,n)}(0,w.RB)("featureCollection.layers",c,e)}get textLayer(){return this._findSublayer("textLayer")}load(r){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},r)),Promise.resolve(this)}read(r,e){"featureCollection"in r&&(r=(0,v.d9)(r),Object.assign(r,r.featureCollection)),super.read(r,e)}beforeSave(){var r=this;return(0,K.Z)(function*(){if((0,d.Wi)(r.sublayers))return;let e=null;const o=[];for(const s of r.sublayers)for(const i of s.graphics)if((0,d.pC)(i.geometry)){const p=i.geometry;e?(0,z.fS)(p.spatialReference,e)||((0,C.Up)(p.spatialReference,e)||(0,C.kR)()||(yield(0,C.zD)()),i.geometry=(0,C.iV)(p,e)):e=p.spatialReference,o.push(i)}const n=yield(0,F.aX)(o.map(s=>s.geometry));o.forEach((s,i)=>s.geometry=n[i])})()}_findSublayer(r){var e,o;return(0,d.Wi)(this.sublayers)?null:null!=(e=null==(o=this.sublayers)?void 0:o.find(n=>n.id===r))?e:null}_writeMapNoteSublayer(r,e,o,n,s,i,p){const u=[];if(!(0,d.Wi)(e)){for(const c of e.graphics)this._writeMapNote(u,c,o.geometryType,p);this._normalizeObjectIds(u,W),r.push({layerDefinition:{name:e.title,drawingInfo:{renderer:{type:"simple",symbol:(0,v.d9)(o.identifyingSymbol)}},geometryType:o.geometryTypeJSON,minScale:n,maxScale:s,objectIdField:"OBJECTID",fields:[W.toJSON(),oe.toJSON()],spatialReference:i},featureSet:{features:u,geometryType:o.geometryTypeJSON}})}}_writeMapNote(r,e,o,n){if((0,d.Wi)(e))return;const{geometry:s,symbol:i,popupTemplate:p}=e;if((0,d.Wi)(s))return;var u,c;if(s.type!==o)return void(null==n||null==(u=n.messages)||u.push(new I.Z("map-notes-layer:invalid-geometry-type",`Geometry "${s.type}" cannot be saved in "${o}" layer`,{graphic:e})));if((0,d.Wi)(i))return void(null==n||null==(c=n.messages)||c.push(new I.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:e})));const g={attributes:A({},e.attributes),geometry:s.toJSON(),symbol:i.toJSON()};(0,d.pC)(p)&&(g.popupInfo=p.toJSON()),r.push(g)}_normalizeObjectIds(r,e){const o=e.name;let n=(0,H.S)(o,r)+1;const s=new Set;for(const i of r){i.attributes||(i.attributes={});const{attributes:p}=i;(null==p[o]||s.has(p[o]))&&(p[o]=n++),s.add(p[o])}}};(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"capabilities",void 0),(0,l._)([(0,E.r)(["portal-item","web-map"],"capabilities",["layers"])],a.prototype,"readCapabilities",null),(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"featureCollections",void 0),(0,l._)([(0,E.r)(["web-map","portal-item"],"featureCollections",["layers"])],a.prototype,"readFeatureCollections",null),(0,l._)([(0,y.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],a.prototype,"featureCollectionJSON",void 0),(0,l._)([(0,E.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],a.prototype,"readLegacyfeatureCollectionJSON",null),(0,l._)([(0,y.Cb)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],a.prototype,"featureCollectionType",void 0),(0,l._)([(0,y.Cb)({json:{write:!1}})],a.prototype,"fullExtent",void 0),(0,l._)([(0,E.r)(["web-map","portal-item"],"fullExtent",["layers"])],a.prototype,"readFullExtent",null),(0,l._)([(0,y.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],a.prototype,"legendEnabled",void 0),(0,l._)([(0,y.Cb)({type:["show","hide"]})],a.prototype,"listMode",void 0),(0,l._)([(0,y.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],a.prototype,"minScale",void 0),(0,l._)([(0,E.r)(["web-map","portal-item"],"minScale",["layers"])],a.prototype,"readMinScale",null),(0,l._)([(0,y.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],a.prototype,"maxScale",void 0),(0,l._)([(0,E.r)(["web-map","portal-item"],"maxScale",["layers"])],a.prototype,"readMaxScale",null),(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"multipointLayer",null),(0,l._)([(0,y.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],a.prototype,"operationalLayerType",void 0),(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"pointLayer",null),(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"polygonLayer",null),(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"polylineLayer",null),(0,l._)([(0,y.Cb)({type:b.Z})],a.prototype,"spatialReference",void 0),(0,l._)([(0,E.r)(["web-map","portal-item"],"spatialReference",["layers"])],a.prototype,"readSpatialReference",null),(0,l._)([(0,y.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],a.prototype,"sublayers",void 0),(0,l._)([(0,E.r)("web-map","sublayers",["layers"])],a.prototype,"readSublayers",null),(0,l._)([(0,G.c)("web-map","sublayers")],a.prototype,"writeSublayers",null),(0,l._)([(0,y.Cb)({readOnly:!0})],a.prototype,"textLayer",null),(0,l._)([(0,y.Cb)()],a.prototype,"title",void 0),(0,l._)([(0,y.Cb)({readOnly:!0,json:{read:!1}})],a.prototype,"type",void 0),a=(0,l._)([(0,R.j)("esri.layers.MapNotesLayer")],a);const le=a}}]);
//# sourceMappingURL=747.f91206406c03ec640839.js.map