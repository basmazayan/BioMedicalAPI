"use strict";var X=Object.defineProperty,J=Object.defineProperties,$=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,A=(v,f,e)=>f in v?X(v,f,{enumerable:!0,configurable:!0,writable:!0,value:e}):v[f]=e,K=(v,f)=>{for(var e in f||(f={}))k.call(f,e)&&A(v,e,f[e]);if(Z)for(var e of Z(f))q.call(f,e)&&A(v,e,f[e]);return v},W=(v,f)=>J(v,$(f));(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[3403],{98936:(v,f,e)=>{function d(a,o){return o?"xoffset"in o&&o.xoffset?Math.max(a,Math.abs(o.xoffset)):"yoffset"in o&&o.yoffset?Math.max(a,Math.abs(o.yoffset||0)):a:a}function m(a,o){return"number"==typeof a?a:a&&a.stops&&a.stops.length?function(a){let o=0,u=0;for(let r=0;r<a.length;r++){const i=a[r].size;"number"==typeof i&&(o+=i,u++)}return o/u}(a.stops):o}function g(a){const o=a&&a.renderer,u="touch"===(a&&a.event&&a.event.pointerType)?9:6;if(!o)return u;const r="visualVariables"in o?function(a,o){if(!o)return a;const u=o.filter(y=>"size"===y.type).map(y=>{const{maxSize:E,minSize:P}=y;return(m(E,a)+m(P,a))/2});let r=0;const i=u.length;if(0===i)return a;for(let y=0;y<i;y++)r+=u[y];const c=Math.floor(r/i);return Math.max(c,a)}(u,o.visualVariables):u;if("simple"===o.type)return d(r,o.symbol);if("unique-value"===o.type){let i=r;return o.uniqueValueInfos.forEach(c=>{i=d(i,c.symbol)}),i}if("class-breaks"===o.type){let i=r;return o.classBreakInfos.forEach(c=>{i=d(i,c.symbol)}),i}return o.type,r}e.d(f,{k:()=>g})},62642:(v,f,e)=>{e.d(f,{Z:()=>o});var d=e(30627),p=e(31620),m=e(84700),I=e(35138),g=e(50257);const a=(u,r)=>u.key.level-r.key.level!=0?u.key.level-r.key.level:u.key.row-r.key.row!=0?u.key.row-r.key.row:u.key.col-r.key.col;class o extends m.Z{constructor(r){super(),this._tileInfoView=r}get requiresDedicatedFBO(){return!1}renderChildren(r){this.sortChildren(a),this.setStencilReference(),super.renderChildren(r)}createRenderParams(r){const{state:i}=r,c=super.createRenderParams(r);return c.requiredLevel=this._tileInfoView.getClosestInfoForScale(i.scale).level,c.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(i.scale),c}prepareRenderPasses(r){const i=super.prepareRenderPasses(r);return i.push(r.registerRenderPass({name:"stencil",brushes:[g.Z],drawPhase:p.jx.DEBUG|p.jx.MAP|p.jx.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,d.Z)("esri-tiles-debug")&&i.push(r.registerRenderPass({name:"tileInfo",brushes:[I.Z],drawPhase:p.jx.DEBUG,target:()=>this.children})),i}getStencilTarget(){return this.children}updateTransforms(r){for(const i of this.children){const c=this._tileInfoView.getTileResolution(i.key);i.setTransform(r,c)}}setStencilReference(){let r=1;for(const i of this.children)i.stencilRef=r++}}},62561:(v,f,e)=>{e.d(f,{I:()=>I});var d=e(72425),p=e(17821),m=e(5507);class I extends p.s{constructor(a,o,u,r,i,c=r,y=i){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new m.Z(a),this.x=o,this.y=u,this.width=r,this.height=i,this.rangeX=c,this.rangeY=y}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(a,o){const u=o/(a.resolution*a.pixelRatio),r=this.transforms.tileMat3,[i,c]=a.toScreenNoRotation([0,0],[this.x,this.y]),y=this.width/this.rangeX*u,E=this.height/this.rangeY*u;(0,d.s)(r,y,0,0,0,E,0,i,c,1),(0,d.m)(this.transforms.dvs,a.displayViewMat3,r)}}},88455:(v,f,e)=>{e.r(f),e.d(f,{default:()=>Y});var d=e(49996),p=e(79076),m=e(61414),I=e(22345),g=e(7808),a=e(94911),i=(e(45072),e(30627),e(55865),e(96410)),c=e(67431),y=e(78081),E=e(12871),P=e(71850),w=e(5507),x=e(73795),j=e(98548),B=e(96121),L=e(26263),Q=e(18502),b=e(98936);const F=s=>{let h=class extends s{fetchPopupFeatures(l,U){var M=this;return(0,d.Z)(function*(){const{layer:R}=M;if(!l)return Promise.reject(new m.Z("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:R}));if("tile"!==R.type)return Promise.reject(new m.Z("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:R.type}));const C=M.get("view.scale"),O=R.allSublayers.toArray().filter(_=>{const T=0===_.minScale||C<=_.minScale,D=0===_.maxScale||C>=_.maxScale;return _.popupTemplate&&_.popupEnabled&&_.visible&&T&&D});return(0,g.as)(O.map(function(){var _=(0,d.Z)(function*(T){const D=T.createQuery(),S=(0,Q.pC)(U)?U.event:null,N=(0,b.k)({renderer:T.renderer,event:S});return D.geometry=M.createFetchPopupFeaturesQueryGeometry(l,N),D.outFields=yield T.popupTemplate.getRequiredFields(),(yield T.queryFeatures(D)).features});return function(T){return _.apply(this,arguments)}}())).then(_=>[].concat(..._.map(T=>T.value).filter(Boolean)))})()}};return(0,p._)([(0,a.Cb)()],h.prototype,"layer",void 0),h=(0,p._)([(0,i.j)("esri.layers.mixins.TileLayerView")],h),h};var z=e(7380);const G=I.Z.getLogger("esri.views.2d.layers.TileLayerView2D"),H=[0,0];let V=class extends(F((0,L.y)((0,c.Y)((0,y.y)(B.Z))))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this.layer=null}initialize(){const s=this.layer.tileInfo,h=s&&s.spatialReference;let l;h||(l=new m.Z("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer})),h.equals(this.view.spatialReference)||(l=new m.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer})),this.watch("resampling",()=>{this.doRefresh()}),l&&this.addResolvingPromise(Promise.reject(l))}get resampling(){return!("resampling"in this.layer)||!1!==this.layer.resampling}update(s){this._fetchQueue.pause(),this._fetchQueue.state=s.state,this._tileStrategy.update(s),this._fetchQueue.resume(),this.notifyChange("updating")}attach(){const s="tileServers"in this.layer?this.layer.tileServers:null;this._tileInfoView=new P.Z(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new x.Z({tileInfoView:this._tileInfoView,concurrency:s&&10*s.length||10,process:(h,l)=>this.fetchTile(h,l)}),this._tileStrategy=new j.Z({cachePolicy:"keep",resampling:this.resampling,acquireTile:h=>this.acquireTile(h),releaseTile:h=>this.releaseTile(h),tileInfoView:this._tileInfoView}),this.requestUpdate(),this.container.requestRender(),super.attach()}detach(){super.detach(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQueryGeometry(s,h){return(0,z.K)(s,h,this.view)}doRefresh(){var s=this;return(0,d.Z)(function*(){s.updateRequested||s.suspended||(s._fetchQueue.reset(),s._tileStrategy.tiles.forEach(h=>s._enqueueTileFetch(h)),s.notifyChange("updating"))})()}isUpdating(){var s;return(null==(s=this._fetchQueue)?void 0:s.length)>0}acquireTile(s){const h=this._bitmapView.createTile(s),l=h.bitmap;return[l.x,l.y]=this._tileInfoView.getTileCoords(H,h.key),l.resolution=this._tileInfoView.getTileResolution(h.key),[l.width,l.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(h),this._bitmapView.addChild(h),this.requestUpdate(),h}releaseTile(s){this._fetchQueue.abort(s.key.id),this._bitmapView.removeChild(s),s.once("detach",()=>s.destroy()),this.requestUpdate()}fetchTile(s,h={}){var l=this;return(0,d.Z)(function*(){const U="tilemapCache"in l.layer?l.layer.tilemapCache:null,{signal:M,resamplingLevel:R=0}=h;if(!U)try{return yield l._fetchImage(s,M)}catch(_){if(!(0,g.D_)(_)&&!l.resampling)return(0,E.V)(l._tileInfoView.tileInfo.size);if(R<3){const T=l._tileInfoView.getTileParentId(s.id);if(T){const D=new w.Z(T),S=yield l.fetchTile(D,W(K({},h),{resamplingLevel:R+1}));return(0,E.i)(l._tileInfoView,S,D,s)}}throw _}const C=new w.Z(0,0,0,0);let O;try{if(yield U.fetchAvailabilityUpsample(s.level,s.row,s.col,C,{signal:M}),C.level!==s.level&&!l.resampling)return(0,E.V)(l._tileInfoView.tileInfo.size);O=yield l._fetchImage(C,M)}catch(_){if((0,g.D_)(_))throw _;O=yield l._fetchImage(s,M)}return l.resampling?(0,E.i)(l._tileInfoView,O,C,s):O})()}_enqueueTileFetch(s){var h=this;return(0,d.Z)(function*(){if(!h._fetchQueue.has(s.key.id)){try{const l=yield h._fetchQueue.push(s.key);s.bitmap.source=l,s.bitmap.width=h._tileInfoView.tileInfo.size[0],s.bitmap.height=h._tileInfoView.tileInfo.size[1],s.once("attach",()=>h.requestUpdate())}catch(l){(0,g.D_)(l)||G.error(l)}h.requestUpdate()}})()}_fetchImage(s,h){var l=this;return(0,d.Z)(function*(){return l.layer.fetchTile(s.level,s.row,s.col,{signal:h})})()}};(0,p._)([(0,a.Cb)()],V.prototype,"resampling",null),V=(0,p._)([(0,i.j)("esri.views.2d.layers.TileLayerView2D")],V);const Y=V},26263:(v,f,e)=>{e.d(f,{y:()=>i});var d=e(79076),p=e(22345),m=e(7808),I=e(11652),g=e(94911),r=(e(45072),e(30627),e(55865),e(96410));const i=c=>{let y=class extends c{initialize(){this.handles.add((0,I.on)(this,"layer","refresh",E=>{this.doRefresh(E.dataChanged).catch(P=>{(0,m.D_)(P)||p.Z.getLogger(this.declaredClass).error(P)})}),"RefreshableLayerView")}};return(0,d._)([(0,g.Cb)()],y.prototype,"layer",void 0),y=(0,d._)([(0,r.j)("esri.layers.mixins.RefreshableLayerView")],y),y}},7380:(v,f,e)=>{e.d(f,{K:()=>g});e(61243);var p=e(18502),m=e(55612),I=e(70157);function g(u,r,i,c=new I.Z){let y;if("2d"===i.type)y=r*i.resolution;else if("3d"===i.type){const B=i.overlayPixelSizeInMapUnits(u),L=i.basemapSpatialReference;y=(0,p.pC)(L)&&!L.equals(i.spatialReference)?(0,m.c9)(L)/(0,m.c9)(i.spatialReference):r*B}const E=u.x-y,P=u.y-y,w=u.x+y,x=u.y+y,{spatialReference:j}=i;return c.xmin=Math.min(E,w),c.ymin=Math.min(P,x),c.xmax=Math.max(E,w),c.ymax=Math.max(P,x),c.spatialReference=j,c}new I.Z}}]);
//# sourceMappingURL=3403.36bed6af5ffd1e67ee31.js.map