"use strict";(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[498],{10498:(V,d,i)=>{i.r(d),i.d(d,{default:()=>O});var c=i(49996),y=i(79076),M=i(99326),v=i(97750),n=i(18502),_=i(11652),D=(i(22345),i(55865),i(45072),i(30627),i(72062),i(96410)),m=i(78081),u=i(84853),g=i(42302),P=i(96121);const f="sublayers",l="layerView",w=Object.freeze({remove(){},pause(){},resume(){}});let p=class extends((0,m.y)(P.Z)){fetchPopupFeatures(s){var t=this;return(0,c.Z)(function*(){return Array.from(t.graphicsViews(),e=>e.hitTest(s).filter(r=>!!r.popupTemplate)).flat()})()}*graphicsViews(){(0,n.pC)(this._graphicsViewsFeatureCollectionMap)?yield*this._graphicsViewsFeatureCollectionMap.keys():(0,n.pC)(this._graphicsViews)?yield*this._graphicsViews:yield*[]}hitTest(s,t){var e=this;return(0,c.Z)(function*(){const r=Array.from(e.graphicsViews(),function(){var o=(0,c.Z)(function*(a){const h=yield a.hitTest(s);if((0,n.pC)(e._graphicsViewsFeatureCollectionMap)){const E=e._graphicsViewsFeatureCollectionMap.get(a);for(const C of h)!C.popupTemplate&&E.popupTemplate&&(C.popupTemplate=E.popupTemplate)}return h});return function(a){return o.apply(this,arguments)}}());return(yield Promise.all(r)).flat()})()}highlight(s){let t;if("number"==typeof s?t=[s]:s instanceof M.Z?t=[s.uid]:Array.isArray(s)&&s.length>0?t="number"==typeof s[0]?s:s.map(e=>e&&e.uid):v.Z.isCollection(s)&&(t=s.map(e=>e&&e.uid).toArray()),t=t.filter(e=>null!=e),!t.length)return w;for(const e of this.graphicsViews())e.addHighlight(t);return{remove:()=>{for(const e of this.graphicsViews())e.removeHighlight(t)}}}update(s){for(const t of this.graphicsViews())t.processUpdate(s)}attach(){const s=this.view,t=()=>this.requestUpdate(),e=this.layer.featureCollections;if((0,n.pC)(e)&&e.length){this._graphicsViewsFeatureCollectionMap=new Map;for(const r of e){const o=new u.Z(this.view.featuresTilingScheme);o.fadeTransitionEnabled=!0;const a=new g.Z({view:s,graphics:r.source,renderer:r.renderer,requestUpdateCallback:t,container:o});this._graphicsViewsFeatureCollectionMap.set(a,r),this.container.addChild(a.container),this.handles.add([(0,_.S1)(r,"visible",h=>a.container.visible=h),(0,_.S1)(a,"updating",()=>this.notifyChange("updating"))],l)}}else(0,n.pC)(this.layer.sublayers)&&this.handles.add((0,_.on)(this.layer,"sublayers","change",()=>this._createGraphicsViews(),()=>this._createGraphicsViews(),()=>this._destroyGraphicsViews()),f)}detach(){this._destroyGraphicsViews(),this.handles.remove(f)}moveStart(){}moveEnd(){}viewChange(){for(const s of this.graphicsViews())s.viewChange()}isUpdating(){for(const s of this.graphicsViews())if(s.updating)return!0;return!1}_destroyGraphicsViews(){this.container.removeAllChildren(),this.handles.remove(l);for(const s of this.graphicsViews())s.destroy();this._graphicsViews=null,this._graphicsViewsFeatureCollectionMap=null}_createGraphicsViews(){if(this._destroyGraphicsViews(),(0,n.Wi)(this.layer.sublayers))return;const s=[],t=this.view,e=()=>this.requestUpdate();for(const r of this.layer.sublayers){const o=new u.Z(this.view.featuresTilingScheme);o.fadeTransitionEnabled=!0;const a=new g.Z({view:t,graphics:r.graphics,requestUpdateCallback:e,container:o});this.handles.add([r.on("graphic-update",a.graphicUpdateHandler),(0,_.S1)(r,"visible",h=>a.container.visible=h),(0,_.S1)(a,"updating",()=>this.notifyChange("updating"))],l),this.container.addChild(a.container),s.push(a)}this._graphicsViews=s}};p=(0,y._)([(0,D.j)("esri.views.2d.layers.MapNotesLayerView2D")],p);const O=p}}]);
//# sourceMappingURL=498.367d65bd82a8c00229b2.js.map