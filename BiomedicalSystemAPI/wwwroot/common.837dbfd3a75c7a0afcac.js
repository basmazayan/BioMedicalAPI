"use strict";var Be=Object.defineProperty,Le=Object.defineProperties,We=Object.getOwnPropertyDescriptors,Me=Object.getOwnPropertySymbols,Ke=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,Oe=Math.pow,De=(ee,V,t)=>V in ee?Be(ee,V,{enumerable:!0,configurable:!0,writable:!0,value:t}):ee[V]=t,te=(ee,V)=>{for(var t in V||(V={}))Ke.call(V,t)&&De(ee,t,V[t]);if(Me)for(var t of Me(V))we.call(V,t)&&De(ee,t,V[t]);return ee},ae=(ee,V)=>Le(ee,We(V));(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[8592],{62701:(ee,V,t)=>{t.d(V,{A:()=>J,B:()=>M,C:()=>j,D:()=>G,E:()=>K,F:()=>w,G:()=>$,H:()=>I,I:()=>Z,J:()=>N,K:()=>R,a:()=>D,b:()=>B,c:()=>y,d:()=>m,e:()=>C,f:()=>u,g:()=>z,h:()=>S,i:()=>d,j:()=>P,k:()=>E,l:()=>_,m:()=>l,n:()=>p,o:()=>a,p:()=>h,q:()=>g,r:()=>o,s:()=>O,t:()=>n,u:()=>L,v:()=>W,w:()=>c,x:()=>F,y:()=>A,z:()=>b});var s=t(66571),v=t(27889);function C(T){return s.G.extendedSpatialReferenceInfo(T)}function y(T,x,U){return s.G.clip(v.N,T,x,U)}function D(T,x,U){return s.G.cut(v.N,T,x,U)}function B(T,x,U){return s.G.contains(v.N,T,x,U)}function m(T,x,U){return s.G.crosses(v.N,T,x,U)}function u(T,x,U,H){return s.G.distance(v.N,T,x,U,H)}function S(T,x,U){return s.G.equals(v.N,T,x,U)}function d(T,x,U){return s.G.intersects(v.N,T,x,U)}function n(T,x,U){return s.G.touches(v.N,T,x,U)}function c(T,x,U){return s.G.within(v.N,T,x,U)}function P(T,x,U){return s.G.disjoint(v.N,T,x,U)}function a(T,x,U){return s.G.overlaps(v.N,T,x,U)}function o(T,x,U,H){return s.G.relate(v.N,T,x,U,H)}function E(T,x){return s.G.isSimple(v.N,T,x)}function O(T,x){return s.G.simplify(v.N,T,x)}function _(T,x,U=!1){return s.G.convexHull(v.N,T,x,U)}function l(T,x,U){return s.G.difference(v.N,T,x,U)}function p(T,x,U){return s.G.symmetricDifference(v.N,T,x,U)}function h(T,x,U){return s.G.intersect(v.N,T,x,U)}function L(T,x,U=null){return s.G.union(v.N,T,x,U)}function g(T,x,U,H,k,X,Y){return s.G.offset(v.N,T,x,U,H,k,X,Y)}function W(T,x,U,H,k=!1){return s.G.buffer(v.N,T,x,U,H,k)}function F(T,x,U,H,k,X,Y){return s.G.geodesicBuffer(v.N,T,x,U,H,k,X,Y)}function A(T,x,U,H=!0){return s.G.nearestCoordinate(v.N,T,x,U,H)}function b(T,x,U){return s.G.nearestVertex(v.N,T,x,U)}function J(T,x,U,H,k){return s.G.nearestVertices(v.N,T,x,U,H,k)}function M(T,x,U,H){if(null==x||null==H)throw new Error("Illegal Argument Exception");const k=s.G.rotate(x,U,H);return k.spatialReference=T,k}function j(T,x,U){if(null==x||null==U)throw new Error("Illegal Argument Exception");const H=s.G.flipHorizontal(x,U);return H.spatialReference=T,H}function G(T,x,U){if(null==x||null==U)throw new Error("Illegal Argument Exception");const H=s.G.flipVertical(x,U);return H.spatialReference=T,H}function K(T,x,U,H,k){return s.G.generalize(v.N,T,x,U,H,k)}function w(T,x,U,H){return s.G.densify(v.N,T,x,U,H)}function $(T,x,U,H,k=0){return s.G.geodesicDensify(v.N,T,x,U,H,k)}function I(T,x,U){return s.G.planarArea(v.N,T,x,U)}function Z(T,x,U){return s.G.planarLength(v.N,T,x,U)}function N(T,x,U,H){return s.G.geodesicArea(v.N,T,x,U,H)}function R(T,x,U,H){return s.G.geodesicLength(v.N,T,x,U,H)}const z=Object.freeze({__proto__:null,extendedSpatialReferenceInfo:C,clip:y,cut:D,contains:B,crosses:m,distance:u,equals:S,intersects:d,touches:n,within:c,disjoint:P,overlaps:a,relate:o,isSimple:E,simplify:O,convexHull:_,difference:l,symmetricDifference:p,intersect:h,union:L,offset:g,buffer:W,geodesicBuffer:F,nearestCoordinate:A,nearestVertex:b,nearestVertices:J,rotate:M,flipHorizontal:j,flipVertical:G,generalize:K,densify:w,geodesicDensify:$,planarArea:I,planarLength:Z,geodesicArea:N,geodesicLength:R})},94546:(ee,V,t)=>{t.d(V,{Z:()=>v});var s=t(18502);class v{constructor(y){this.size=0,this._start=0,this.maxSize=y,this._buffer=new Array(y)}get entries(){return this._buffer}enqueue(y){if(this.size===this.maxSize){const D=this._buffer[this._start];return this._buffer[this._start]=y,this._start=(this._start+1)%this.maxSize,D}return this._buffer[(this._start+this.size++)%this.maxSize]=y,null}dequeue(){if(0===this.size)return null;const y=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,y}peek(){return 0===this.size?null:this._buffer[this._start]}find(y){if(0===this.size)return null;for(const D of this._buffer)if((0,s.pC)(D)&&y(D))return D;return null}clear(y){let D=this.dequeue();for(;(0,s.pC)(D);)y&&y(D),D=this.dequeue()}}},77551:(ee,V,t)=>{t.r(V),t.d(V,{hydratedAdapter:()=>B});var s=t(70157),v=t(43245),C=t(36262),y=t(38535),D=t(23926);const B={convertToGEGeometry:function(P,a){if(null==a)return null;let o="cache"in a?a.cache._geVersion:void 0;return null==o&&(o=P.convertJSONToGeometry(a),"cache"in a&&(a.cache._geVersion=o)),o},exportPoint:function(P,a,o){const E=P.hasZ(a),O=P.hasM(a),_=new C.Z({x:P.getPointX(a),y:P.getPointY(a),spatialReference:o});return E&&(_.z=P.getPointZ(a)),O&&(_.m=P.getPointM(a)),_.cache._geVersion=a,_},exportPolygon:function(P,a,o){const E=new y.Z({rings:P.exportPaths(a),hasZ:P.hasZ(a),hasM:P.hasM(a),spatialReference:o});return E.cache._geVersion=a,E},exportPolyline:function(P,a,o){const E=new D.Z({paths:P.exportPaths(a),hasZ:P.hasZ(a),hasM:P.hasM(a),spatialReference:o});return E.cache._geVersion=a,E},exportMultipoint:function(P,a,o){const E=new v.Z({hasZ:P.hasZ(a),hasM:P.hasM(a),points:P.exportPoints(a),spatialReference:o});return E.cache._geVersion=a,E},exportExtent:function(P,a,o){const E=P.hasZ(a),O=P.hasM(a),_=new s.Z({xmin:P.getXMin(a),ymin:P.getYMin(a),xmax:P.getXMax(a),ymax:P.getYMax(a),spatialReference:o});if(E){const l=P.getZExtent(a);_.zmin=l.vmin,_.zmax=l.vmax}if(O){const l=P.getMExtent(a);_.mmin=l.vmin,_.mmax=l.vmax}return _.cache._geVersion=a,_}}},27144:(ee,V,t)=>{t.d(V,{Z:()=>L});var p,s=t(79076),v=t(41147),C=t(18502),y=t(94911),u=(t(45072),t(30627),t(55865),t(96410)),S=t(60411),d=t(25336),n=t(63702),c=t(33989),P=t(36262),a=t(19784),o=t(69843),E=t(23503),O=t(13707),_=t(58535),l=t(18635);let h=p=class extends v.wq{constructor(g){super(g),this.origin=(0,c.c)(),this.translation=(0,c.c)(),this.rotation=(0,E.Ue)(),this.scale=(0,c.f)(1,1,1),this.geographic=!0}get localMatrix(){const g=(0,d.c)();return(0,S.f)(g,g,this.scale),(0,S.e)(g,g,(0,E.WH)(this.rotation),(0,E.ZZ)(this.rotation)),(0,S.a)(g,g,this.translation),g}get localMatrixInverse(){return(0,S.b)((0,d.c)(),this.localMatrix)}applyLocal(g,W){return(0,n.m)(W,g,this.localMatrix)}applyLocalInverse(g,W){return(0,n.m)(W,g,this.localMatrixInverse)}project(g,W){const F=new Float64Array(g.length),A=O.fP.fromTypedArray(F),b=O.fP.fromTypedArray(g);if(this.geographic){const j=(0,o.N_)((0,o.Iu)(W)),G=(0,d.c)();return(0,a.Bm)(W,this.origin,G,j),(0,S.m)(G,G,this.localMatrix),(0,_.t)(A,b,G),(0,a.CM)(F,j,0,F,W,0,F.length/3),F}const{localMatrix:J,origin:M}=this;(0,S.n)(J,d.I)?(0,l.c)(A,b):(0,_.t)(A,b,J);for(let j=0;j<F.length;j+=3)F[j+0]+=M[0],F[j+1]+=M[1],F[j+2]+=M[2];return F}getOriginPoint(g){const[W,F,A]=this.origin;return new P.Z({x:W,y:F,z:A,spatialReference:g})}equals(g){return(0,C.pC)(g)&&this.geographic===g.geographic&&(0,n.k)(this.origin,g.origin)&&(0,S.p)(this.localMatrix,g.localMatrix)}clone(){const g={origin:(0,c.a)(this.origin),translation:(0,c.a)(this.translation),rotation:(0,E.Ue)(this.rotation),scale:(0,c.a)(this.scale),geographic:this.geographic};return new p(g)}};(0,s._)([(0,y.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"origin",void 0),(0,s._)([(0,y.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"translation",void 0),(0,s._)([(0,y.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"rotation",void 0),(0,s._)([(0,y.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"scale",void 0),(0,s._)([(0,y.Cb)({type:Boolean,nonNullable:!0,json:{write:!0}})],h.prototype,"geographic",void 0),(0,s._)([(0,y.Cb)()],h.prototype,"localMatrix",null),(0,s._)([(0,y.Cb)()],h.prototype,"localMatrixInverse",null),h=p=(0,s._)([(0,u.j)("esri.geometry.support.MeshTransform")],h);const L=h},23503:(ee,V,t)=>{t.d(V,{WH:()=>o,ZZ:()=>P,qC:()=>c,Ue:()=>D,uT:()=>d});var s=t(88415),v=t(3456),C=t(49635),y=t(63702);function D(h=O){return[h[0],h[1],h[2],h[3]]}function d(h,L,g=D()){return(0,y.g)(g,h),g[3]=L,g}function c(h,L,g=D()){return(0,v.s)(_,h,o(h)),(0,v.s)(l,L,o(L)),(0,v.m)(_,l,_),function(h,L){return h[3]=L,h}(g,(0,s.BV)((0,v.g)(g,_)))}function P(h){return h}function o(h){return(0,s.Vl)(h[3])}const O=[0,0,1,0],_=(0,C.a)(),l=(0,C.a)();D()},25272:(ee,V,t)=>{t.d(V,{d:()=>v});var s=t(88415);function v(m,u,S){var d;const n=m.byteLength/(4*u),c=new Uint32Array(m,0,n*u);let P=new Uint32Array(n);const a=null!=(d=null==S?void 0:S.minReduction)?d:0,o=(null==S?void 0:S.originalIndices)||null,E=o?o.length:0,O=(null==S?void 0:S.componentOffsets)||null;let _=0;if(O)for(let M=0;M<O.length-1;M++){const j=O[M+1]-O[M];j>_&&(_=j)}else _=n;const l=Math.floor(1.1*_)+1;(null==B||B.length<2*l)&&(B=new Uint32Array((0,s.Sf)(2*l)));for(let M=0;M<2*l;M++)B[M]=0;let p=0;const h=!!O&&!!o,L=h?E:n,g=h?new Uint32Array(E):null,W=1.96;let F=0!==a?Math.ceil(4*W*W/(a*a)*a*(1-a)):L,A=1,b=O?O[1]:L;for(let M=0;M<L;M++){if(M===F){const I=1-p/M;if(I+W*Math.sqrt(I*(1-I)/M)<a)return null;F*=2}if(M===b){for(let I=0;I<2*l;I++)B[I]=0;if(o)for(let I=O[A-1];I<O[A];I++)g[I]=P[o[I]];b=O[++A]}const j=h?o[M]:M,G=j*u,K=D(c,G,u);let w=K%l,$=p;for(;0!==B[2*w+1];){if(B[2*w]===K){const I=B[2*w+1]-1;if(C(c,G,I*u,u)){$=P[I];break}}w++,w>=l&&(w-=l)}$===p&&(B[2*w]=K,B[2*w+1]=j+1,p++),P[j]=$}if(0!==a&&1-p/n<a)return null;if(h){for(let M=O[A-1];M<g.length;M++)g[M]=P[o[M]];P=g}const J=new Uint32Array(u*p);p=0;for(let M=0;M<L;M++)P[M]===p&&(y(c,(h?o[M]:M)*u,J,p*u,u),p++);if(o&&!h){const M=new Uint32Array(E);for(let j=0;j<M.length;j++)M[j]=P[o[j]];P=M}return{buffer:J.buffer,indices:P,uniqueCount:p}}function C(m,u,S,d){for(let n=0;n<d;n++)if(m[u+n]!==m[S+n])return!1;return!0}function y(m,u,S,d,n){for(let c=0;c<n;c++)S[d+c]=m[u+c]}function D(m,u,S){let d=0;for(let n=0;n<S;n++)d=m[u+n]+d|0,d=d+(d<<11)+(d>>>2)|0;return d>>>0}let B=null},56605:(ee,V,t)=>{function s(v,C){var y;return v.isGeographic||v.isWebMercator&&(null==(y=null==C?void 0:C.geographic)||y)}t.d(V,{h:()=>s})},99814:(ee,V,t)=>{t.d(V,{iv:()=>a,I5:()=>o,w1:()=>E,FF:()=>O,Yq:()=>_});var s=t(18502),v=t(55612),C=t(30641),y=t(60411),D=t(25336),B=t(72425),m=t(19784),u=t(69843),S=t(27144),d=t(13707),n=t(58535),c=t(56605),P=t(23187);function a(I,Z,N){return(0,c.h)(Z.spatialReference,N)?function(I,Z,N){const R=Z.spatialReference,z=A(Z,N,G),T=new Float64Array(I.position.length),x=function(I,Z,N,R){(0,n.t)(d.fP.fromTypedArray(R),d.fP.fromTypedArray(I),Z);const z=new Float64Array(I.length);return(0,P.To)(R,z,N)}(I.position,z,R,T),U=(0,B.a)(w,z);return{position:x,normal:L(x,T,I.normal,U,R),tangent:g(x,T,I.tangent,U,R)}}(I,Z,N):function(I,Z,N){const R=new Float64Array(I.position.length),z=I.position,T=Z.x,x=Z.y,U=Z.z||0,{horizontal:H,vertical:k}=j(N?N.unit:null,Z.spatialReference);for(let X=0;X<z.length;X+=3)R[X+0]=z[X+0]*H+T,R[X+1]=z[X+1]*H+x,R[X+2]=z[X+2]*k+U;return{position:R,normal:I.normal,tangent:I.tangent}}(I,Z,N)}function o(I,Z,N){const{position:R,normal:z,tangent:T}=I;if((0,s.Wi)(Z))return{position:R,normal:z,tangent:T};const x=Z.localMatrix;return a({position:(0,P.zZ)(R,new Float64Array(R.length),x),normal:(0,s.pC)(z)?(0,P.w9)(z,new Float32Array(z.length),x):null,tangent:(0,s.pC)(T)?(0,P.VS)(T,new Float32Array(T.length),x):null},Z.getOriginPoint(N),{geographic:Z.geographic})}function E(I,Z,N){if(null!=N&&N.useTransform){var R;const{position:z,normal:T,tangent:x}=I;return{vertexAttributes:{position:z,normal:T,tangent:x},transform:new S.Z({origin:[Z.x,Z.y,null!=(R=Z.z)?R:0],geographic:(0,c.h)(Z.spatialReference,N)})}}return{vertexAttributes:a(I,Z,N),transform:null}}function O(I,Z,N){return(0,c.h)(Z.spatialReference,N)?F(I,Z,N):W(I,Z,N)}function _(I,Z,N,R){if((0,s.Wi)(Z))return O(I,N,R);const z=o(I,Z,N.spatialReference);return N.equals(Z.getOriginPoint(N.spatialReference))?W(z,N,R):(0,c.h)(N.spatialReference,R)?F(z,N,R):W(z,N,R)}function L(I,Z,N,R,z){if((0,s.Wi)(N))return null;const T=new Float32Array(N.length);return(0,n.a)(d.ct.fromTypedArray(T),d.ct.fromTypedArray(N),R),(0,P.Yk)(T,I,Z,z,T),T}function g(I,Z,N,R,z){if((0,s.Wi)(N))return null;const T=new Float32Array(N.length);(0,n.a)(d.ct.fromTypedArray(T,4*Float32Array.BYTES_PER_ELEMENT),d.ct.fromTypedArray(N,4*Float32Array.BYTES_PER_ELEMENT),R);for(let x=3;x<T.length;x+=4)T[x]=N[x];return(0,P.M2)(T,I,Z,z,T),T}function W(I,Z,N){const R=new Float64Array(I.position.length),z=I.position,T=Z.x,x=Z.y,U=Z.z||0,{horizontal:H,vertical:k}=j(N?N.unit:null,Z.spatialReference);for(let X=0;X<z.length;X+=3)R[X+0]=(z[X+0]-T)/H,R[X+1]=(z[X+1]-x)/H,R[X+2]=(z[X+2]-U)/k;return{position:R,normal:I.normal,tangent:I.tangent}}function F(I,Z,N){const R=Z.spatialReference;A(Z,N,G);const z=(0,y.b)(K,G),T=new Float64Array(I.position.length),x=function(I,Z,N,R){const z=(0,P.XO)(I,Z,R),T=d.fP.fromTypedArray(z),x=new Float64Array(z.length),U=d.fP.fromTypedArray(x);return(0,n.t)(U,T,N),x}(I.position,R,z,T),U=(0,B.a)(w,z);return{position:x,normal:J(I.normal,I.position,T,R,U),tangent:M(I.tangent,I.position,T,R,U)}}function A(I,Z,N){(0,m.Bm)(I.spatialReference,[I.x,I.y,I.z||0],N,(0,u.rS)(I.spatialReference));const{horizontal:R,vertical:z}=j(Z?Z.unit:null,I.spatialReference);return(0,y.f)(N,N,[R,R,z]),N}function J(I,Z,N,R,z){if((0,s.Wi)(I))return null;const T=(0,P.Iz)(I,Z,N,R,new Float32Array(I.length)),x=d.ct.fromTypedArray(T);return(0,n.a)(x,x,z),T}function M(I,Z,N,R,z){if((0,s.Wi)(I))return null;const T=(0,P.wi)(I,Z,N,R,new Float32Array(I.length)),x=d.ct.fromTypedArray(T,4*Float32Array.BYTES_PER_ELEMENT);return(0,n.a)(x,x,z),T}function j(I,Z){if((0,s.Wi)(I))return $;const N=Z.isGeographic?1:(0,v.Z7)(Z),R=Z.isGeographic?1:(0,v._R)(Z),z=(0,v.En)(1,I,"meters");return{horizontal:z*N,vertical:z*R}}const G=(0,D.c)(),K=(0,D.c)(),w=(0,C.c)(),$={horizontal:1,vertical:1}},23187:(ee,V,t)=>{t.d(V,{To:()=>_,Yk:()=>E,Iz:()=>o,M2:()=>g,wi:()=>L,XO:()=>O,w9:()=>p,zZ:()=>l,VS:()=>h});var s=t(22345),v=t(18502),C=t(72425),y=t(30641),D=t(25336),B=t(63702),m=t(33989),u=t(19784),S=t(69843),d=t(35169),n=t(3403),c=t(13707),P=t(58535);const a=s.Z.getLogger("esri.geometry.support.meshUtils.normalProjection");function o(K,w,$,I,Z){return F(I)?(W(0,c.ct.fromTypedArray(K),c.fP.fromTypedArray(w),c.fP.fromTypedArray($),I,c.ct.fromTypedArray(Z)),Z):(a.error("Cannot convert spatial reference to PCPF"),Z)}function E(K,w,$,I,Z){return F(I)?(W(1,c.ct.fromTypedArray(K),c.fP.fromTypedArray(w),c.fP.fromTypedArray($),I,c.ct.fromTypedArray(Z)),Z):(a.error("Cannot convert to spatial reference from PCPF"),Z)}function O(K,w,$){return(0,u.CM)(K,w,0,$,(0,S.rS)(w),0,K.length/3),$}function _(K,w,$){return(0,u.CM)(K,(0,S.rS)($),0,w,$,0,K.length/3),w}function l(K,w,$){if((0,v.Wi)(K))return w;const I=c.fP.fromTypedArray(K),Z=c.fP.fromTypedArray(w);return(0,P.t)(Z,I,$),w}function p(K,w,$){if((0,v.Wi)(K))return w;(0,C.a)(G,$);const I=c.ct.fromTypedArray(K),Z=c.ct.fromTypedArray(w);return(0,P.a)(Z,I,G),(0,C.i)(G)||(0,P.n)(Z,Z),w}function h(K,w,$){if((0,v.Wi)(K))return w;(0,C.a)(G,$);const I=c.ct.fromTypedArray(K,4*Float32Array.BYTES_PER_ELEMENT),Z=c.ct.fromTypedArray(w,4*Float32Array.BYTES_PER_ELEMENT);if((0,P.a)(Z,I,G),(0,C.i)(G)||(0,P.n)(Z,Z),K!==w)for(let N=3;N<K.length;N+=4)w[N]=K[N];return w}function L(K,w,$,I,Z){if(!F(I))return a.error("Cannot convert spatial reference to PCPF"),Z;W(0,c.ct.fromTypedArray(K,4*Float32Array.BYTES_PER_ELEMENT),c.fP.fromTypedArray(w),c.fP.fromTypedArray($),I,c.ct.fromTypedArray(Z,4*Float32Array.BYTES_PER_ELEMENT));for(let N=3;N<K.length;N+=4)Z[N]=K[N];return Z}function g(K,w,$,I,Z){if(!F(I))return a.error("Cannot convert to spatial reference from PCPF"),Z;W(1,c.ct.fromTypedArray(K,16),c.fP.fromTypedArray(w),c.fP.fromTypedArray($),I,c.ct.fromTypedArray(Z,16));for(let N=3;N<K.length;N+=4)Z[N]=K[N];return Z}function W(K,w,$,I,Z,N){if(!w)return;const R=$.count,z=(0,S.rS)(Z);if(A(Z))for(let T=0;T<R;T++)I.getVec(T,J),w.getVec(T,M),(0,u.Bm)(z,J,j,z),(0,C.f)(G,j),1===K&&(0,C.t)(G,G),(0,B.t)(M,M,G),N.setVec(T,M);else for(let T=0;T<R;T++){I.getVec(T,J),w.getVec(T,M),(0,u.Bm)(z,J,j,z),(0,C.f)(G,j);const x=(0,n.mZ)($.get(T,1));let U=Math.cos(x);0===K&&(U=1/U),G[0]*=U,G[1]*=U,G[2]*=U,G[3]*=U,G[4]*=U,G[5]*=U,1===K&&(0,C.t)(G,G),(0,B.t)(M,M,G),(0,B.n)(M,M),N.setVec(T,M)}return N}function F(K){return A(K)||function(K){return K.isWebMercator}(K)}function A(K){return K.isWGS84||(0,d.yW)(K)||(0,d.BZ)(K)||(0,d.V2)(K)}const J=(0,m.c)(),M=(0,m.c)(),j=(0,D.c)(),G=(0,y.c)()},12345:(ee,V,t)=>{t.r(V),t.d(V,{default:()=>R});var s=t(49996),v=t(79076),C=t(30351),y=t(85362),D=t(61414),B=t(62091),m=t(50942),u=t(18502),S=t(32810),d=t(7808),n=t(94911),a=(t(45072),t(30627),t(55865)),o=t(38650),E=t(96410),O=t(88445),_=t(84975),l=t(70157),p=t(13848),h=t(2045),L=t(57993),g=t(64698),W=t(41122),F=t(88945),A=t(52166),b=t(46839),J=t(32617),M=t(77883),j=t(41099),G=t(75805),K=t(77932),w=t(46613),$=t(71995),I=t(79949),Z=t(20975);let N=class extends((0,F.h)((0,K.n)((0,j.M)((0,G.x)((0,g.O)((0,W.Y)((0,b.q)((0,J.I)((0,S.R)((0,M.Q)((0,L.V)((0,A.N)((0,B.p)(h.Z)))))))))))))){constructor(...z){super(...z),this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(z,T){return"string"==typeof z?te({url:z},T):z}load(z){const T=(0,u.pC)(z)?z.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},z).catch(d.r9).then(()=>this._fetchService(T))),Promise.resolve(this)}readImageFormat(z,T){const x=T.supportedImageFormatTypes;return x&&x.indexOf("PNG32")>-1?"png32":"png24"}writeSublayers(z,T,x,U){if(!this.loaded||!z)return;const H=z.slice().reverse().flatten(({sublayers:q})=>q&&q.toArray().reverse()).toArray();let k=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const q=(0,_.M9)(U.origin);if(3===q){const se=this.createSublayersForOrigin("service").sublayers;k=(0,Z.QV)(H,se,2)}else if(q>3){const se=this.createSublayersForOrigin("portal-item");k=(0,Z.QV)(H,se.sublayers,(0,_.M9)(se.origin))}}const X=[],Y=te({writeSublayerStructure:k},U);let Q=k;H.forEach(q=>{const se=q.write({},Y);X.push(se),Q=Q||"user"===q.originOf("visible")}),X.some(q=>Object.keys(q).length>1)&&(T.layers=X),Q&&(T.visibleLayers=H.filter(q=>q.visible).map(q=>q.id))}createExportImageParameters(z,T,x,U){const H=U&&U.pixelRatio||1;z&&this.version>=10&&(z=z.clone().shiftCentralMeridian());const k=new $.R({layer:this,floors:null==U?void 0:U.floors,scale:(0,p.yZ)({extent:z,width:T})*H}),X=k.toJSON();k.destroy();const Y=!U||!U.rotation||this.version<10.3?{}:{rotation:-U.rotation},Q=z&&z.spatialReference,q=Q.wkid||JSON.stringify(Q.toJSON());X.dpi*=H;const se={};if(null!=U&&U.timeExtent){const{start:oe,end:ne}=U.timeExtent.toJSON();se.time=oe&&ne&&oe===ne?""+oe:`${null==oe?"null":oe},${null==ne?"null":ne}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(se.time="null,null");return te(te(te({bbox:z&&z.xmin+","+z.ymin+","+z.xmax+","+z.ymax,bboxSR:q,imageSR:q,size:T+","+x},X),Y),se)}fetchImage(z,T,x,U){var H=this;return(0,s.Z)(function*(){var k;const X={responseType:"image",signal:null!=(k=null==U?void 0:U.signal)?k:null,query:ae(te(te(ae(te(te({},H.parsedUrl.query),H.createExportImageParameters(z,T,x,U)),{f:"image"}),H.refreshParameters),H.customParameters),{token:H.apiKey})},Y=H.parsedUrl.path+"/export";return null==X.query.dynamicLayers||H.capabilities.exportMap.supportsDynamicLayers?(0,C.default)(Y,X).then(Q=>Q.data).catch(Q=>{throw(0,d.D_)(Q)?Q:new D.Z("mapimagelayer:image-fetch-error",`Unable to load image: ${Y}`,{error:Q})}):Promise.reject(new D.Z("mapimagelayer:dynamiclayer-not-supported",`service ${H.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:X.query}))})()}fetchRecomputedExtents(z={}){var T=this;return(0,s.Z)(function*(){const x=ae(te({},z),{query:ae(te({returnUpdates:!0,f:"json"},T.customParameters),{token:T.apiKey})}),{data:U}=yield(0,C.default)(T.url,x),{extent:H,fullExtent:k,timeExtent:X}=U,Y=H||k;return{fullExtent:Y&&l.Z.fromJSON(Y),timeExtent:X&&y.Z.fromJSON({start:X[0],end:X[1]})}})()}loadAll(){return(0,m.GZ)(this,z=>{z(this.allSublayers)})}_fetchService(z){var T=this;return(0,s.Z)(function*(){if(T.sourceJSON)return void T.read(T.sourceJSON,{origin:"service",url:T.parsedUrl});const{data:x,ssl:U}=yield(0,C.default)(T.parsedUrl.path,{query:ae(te(te({f:"json"},T.parsedUrl.query),T.customParameters),{token:T.apiKey}),signal:z});U&&(T.url=T.url.replace(/^http:/i,"https:")),T.sourceJSON=x,T.read(x,{origin:"service",url:T.parsedUrl})})()}};(0,v._)([(0,n.Cb)({type:Boolean})],N.prototype,"datesInUnknownTimezone",void 0),(0,v._)([(0,n.Cb)()],N.prototype,"dpi",void 0),(0,v._)([(0,n.Cb)()],N.prototype,"gdbVersion",void 0),(0,v._)([(0,n.Cb)()],N.prototype,"imageFormat",void 0),(0,v._)([(0,o.r)("imageFormat",["supportedImageFormatTypes"])],N.prototype,"readImageFormat",null),(0,v._)([(0,n.Cb)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],N.prototype,"imageMaxHeight",void 0),(0,v._)([(0,n.Cb)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],N.prototype,"imageMaxWidth",void 0),(0,v._)([(0,n.Cb)()],N.prototype,"imageTransparency",void 0),(0,v._)([(0,n.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N.prototype,"isReference",void 0),(0,v._)([(0,n.Cb)({json:{read:!1,write:!1}})],N.prototype,"labelsVisible",void 0),(0,v._)([(0,n.Cb)({type:["ArcGISMapServiceLayer"]})],N.prototype,"operationalLayerType",void 0),(0,v._)([(0,n.Cb)({json:{read:!1,write:!1}})],N.prototype,"popupEnabled",void 0),(0,v._)([(0,n.Cb)()],N.prototype,"sourceJSON",void 0),(0,v._)([(0,n.Cb)({json:{write:{ignoreOrigin:!0}}})],N.prototype,"sublayers",void 0),(0,v._)([(0,O.c)("sublayers",{layers:{type:[I.Z]},visibleLayers:{type:[a.z8]}})],N.prototype,"writeSublayers",null),(0,v._)([(0,n.Cb)({type:["show","hide","hide-children"]})],N.prototype,"listMode",void 0),(0,v._)([(0,n.Cb)({json:{read:!1},readOnly:!0,value:"map-image"})],N.prototype,"type",void 0),(0,v._)([(0,n.Cb)(w.HQ)],N.prototype,"url",void 0),N=(0,v._)([(0,E.j)("esri.layers.MapImageLayer")],N);const R=N},84523:(ee,V,t)=>{t.r(V),t.d(V,{default:()=>J});var s=t(79076),C=(t(61243),t(30351)),y=t(61414),D=t(32810),B=t(13778),m=t(30164),u=t(94911),c=(t(45072),t(30627),t(55865),t(38650)),P=t(96410),a=t(88445),o=t(2045),E=t(88945),O=t(46839),_=t(32617),l=t(77883),p=t(41099),h=t(38881),L=t(87940),g=t(30971),W=t(70157),F=t(96583),A=t(36262);let b=class extends((0,E.h)((0,l.Q)((0,p.M)((0,O.q)((0,_.I)((0,D.R)(o.Z))))))){constructor(...M){super(...M),this.copyright="",this.fullExtent=new W.Z(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,F.Z.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=F.Z.WebMercator,this.subDomains=null,this.tileInfo=new L.Z({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new A.Z({x:-20037508.342787,y:20037508.342787,spatialReference:F.Z.WebMercator}),spatialReference:F.Z.WebMercator,lods:[new h.Z({level:0,scale:591657527.591555,resolution:156543.033928}),new h.Z({level:1,scale:295828763.795777,resolution:78271.5169639999}),new h.Z({level:2,scale:147914381.897889,resolution:39135.7584820001}),new h.Z({level:3,scale:73957190.948944,resolution:19567.8792409999}),new h.Z({level:4,scale:36978595.474472,resolution:9783.93962049996}),new h.Z({level:5,scale:18489297.737236,resolution:4891.96981024998}),new h.Z({level:6,scale:9244648.868618,resolution:2445.98490512499}),new h.Z({level:7,scale:4622324.434309,resolution:1222.99245256249}),new h.Z({level:8,scale:2311162.217155,resolution:611.49622628138}),new h.Z({level:9,scale:1155581.108577,resolution:305.748113140558}),new h.Z({level:10,scale:577790.554289,resolution:152.874056570411}),new h.Z({level:11,scale:288895.277144,resolution:76.4370282850732}),new h.Z({level:12,scale:144447.638572,resolution:38.2185141425366}),new h.Z({level:13,scale:72223.819286,resolution:19.1092570712683}),new h.Z({level:14,scale:36111.909643,resolution:9.55462853563415}),new h.Z({level:15,scale:18055.954822,resolution:4.77731426794937}),new h.Z({level:16,scale:9027.977411,resolution:2.38865713397468}),new h.Z({level:17,scale:4513.988705,resolution:1.19432856685505}),new h.Z({level:18,scale:2256.994353,resolution:.597164283559817}),new h.Z({level:19,scale:1128.497176,resolution:.298582141647617}),new h.Z({level:20,scale:564.248588,resolution:.14929107082380833}),new h.Z({level:21,scale:282.124294,resolution:.07464553541190416}),new h.Z({level:22,scale:141.062147,resolution:.03732276770595208}),new h.Z({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(M,j){return"string"==typeof M?te({urlTemplate:M},j):M}load(M){const j=this.loadFromPortal({supportedTypes:["WMTS"]},M).then(()=>{let G="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const K=new m.R9(this.urlTemplate);this.subDomains&&this.subDomains.length>0||-1===K.authority.indexOf("{subDomain}")||(G="is missing 'subDomains' property")}else G="spatialReference must match tileInfo.spatialReference";else G="is missing the required 'urlTemplate' property value";if(G)throw new y.Z("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${G}`)});return this.addResolvingPromise(j),Promise.resolve(this)}get levelValues(){const M=[];if(!this.tileInfo)return null;for(const j of this.tileInfo.lods)M[j.level]=j.levelValue||j.level;return M}readSpatialReference(M,j){return M||j.fullExtent&&j.fullExtent.spatialReference&&F.Z.fromJSON(j.fullExtent.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const M=[],{urlTemplate:j,subDomains:G}=this,K=new m.R9(j),w=K.scheme?K.scheme+"://":"//",$=w+K.authority+"/";if(-1===K.authority.indexOf("{subDomain}"))M.push($);else if(G&&G.length>0&&K.authority.split(".").length>1)for(const I of G)M.push(w+K.authority.replace(/\{subDomain\}/gi,I)+"/");return M.map(I=>("/"!==I.charAt(I.length-1)&&(I+="/"),I))}get urlPath(){if(!this.urlTemplate)return null;const M=this.urlTemplate,j=new m.R9(M),G=(j.scheme?j.scheme+"://":"//")+j.authority+"/";return M.substring(G.length)}readUrlTemplate(M,j){return M||j.templateUrl}writeUrlTemplate(M,j){M&&(0,m.oC)(M)&&(M="https:"+M),M&&(M=M.replace(/\{z\}/gi,"{level}").replace(/\{x\}/gi,"{col}").replace(/\{y\}/gi,"{row}"),M=(0,m.Fv)(M)),j.templateUrl=M}fetchTile(M,j,G,K={}){const{signal:w}=K,$=this.getTileUrl(M,j,G),I={responseType:"image",signal:w,query:te({},this.refreshParameters)};return(0,C.default)($,I).then(Z=>Z.data)}getTileUrl(M,j,G){const K=this.levelValues[M];return this.tileServers[j%this.tileServers.length]+(0,B.gx)(this.urlPath,{level:K,z:K,col:G,x:G,row:j,y:j})}};(0,s._)([(0,u.Cb)({type:String,value:"",json:{write:!0}})],b.prototype,"copyright",void 0),(0,s._)([(0,u.Cb)({type:W.Z,json:{write:!0},nonNullable:!0})],b.prototype,"fullExtent",void 0),(0,s._)([(0,u.Cb)({readOnly:!0,json:{read:!1,write:!1}})],b.prototype,"legendEnabled",void 0),(0,s._)([(0,u.Cb)({type:["show","hide"]})],b.prototype,"listMode",void 0),(0,s._)([(0,u.Cb)()],b.prototype,"levelValues",null),(0,s._)([(0,u.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],b.prototype,"isReference",void 0),(0,s._)([(0,u.Cb)({type:["WebTiledLayer"],value:"WebTiledLayer"})],b.prototype,"operationalLayerType",void 0),(0,s._)([(0,u.Cb)({readOnly:!0,json:{read:!1,write:!1}})],b.prototype,"popupEnabled",void 0),(0,s._)([(0,u.Cb)({type:F.Z})],b.prototype,"spatialReference",void 0),(0,s._)([(0,c.r)("spatialReference",["spatialReference","fullExtent.spatialReference"])],b.prototype,"readSpatialReference",null),(0,s._)([(0,u.Cb)({type:[String],json:{write:!0}})],b.prototype,"subDomains",void 0),(0,s._)([(0,u.Cb)({type:L.Z,json:{write:!0}})],b.prototype,"tileInfo",void 0),(0,s._)([(0,u.Cb)({readOnly:!0})],b.prototype,"tileServers",null),(0,s._)([(0,u.Cb)({json:{read:!1}})],b.prototype,"type",void 0),(0,s._)([(0,u.Cb)()],b.prototype,"urlPath",null),(0,s._)([(0,u.Cb)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],b.prototype,"urlTemplate",void 0),(0,s._)([(0,c.r)("urlTemplate",["urlTemplate","templateUrl"])],b.prototype,"readUrlTemplate",null),(0,s._)([(0,a.c)("urlTemplate",{templateUrl:{type:String}})],b.prototype,"writeUrlTemplate",null),(0,s._)([(0,u.Cb)({type:g.Z,json:{write:!0}})],b.prototype,"wmtsInfo",void 0),b=(0,s._)([(0,P.j)("esri.layers.WebTileLayer")],b);const J=b},19109:(ee,V,t)=>{t.d(V,{S:()=>v,X:()=>s});const s=1;function v(C,y){let D=0;for(const m of y){var B;const u=null==(B=m.attributes)?void 0:B[C];"number"==typeof u&&isFinite(u)&&(D=Math.max(D,u))}return D}},45033:(ee,V,t)=>{t.d(V,{MS:()=>u,Dm:()=>B,Hq:()=>m,bU:()=>D});var s=t(30627),v=t(60161),C=t(91343),y=t(70338);function D(S){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===S||"esriGeometryMultipoint"===S?y.I4:"esriGeometryPolyline"===S?y.ET:y.lF}}}function B(S,d){if((0,s.Z)("esri-csp-restrictions"))return()=>te({[d]:null},S);try{let n=`this.${d} = null;`;for(const P in S)n+=`this${P.includes(".")?`["${P}"]`:`.${P}`} = ${JSON.stringify(S[P])};`;const c=new Function(n);return()=>new c}catch(n){return()=>te({[d]:null},S)}}function m(S={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,v.d9)(S)}}]}function u(S,d){return{attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:S},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:d,supportsDelete:d,supportsEditing:d,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:d,supportsExceedsLimitStatistics:!0},query:C.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0},editing:{supportsGeometryUpdate:d,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},6035:(ee,V,t)=>{t.d(V,{av:()=>B,d1:()=>u,b:()=>E,O0:()=>d,og:()=>P});var s=t(49996),v=t(35169),C=t(6663);class y{constructor(){this.code=null,this.description=null}}class D{constructor(l){this.error=new y,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=l}}function B(_){return new D(_)}class m{constructor(l){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=l}}function u(_){return new m(_)}const S=new Set;function d(_,l,p,h=!1,L){S.clear();for(const g in p){const W=_.get(g);if(!W)continue;const F=p[g],A=n(W,F);if(A!==F&&L&&L.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:W,originalValue:F,sanitizedValue:A}}),S.add(W.name),W&&(h||W.editable)){const b=(0,C.Qc)(W,A);if(b)return B((0,C.vP)(b,W,A));l[W.name]=A}}for(const g of _.requiredFields)if(!S.has(g.name))return B(`missing required field "${g.name}"`);return null}function n(_,l){let p=l;return"string"==typeof l&&(0,C.H7)(_)?p=parseFloat(l):null!=l&&(0,C.qN)(_)&&"string"!=typeof l&&(p=String(l)),(0,C.Pz)(p)}let c;function P(_,l){if(!_||!(0,v.JY)(l))return _;if("rings"in _||"paths"in _){if(!c)throw new TypeError("geometry engine not loaded");return c.simplify(l,_)}return _}function a(){return o.apply(this,arguments)}function o(){return(o=(0,s.Z)(function*(){return c||(c=yield Promise.all([t.e(6571),t.e(8592),t.e(5571)]).then(t.bind(t,25571)),c)})).apply(this,arguments)}function E(_,l){return O.apply(this,arguments)}function O(){return(O=(0,s.Z)(function*(_,l){!(0,v.JY)(_)||"esriGeometryPolygon"!==l&&"esriGeometryPolyline"!==l||(yield a())})).apply(this,arguments)}},90363:(ee,V,t)=>{t.d(V,{Z:()=>c});var s=t(79076),C=(t(61243),t(94911)),m=(t(45072),t(30627),t(55865),t(38650)),u=t(96410),S=t(57275),d=t(65022),n=t(96583);const c=P=>{let a=class extends P{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(o,E){return null!=E.minLOD&&null!=E.maxLOD?o:0}readMaxScale(o,E){return null!=E.minLOD&&null!=E.maxLOD?o:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(o,E){return E.capabilities&&E.capabilities.indexOf("Tilemap")>-1?new d.y({layer:this}):null}};return(0,s._)([(0,C.Cb)({json:{read:{source:"copyrightText"}}})],a.prototype,"copyright",void 0),(0,s._)([(0,C.Cb)()],a.prototype,"minScale",void 0),(0,s._)([(0,m.r)("service","minScale")],a.prototype,"readMinScale",null),(0,s._)([(0,C.Cb)()],a.prototype,"maxScale",void 0),(0,s._)([(0,m.r)("service","maxScale")],a.prototype,"readMaxScale",null),(0,s._)([(0,C.Cb)({type:n.Z})],a.prototype,"spatialReference",void 0),(0,s._)([(0,C.Cb)({readOnly:!0})],a.prototype,"supportsBlankTile",null),(0,s._)([(0,C.Cb)(S.h)],a.prototype,"tileInfo",void 0),(0,s._)([(0,C.Cb)()],a.prototype,"tilemapCache",void 0),(0,s._)([(0,m.r)("service","tilemapCache",["capabilities"])],a.prototype,"readTilemapCache",null),(0,s._)([(0,C.Cb)()],a.prototype,"version",void 0),a=(0,s._)([(0,u.j)("esri.layers.mixins.ArcGISCachedService")],a),a}},44921:(ee,V,t)=>{t.d(V,{$9:()=>_,Lu:()=>O,w9:()=>l,j:()=>h,G4:()=>g,gp:()=>F,eS:()=>b,d:()=>M,yN:()=>j,WW:()=>K});var s=t(49996),C=(t(61243),t(30351)),y=t(61414),D=t(22345),B=t(18502),m=t(35169),u=t(3403),S=t(42187),d=t(98538),n=t(98254),c=t(45033),P=t(62419),a=t(34309),o=t(96583);const E=D.Z.getLogger("esri.layers.graphics.sources.ogcfeature"),O="http://www.opengis.net/def/crs/",_=`${O}OGC/1.3/CRS84`;function l(x,U){return p.apply(this,arguments)}function p(){return(p=(0,s.Z)(function*(x,U,H={},k=5){const{links:X}=x,Y=T(X,"items","application/geo+json")||T(X,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,B.Wi)(Y))throw new y.Z("ogc-feature-layer:missing-items-page","Missing items url");const{data:Q}=yield(0,C.default)(Y.href,{signal:H.signal,query:ae(te({limit:k},H.customParameters),{token:H.apiKey}),headers:{accept:"application/geo+json"}});yield(0,n.O3)(Q);const q=(0,n.my)(Q,{geometryType:U.geometryType}),se=U.fields||q.fields||[],oe=null!=U.hasZ?U.hasZ:q.hasZ,ne=q.geometryType,le=U.objectIdField||q.objectIdFieldName||"OBJECTID";let re=U.timeInfo;const ue=se.find(ie=>ie.name===le);if(ue)ue.type="esriFieldTypeOID",ue.editable=!1,ue.nullable=!1;else{if(!q.objectIdFieldType)throw new y.Z("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");se.unshift({name:le,alias:le,type:"esriFieldTypeOID",editable:!1,nullable:!1})}if(le!==q.objectIdFieldName){const ie=se.find(ce=>ce.name===q.objectIdFieldName);ie&&(ie.type="esriFieldTypeInteger")}se===q.fields&&q.unknownFields.length>0&&E.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:q.unknownFields}});for(const ie of se){if(null==ie.name&&(ie.name=ie.alias),null==ie.alias&&(ie.alias=ie.name),"esriFieldTypeOID"!==ie.type&&"esriFieldTypeGlobalID"!==ie.type&&(ie.editable=null==ie.editable||!!ie.editable,ie.nullable=null==ie.nullable||!!ie.nullable),!ie.name)throw new y.Z("ogc-feature-layer:invalid-field-name","field name is missing",{field:ie});if(-1===a.v.jsonValues.indexOf(ie.type))throw new y.Z("ogc-feature-layer:invalid-field-type",`invalid type for field "${ie.name}"`,{field:ie})}if(re){const ie=new P.Z(se);if(re.startTimeField){const ce=ie.get(re.startTimeField);ce?(re.startTimeField=ce.name,ce.type="esriFieldTypeDate"):re.startTimeField=null}if(re.endTimeField){const ce=ie.get(re.endTimeField);ce?(re.endTimeField=ce.name,ce.type="esriFieldTypeDate"):re.endTimeField=null}if(re.trackIdField){const ce=ie.get(re.trackIdField);ce?re.trackIdField=ce.name:(re.trackIdField=null,E.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:re}}))}re.startTimeField||re.endTimeField||(E.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:re}}),re=null)}return{drawingInfo:ne?(0,c.bU)(ne):null,geometryType:ne,fields:se,hasZ:!!oe,objectIdField:le,timeInfo:re}})).apply(this,arguments)}function h(x){return L.apply(this,arguments)}function L(){return(L=(0,s.Z)(function*(x,U={}){const{links:H}=x,k=T(H,"data","application/json")||T(H,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if((0,B.Wi)(k))throw new y.Z("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:X,customParameters:Y,signal:Q}=U,{data:q}=yield(0,C.default)(k.href,{signal:Q,headers:{accept:"application/json"},query:ae(te({},Y),{token:X})});return q})).apply(this,arguments)}function g(x){return W.apply(this,arguments)}function W(){return(W=(0,s.Z)(function*(x,U={}){const{links:H}=x,k=T(H,"conformance","application/json")||T(H,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if((0,B.Wi)(k))throw new y.Z("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:X,customParameters:Y,signal:Q}=U,{data:q}=yield(0,C.default)(k.href,{signal:Q,headers:{accept:"application/json"},query:ae(te({},Y),{token:X})});return q})).apply(this,arguments)}function F(x){return A.apply(this,arguments)}function A(){return(A=(0,s.Z)(function*(x,U={}){const{apiKey:H,customParameters:k,signal:X}=U,{data:Y}=yield(0,C.default)(x,{signal:X,headers:{accept:"application/json"},query:ae(te({},k),{token:H})});return Y})).apply(this,arguments)}function b(x){return J.apply(this,arguments)}function J(){return(J=(0,s.Z)(function*(x,U={}){const H="application/vnd.oai.openapi+json;version=3.0",k=T(x.links,"service-desc",H);if((0,B.Wi)(k))return E.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:X,customParameters:Y,signal:Q}=U,{data:q}=yield(0,C.default)(k.href,{signal:Q,headers:{accept:H},query:ae(te({},Y),{token:X})});return q})).apply(this,arguments)}function M(x){const U=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(x),H=null==U?void 0:U.groups;if(!H)return null;const{authority:k,code:X}=H;switch(k.toLowerCase()){case"ogc":switch(X.toLowerCase()){case"crs27":return o.Z.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return o.Z.WGS84.wkid;default:return null}case"esri":case"epsg":{const Y=Number.parseInt(X,10);return Number.isNaN(Y)?null:Y}default:return null}}function j(x,U,H){return G.apply(this,arguments)}function G(){return(G=(0,s.Z)(function*(x,U,H){const k=yield K(x,U,H);return(0,S.cn)(k)})).apply(this,arguments)}function K(x,U,H){return w.apply(this,arguments)}function w(){return(w=(0,s.Z)(function*(x,U,H){const{capabilities:{query:{maxRecordCount:k}},collection:X,layerDefinition:Y,queryParameters:{apiKey:Q,customParameters:q},spatialReference:se,supportedCrs:oe}=x,{links:ne}=X,le=T(ne,"items","application/geo+json")||T(ne,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,B.Wi)(le))throw new y.Z("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:re,num:ue,start:ie,timeExtent:ce,where:Ce}=U;if(U.objectIds)throw new y.Z("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");const Ie=o.Z.fromJSON(se),he=(0,B.Pt)(U.outSpatialReference,Ie),fe=he.isWGS84?null:I(he,oe),Te=z(re,oe),xe=N(ce),Re=R(Ce),Se=null!=ue?ue:null!=ie&&void 0!==ie?10:k,{data:pe}=yield(0,C.default)(le.href,ae(te({},H),{query:ae(te(te({},q),Te),{crs:fe,datetime:xe,query:Re,limit:Se,startindex:ie,token:Q}),headers:{accept:"application/geo+json"}}));let me=!1;pe.links&&(me=!!pe.links.find(ye=>"next"===ye.rel)),!me&&Number.isInteger(pe.numberMatched)&&Number.isInteger(pe.numberReturned)&&(me=pe.numberReturned<pe.numberMatched);const{fields:be,globalIdField:Ae,hasM:je,hasZ:ge,objectIdField:ve}=Y,Ee=Y.geometryType,Pe=(0,n.lG)(pe,{geometryType:Ee,hasZ:ge,objectIdField:ve});if(!fe&&he.isWebMercator)for(const _e of Pe)if((0,B.pC)(_e.geometry)){const ye=(0,S.di)(_e.geometry,Ee,ge,!1);ye.spatialReference=o.Z.WGS84,_e.geometry=(0,S.GH)((0,u.iV)(ye,he))}for(const _e of Pe)_e.objectId=_e.attributes[ve];const Ue=fe||!fe&&he.isWebMercator?he.toJSON():m.Zn,de=new d.Z;return de.exceededTransferLimit=me,de.features=Pe,de.fields=be,de.geometryType=Ee,de.globalIdFieldName=Ae,de.hasM=je,de.hasZ=ge,de.objectIdFieldName=ve,de.spatialReference=Ue,de})).apply(this,arguments)}function I(x,U){var H,k,X;const{isWebMercator:Y,wkid:Q}=x;if(!Q)return null;const q=Y?null!=(H=null!=(k=null!=(X=U[3857])?X:U[102100])?k:U[102113])?H:U[900913]:U[x.wkid];return q?`${O}${q}`:null}function Z(x){if((0,B.Wi)(x))return"";const{xmin:U,ymin:H,xmax:k,ymax:X}=x;return`${U},${H},${k},${X}`}function N(x){if((0,B.Wi)(x))return null;const{start:U,end:H}=x;return`${(0,B.pC)(U)?U.toISOString():".."}/${(0,B.pC)(H)?H.toISOString():".."}`}function R(x){return(0,B.Wi)(x)||!x||"1=1"===x?null:x}function z(x,U){if(!function(x){return(0,B.pC)(x)&&"extent"===x.type}(x))return null;const{spatialReference:H}=x;if(!H||H.isWGS84)return{bbox:Z(x)};const k=I(H,U);return(0,B.pC)(k)?{bbox:Z(x),"bbox-crs":k}:H.isWebMercator?{bbox:Z((0,u.iV)(x,o.Z.WGS84))}:null}function T(x,U,H){return x.find(k=>k.rel===U&&k.type===H)||x.find(k=>k.rel===U&&!k.type)}},71995:(ee,V,t)=>{t.d(V,{R:()=>a});var s=t(79076),v=t(6897),C=t(62091),y=t(18502),D=t(94911),S=(t(45072),t(30627),t(55865),t(96410)),d=t(46613),n=t(20975),c=t(89836);const P={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let a=class extends((0,C.p)(v.Z)){constructor(o){super(o),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const o=this.visibleSublayers.map(E=>{const O=(0,c.ff)(this.floors,E);return E.toExportImageJSON(O)});return o.length?JSON.stringify(o):null}get hasDynamicLayers(){return this.layer&&(0,n.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}set layer(o){this._get("layer")!==o&&(this._set("layer",o),this.handles.remove("layer"),o&&this.handles.add([o.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),o.on("sublayer-update",E=>this.notifyChange(P[E.propertyName]))],"layer"))}get layers(){const o=this.visibleSublayers;return o?o.length?"show:"+o.map(E=>E.id).join(","):"show:-1":null}get layerDefs(){var o;const E=!(null==(o=this.floors)||!o.length),O=this.visibleSublayers.filter(_=>null!=_.definitionExpression||E&&null!=_.floorInfo);return O.length?JSON.stringify(O.reduce((_,l)=>{const p=(0,c.ff)(this.floors,l),h=(0,y.pC)(p)?(0,c.Hp)(p,l):l.definitionExpression;return _[l.id]=h,_},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const o=this.layer;return o&&(o.commitProperty("dpi"),o.commitProperty("imageFormat"),o.commitProperty("imageTransparency"),o.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const o=[];if(!this.layer)return o;const E=this.layer.sublayers,O=l=>{const p=this.scale,h=0===p,L=0===l.minScale||p<=l.minScale,g=0===l.maxScale||p>=l.maxScale;l.visible&&(h||L&&g)&&(l.sublayers?l.sublayers.forEach(O):o.unshift(l))};E&&E.forEach(O);const _=this._get("visibleSublayers");return!_||_.length!==o.length||_.some((l,p)=>o[p]!==l)?o:_}toJSON(){const o=this.layer;let E={dpi:o.dpi,format:o.imageFormat,transparent:o.imageTransparency,gdbVersion:o.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?E.dynamicLayers=this.dynamicLayers:E=ae(te({},E),{layers:this.layers,layerDefs:this.layerDefs}),E}};(0,s._)([(0,D.Cb)({readOnly:!0})],a.prototype,"dynamicLayers",null),(0,s._)([(0,D.Cb)()],a.prototype,"floors",void 0),(0,s._)([(0,D.Cb)({readOnly:!0})],a.prototype,"hasDynamicLayers",null),(0,s._)([(0,D.Cb)()],a.prototype,"layer",null),(0,s._)([(0,D.Cb)({readOnly:!0})],a.prototype,"layers",null),(0,s._)([(0,D.Cb)({readOnly:!0})],a.prototype,"layerDefs",null),(0,s._)([(0,D.Cb)({type:Number})],a.prototype,"scale",void 0),(0,s._)([(0,D.Cb)(d.qG)],a.prototype,"timeExtent",void 0),(0,s._)([(0,D.Cb)({readOnly:!0})],a.prototype,"version",null),(0,s._)([(0,D.Cb)({readOnly:!0})],a.prototype,"visibleSublayers",null),a=(0,s._)([(0,S.j)("esri.layers.mixins.ExportImageParameters")],a)},28763:(ee,V,t)=>{t.d(V,{j:()=>d});var s=t(79076),v=t(6897),C=t(62091),y=t(94911),u=(t(45072),t(30627),t(55865),t(96410));const S={visible:"visibleSublayers"};let d=class extends((0,C.p)(v.Z)){constructor(n){super(n),this.scale=0}set layer(n){this._get("layer")!==n&&(this._set("layer",n),this.handles.remove("layer"),n&&this.handles.add([n.sublayers.on("change",()=>this.notifyChange("visibleSublayers")),n.on("wms-sublayer-update",c=>this.notifyChange(S[c.propertyName]))],"layer"))}get layers(){const{visibleSublayers:n}=this;return n.filter(c=>c.name).map(c=>c.name).join(",")}get version(){this.commitProperty("layers");const n=this.layer;return n&&n.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){const{layer:n,scale:c}=this,P=null==n?void 0:n.sublayers,a=[],o=E=>{const{minScale:O,maxScale:_,sublayers:l,visible:p}=E;p&&(0===c||(0===O||c<=O)&&(0===_||c>=_))&&(l?l.forEach(o):a.unshift(E))};return null==P||P.forEach(o),a}toJSON(){const{layer:n,layers:c}=this,{imageFormat:P,imageTransparency:a,version:o}=n;return{format:P,request:"GetMap",service:"WMS",styles:"",transparent:a,version:o,layers:c}}};(0,s._)([(0,y.Cb)()],d.prototype,"layer",null),(0,s._)([(0,y.Cb)({readOnly:!0})],d.prototype,"layers",null),(0,s._)([(0,y.Cb)({type:Number})],d.prototype,"scale",void 0),(0,s._)([(0,y.Cb)({readOnly:!0})],d.prototype,"version",null),(0,s._)([(0,y.Cb)({readOnly:!0})],d.prototype,"visibleSublayers",null),d=(0,s._)([(0,u.j)("esri.layers.support.ExportWMSImageParameters")],d)},2652:(ee,V,t)=>{t.d(V,{W:()=>S});var s=t(49996),v=t(77871),C=t(30351),y=t(18502),D=t(7808),B=t(33830),m=t(70658),u=t(35797);class S{constructor(n,c,P,a){this.parsedUrl=n,this.portalItem=c,this.apiKey=P,this.signal=a,this.rootDocument=null;const o=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);o&&(this.urlParts={root:o[1],layerId:parseInt(o[2],10)})}fetch(){var n=this;return(0,s.Z)(function*(){var c;if(!n.urlParts)return null;const P=null!=(c=n.portalItem)?c:yield n.portalItemFromServiceItemId();if((0,y.Wi)(P))return n.loadFromUrl();const a=yield n.findAndLoadRelatedPortalItem(P);return(0,y.Wi)(a)?null:n.loadFeatureLayerFromPortalItem(a)})()}fetchPortalItem(){var n=this;return(0,s.Z)(function*(){var c;if(!n.urlParts)return null;const P=null!=(c=n.portalItem)?c:yield n.portalItemFromServiceItemId();return(0,y.Wi)(P)?null:n.findAndLoadRelatedPortalItem(P)})()}fetchRootDocument(){var n=this;return(0,s.Z)(function*(){if((0,y.pC)(n.rootDocument))return n.rootDocument;if((0,y.Wi)(n.urlParts))return n.rootDocument={},{};const c={query:{f:"json",token:n.apiKey},responseType:"json",signal:n.signal},P=`${n.urlParts.root}/SceneServer`;try{const a=yield(0,C.default)(P,c);n.rootDocument=a.data}catch(a){n.rootDocument={}}return n.rootDocument})()}fetchServiceOwningPortalUrl(){var n=this;return(0,s.Z)(function*(){var c;const P=null==(c=v.id)?void 0:c.findServerInfo(n.parsedUrl.path);if(null!=P&&P.owningSystemUrl)return P.owningSystemUrl;const a=n.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const o=(yield(0,C.default)(a,{query:{f:"json"},responseType:"json",signal:n.signal})).data.owningSystemUrl;if(o)return o}catch(o){(0,D.r9)(o)}return null})()}findAndLoadRelatedPortalItem(n){var c=this;return(0,s.Z)(function*(){try{return(yield n.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:c.signal})).find(P=>"Feature Service"===P.type)||null}catch(P){return(0,D.r9)(P),null}})()}loadFeatureLayerFromPortalItem(n){var c=this;return(0,s.Z)(function*(){yield n.load({signal:c.signal});const P=yield c.findMatchingAssociatedSublayerUrl(n.url);return new B.default({url:P,portalItem:n}).load({signal:c.signal})})()}loadFromUrl(){var n=this;return(0,s.Z)(function*(){const c=yield n.findMatchingAssociatedSublayerUrl(`${n.urlParts.root}/FeatureServer`);return new B.default({url:c}).load({signal:n.signal})})()}findMatchingAssociatedSublayerUrl(n){var c=this;return(0,s.Z)(function*(){const P=n.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),a={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:c.signal},o=c.urlParts.layerId,E=c.fetchRootDocument(),O=(0,C.default)(P,a),[_,l]=yield Promise.all([O,E]),p=l&&l.layers,h=_.data&&_.data.layers;if(!Array.isArray(h))throw new Error("expected layers array");if(Array.isArray(p)){for(let L=0;L<Math.min(p.length,h.length);L++)if(p[L].id===o)return`${P}/${h[L].id}`}else if(o<h.length)return`${P}/${h[o].id}`;throw new Error("could not find matching associated sublayer")})()}portalItemFromServiceItemId(){var n=this;return(0,s.Z)(function*(){const c=(yield n.fetchRootDocument()).serviceItemId;if(!c)return null;const P=new u.default({id:c,apiKey:n.apiKey}),a=yield n.fetchServiceOwningPortalUrl();(0,y.pC)(a)&&(P.portal=new m.Z({url:a}));try{return P.load({signal:n.signal})}catch(o){return(0,D.r9)(o),null}})()}}},11640:(ee,V,t)=>{t.d(V,{H3:()=>_,QI:()=>c,U4:()=>S,Yh:()=>a});var s=t(79076),v=t(41147),C=t(94911),m=(t(45072),t(30627),t(55865),t(73358)),u=t(96410);let S=class extends v.wq{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,s._)([(0,C.Cb)({type:Number})],S.prototype,"nodesPerPage",void 0),(0,s._)([(0,C.Cb)({type:Number})],S.prototype,"rootIndex",void 0),(0,s._)([(0,C.Cb)({type:String})],S.prototype,"lodSelectionMetricType",void 0),S=(0,s._)([(0,u.j)("esri.layer.support.I3SNodePageDefinition")],S);let d=class extends v.wq{constructor(){super(...arguments),this.factor=1}};(0,s._)([(0,C.Cb)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],d.prototype,"id",void 0),(0,s._)([(0,C.Cb)({type:Number})],d.prototype,"factor",void 0),d=(0,s._)([(0,u.j)("esri.layer.support.I3SMaterialTexture")],d);let n=class extends v.wq{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,s._)([(0,C.Cb)({type:[Number]})],n.prototype,"baseColorFactor",void 0),(0,s._)([(0,C.Cb)({type:d})],n.prototype,"baseColorTexture",void 0),(0,s._)([(0,C.Cb)({type:d})],n.prototype,"metallicRoughnessTexture",void 0),(0,s._)([(0,C.Cb)({type:Number})],n.prototype,"metallicFactor",void 0),(0,s._)([(0,C.Cb)({type:Number})],n.prototype,"roughnessFactor",void 0),n=(0,s._)([(0,u.j)("esri.layer.support.I3SMaterialPBRMetallicRoughness")],n);let c=class extends v.wq{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,s._)([(0,m.J)({opaque:"opaque",mask:"mask",blend:"blend"})],c.prototype,"alphaMode",void 0),(0,s._)([(0,C.Cb)({type:Number})],c.prototype,"alphaCutoff",void 0),(0,s._)([(0,C.Cb)({type:Boolean})],c.prototype,"doubleSided",void 0),(0,s._)([(0,m.J)({none:"none",back:"back",front:"front"})],c.prototype,"cullFace",void 0),(0,s._)([(0,C.Cb)({type:d})],c.prototype,"normalTexture",void 0),(0,s._)([(0,C.Cb)({type:d})],c.prototype,"occlusionTexture",void 0),(0,s._)([(0,C.Cb)({type:d})],c.prototype,"emissiveTexture",void 0),(0,s._)([(0,C.Cb)({type:[Number]})],c.prototype,"emissiveFactor",void 0),(0,s._)([(0,C.Cb)({type:n})],c.prototype,"pbrMetallicRoughness",void 0),c=(0,s._)([(0,u.j)("esri.layer.support.I3SMaterialDefinition")],c);let P=class extends v.wq{};(0,s._)([(0,C.Cb)({type:String,json:{read:{source:["name","index"],reader:(l,p)=>null!=l?l:`${p.index}`}}})],P.prototype,"name",void 0),(0,s._)([(0,m.J)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],P.prototype,"format",void 0),P=(0,s._)([(0,u.j)("esri.layer.support.I3STextureFormat")],P);let a=class extends v.wq{constructor(){super(...arguments),this.atlas=!1}};(0,s._)([(0,C.Cb)({type:[P]})],a.prototype,"formats",void 0),(0,s._)([(0,C.Cb)({type:Boolean})],a.prototype,"atlas",void 0),a=(0,s._)([(0,u.j)("esri.layer.support.I3STextureSetDefinition")],a);let o=class extends v.wq{};(0,s._)([(0,m.J)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],o.prototype,"type",void 0),(0,s._)([(0,C.Cb)({type:Number})],o.prototype,"component",void 0),o=(0,s._)([(0,u.j)("esri.layer.support.I3SGeometryAttribute")],o);let E=class extends v.wq{};(0,s._)([(0,m.J)({draco:"draco"})],E.prototype,"encoding",void 0),(0,s._)([(0,C.Cb)({type:[String]})],E.prototype,"attributes",void 0),E=(0,s._)([(0,u.j)("esri.layer.support.I3SGeometryCompressedAttributes")],E);let O=class extends v.wq{constructor(){super(...arguments),this.offset=0}};(0,s._)([(0,C.Cb)({type:Number})],O.prototype,"offset",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"position",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"normal",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"uv0",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"color",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"uvRegion",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"featureId",void 0),(0,s._)([(0,C.Cb)({type:o})],O.prototype,"faceRange",void 0),(0,s._)([(0,C.Cb)({type:E})],O.prototype,"compressedAttributes",void 0),O=(0,s._)([(0,u.j)("esri.layer.support.I3SGeometryBuffer")],O);let _=class extends v.wq{};(0,s._)([(0,m.J)({triangle:"triangle"})],_.prototype,"topology",void 0),(0,s._)([(0,C.Cb)()],_.prototype,"geometryBuffers",void 0),_=(0,s._)([(0,u.j)("esri.layer.support.I3SGeometryDefinition")],_)},65022:(ee,V,t)=>{t.d(V,{y:()=>F});var g,s=t(49996),v=t(79076),C=t(30351),y=t(6897),D=t(61414),B=t(62091),m=t(22345),u=t(72468),S=t(1294),d=t(7808),n=t(54391),c=t(30164),P=t(11652),a=t(94911),o=t(45072),O=(t(30627),t(43465)),_=t(96410),l=t(60161);class p{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}getAvailability(b,J){if("unknown"!==this._allAvailability)return this._allAvailability;const M=(b-this.location.top)*this.location.width+(J-this.location.left),j=M%8,G=M>>3,K=this._tileAvailabilityBitSet;return G<0||G>K.length?"unknown":K[G]&1<<j?"available":"unavailable"}_updateFromData(b){const J=this.location.width,M=this.location.height;let j=!0,G=!0;const K=Math.ceil(J*M/8),w=new Uint8Array(K);let $=0;for(let I=0;I<b.length;I++){const Z=I%8;b[I]?(G=!1,w[$]|=1<<Z):j=!1,7===Z&&++$}G?this._allAvailability="unavailable":j?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=w,this.byteSize+=w.length)}static fromDefinition(b,J){const M=b.service.request||C.default,{row:j,col:G,width:K,height:w}=b,$={query:{f:"json"}};return J=J?te(te({},$),J):$,M(function(A){let b;if("vector-tile"===A.service.type)b=`${A.service.url}/tilemap/${A.level}/${A.row}/${A.col}/${A.width}/${A.height}`;else{const M=A.service.tileServers;b=`${M&&M.length?M[A.row%M.length]:A.service.url}/tilemap/${A.level}/${A.row}/${A.col}/${A.width}/${A.height}`}const J=A.service.query;return J&&(b=`${b}?${J}`),b}(b),J).then(I=>I.data).catch(I=>{if(I&&I.details&&422===I.details.httpStatus)return{location:{top:j,left:G,width:K,height:w},valid:!0,data:(0,o.a9)(K*w,0)};throw I}).then(I=>{if(I.location&&(I.location.top!==j||I.location.left!==G||I.location.width!==K||I.location.height!==w))throw new D.Z("tilemap:location-mismatch","Tilemap response for different location than requested",{response:I,definition:{top:j,left:G,width:K,height:w}});return p.fromJSON(I)})}static fromJSON(b){p.validateJSON(b);const J=new p;return J.location=Object.freeze((0,l.d9)(b.location)),J._updateFromData(b.data),Object.freeze(J)}static validateJSON(b){if(!b||!b.location)throw new D.Z("tilemap:missing-location","Location missing from tilemap response");if(!1===b.valid)throw new D.Z("tilemap:invalid","Tilemap response was marked as invalid");if(!b.data)throw new D.Z("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(b.data))throw new D.Z("tilemap:data-mismatch","Data must be an array of numbers");if(b.data.length!==b.location.width*b.location.height)throw new D.Z("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}function h(A){return`${A.level}/${A.row}/${A.col}/${A.width}/${A.height}`}const W=m.Z.getLogger("esri.layers.support.TilemapCache");let F=g=class extends((0,B.p)(y.Z)){constructor(A){super(A),this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=C.default,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new u.Z(this.cacheByteSize),this.handles.add([this.watch(["layer.parsedUrl","layer.tileServers?","layer.apiKey?","layer.customParameters?"],()=>this._initializeTilemapDefinition()),(0,P.S1)(this,"layer.tileInfo.lods",A=>this._initializeAvailableLevels(A),!0)]),this._initializeTilemapDefinition()}castLevels(A){return A<=2?(W.error("Minimum levels for Tilemap is 3, but got ",A),3):A}get size(){return 1<<this.levels}fetchTilemap(A,b,J,M){if(!this._availableLevels[A])return Promise.reject(new D.Z("tilemap-cache:level-unavailable",`Level ${A} is unavailable in the service`));const j=this._tmpTilemapDefinition,G=this._tilemapFromCache(A,b,J,j);if(G)return Promise.resolve(G);const K=M&&M.signal;return M=ae(te({},M),{signal:null}),new Promise((w,$)=>{(0,d.fu)(K,()=>$((0,d.zE)()));const I=h(j);let Z=this._pendingTilemapRequests[I];if(!Z){Z=p.fromDefinition(j,M).then(R=>(this._tilemapCache.put(I,R,R.byteSize),R));const N=()=>delete this._pendingTilemapRequests[I];this._pendingTilemapRequests[I]=Z,Z.then(N,N)}Z.then(w,$)})}getAvailability(A,b,J){if(!this._availableLevels[A])return"unavailable";const M=this._tilemapFromCache(A,b,J,this._tmpTilemapDefinition);return M?M.getAvailability(b,J):"unknown"}fetchAvailability(A,b,J,M){return this._availableLevels[A]?this.fetchTilemap(A,b,J,M).catch(j=>j).then(j=>{if(j instanceof p){const G=j.getAvailability(b,J);return"unavailable"===G?Promise.reject(new D.Z("tile-map:tile-unavailable","Tile is not available",{level:A,row:b,col:J})):G}if((0,d.D_)(j))throw j;return"unknown"}):Promise.reject(new D.Z("tilemap-cache:level-unavailable",`Level ${A} is unavailable in the service`))}fetchAvailabilityUpsample(A,b,J,M,j){M.level=A,M.row=b,M.col=J;const G=this.layer.tileInfo;G.updateTileInfo(M);const K=this.fetchAvailability(A,b,J,j).catch(w=>{if((0,d.D_)(w))throw w;if(G.upsampleTile(M))return this.fetchAvailabilityUpsample(M.level,M.row,M.col,M);throw w});return this._fetchAvailabilityUpsamplePrefetch(M.id,A,b,J,j,K),K}_fetchAvailabilityUpsamplePrefetch(A,b,J,M,j,G){var K=this;return(0,s.Z)(function*(){if(!K._prefetchingEnabled)return;const w=`prefetch-${A}`;if(K.handles.has(w))return;const $=new AbortController;G.then(()=>$.abort(),()=>$.abort());let I=!1;const Z={remove(){I||(I=!0,$.abort())}};if(K.handles.add(Z,w),yield(0,n.MU)(10,$.signal).catch(()=>{}),I||(I=!0,K.handles.remove(w)),(0,d.Hc)($))return;const N={id:A,level:b,row:J,col:M},R=ae(te({},j),{signal:$.signal}),z=K.layer.tileInfo;for(let T=0;g._prefetches.length<g._maxPrefetch&&z.upsampleTile(N);++T){const x=K.fetchAvailability(N.level,N.row,N.col,R);g._prefetches.push(x);const U=()=>{g._prefetches.removeUnordered(x)};x.then(U,U)}})()}_initializeTilemapDefinition(){var A;if(!this.layer.parsedUrl)return;const{parsedUrl:b,apiKey:J,customParameters:M}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:b.path,query:(0,c.B7)(ae(te(te({},b.query),M),{token:null!=J?J:null==(A=b.query)?void 0:A.token})),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(A,b,J,M){M.level=A,M.row=b-b%this.size,M.col=J-J%this.size;const j=h(M);return this._tilemapCache.get(j)}_initializeAvailableLevels(A){this._availableLevels={},A&&A.forEach(b=>this._availableLevels[b.level]=!0)}get test(){const A=this;return{get prefetchingEnabled(){return A._prefetchingEnabled},set prefetchingEnabled(b){A._prefetchingEnabled=b},hasTilemap:(b,J,M)=>!!A._tilemapFromCache(b,J,M,A._tmpTilemapDefinition)}}};F._maxPrefetch=4,F._prefetches=new S.Z({initialSize:g._maxPrefetch}),(0,v._)([(0,a.Cb)({constructOnly:!0,type:Number})],F.prototype,"levels",void 0),(0,v._)([(0,O.p)("levels")],F.prototype,"castLevels",null),(0,v._)([(0,a.Cb)({readOnly:!0,type:Number})],F.prototype,"size",null),(0,v._)([(0,a.Cb)({constructOnly:!0,type:Number})],F.prototype,"cacheByteSize",void 0),(0,v._)([(0,a.Cb)({constructOnly:!0})],F.prototype,"layer",void 0),(0,v._)([(0,a.Cb)({constructOnly:!0})],F.prototype,"request",void 0),F=g=(0,v._)([(0,_.j)("esri.layers.support.TilemapCache")],F)},30971:(ee,V,t)=>{t.d(V,{Z:()=>S});var m,s=t(79076),v=t(41147),C=t(60161),y=t(94911),B=(t(55865),t(96410));let u=m=class extends v.wq{constructor(d){super(d)}clone(){return new m({customLayerParameters:(0,C.d9)(this.customLayerParameters),customParameters:(0,C.d9)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};(0,s._)([(0,y.Cb)({json:{type:Object,write:!0}})],u.prototype,"customLayerParameters",void 0),(0,s._)([(0,y.Cb)({json:{type:Object,write:!0}})],u.prototype,"customParameters",void 0),(0,s._)([(0,y.Cb)({type:String,json:{write:!0}})],u.prototype,"layerIdentifier",void 0),(0,s._)([(0,y.Cb)({type:String,json:{write:!0}})],u.prototype,"tileMatrixSet",void 0),(0,s._)([(0,y.Cb)({type:String,json:{write:!0}})],u.prototype,"url",void 0),u=m=(0,s._)([(0,B.j)("esri.layer.support.WMTSLayerInfo")],u);const S=u},61334:(ee,V,t)=>{t.d(V,{C:()=>s});const s={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,tileMaxRecordCount:0}}},5285:(ee,V,t)=>{t.d(V,{lm:()=>L,CS:()=>o,Yu:()=>p,Cw:()=>a,j5:()=>E});var s=t(49996),v=t(76925),C=t(77871),y=t(24093),D=t(30351),B=t(60161),m=t(30164),u=t(96583),S=t(61164),d=t(15783),n=t(94111),c=t(42762);const P={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function a(g){const W=g.folders||[],F=W.slice(),A=new Map,b=new Map,J=new Map,M=new Map,j=new Map,G={esriGeometryPoint:b,esriGeometryPolyline:J,esriGeometryPolygon:M};(g.featureCollection&&g.featureCollection.layers||[]).forEach(w=>{const $=(0,B.d9)(w);$.featureSet.features=[];const I=w.featureSet.geometryType;A.set(I,$);const Z=w.layerDefinition.objectIdField;"esriGeometryPoint"===I?O(b,Z,w.featureSet.features):"esriGeometryPolyline"===I?O(J,Z,w.featureSet.features):"esriGeometryPolygon"===I&&O(M,Z,w.featureSet.features)}),g.groundOverlays&&g.groundOverlays.forEach(w=>{j.set(w.id,w)}),W.forEach(w=>{w.networkLinkIds.forEach($=>{const I=function(g,W,F){const A=function(g,W){let F;return W.some(A=>A.id===g&&(F=A,!0)),F}(g,F);return A&&(A.parentFolderId=W,A.networkLink=A),A}($,w.id,g.networkLinks);I&&F.push(I)})}),F.forEach(w=>{if(w.featureInfos){w.points=(0,B.d9)(A.get("esriGeometryPoint")),w.polylines=(0,B.d9)(A.get("esriGeometryPolyline")),w.polygons=(0,B.d9)(A.get("esriGeometryPolygon")),w.mapImages=[];for(const $ of w.featureInfos)switch($.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{const I=G[$.type].get($.id);I&&w[P[$.type]].featureSet.features.push(I);break}case"GroundOverlay":{const I=j.get($.id);I&&w.mapImages.push(I);break}}w.fullExtent=L([w])}});const K=L(F);return{folders:W,sublayers:F,extent:K}}function o(g,W,F,A){const b=C.id&&C.id.findCredential(g);g=(0,m.fl)(g,{token:b&&b.token});const J=v.Z.kmlServiceUrl;return(0,D.default)(J,{query:{url:g,model:"simple",folders:"",refresh:0!==F||void 0,outSR:JSON.stringify(W)},responseType:"json",signal:A})}function E(g,W,F=null,A=[]){const b=[],J={},M=W.sublayers,j=W.folders.map(G=>G.id);return M.forEach(G=>{const K=new g;if(F?K.read(G,F):K.read(G),A.length&&j.indexOf(K.id)>-1&&(K.visible=-1!==A.indexOf(K.id)),J[G.id]=K,null!=G.parentFolderId&&-1!==G.parentFolderId){const w=J[G.parentFolderId];w.sublayers||(w.sublayers=[]),w.sublayers.unshift(K)}else b.unshift(K)}),b}function O(g,W,F){F.forEach(A=>{g.set(A.attributes[W],A)})}function p(g){return h.apply(this,arguments)}function h(){return(h=(0,s.Z)(function*(g){const W=c.default.fromJSON(g.featureSet).features,F=g.layerDefinition,A=(0,n.i)(F.drawingInfo.renderer),b=y.Z.fromJSON(g.popupInfo),J=[];for(const M of W){const j=yield A.getSymbolAsync(M);M.symbol=j,M.popupTemplate=b,M.visible=!0,J.push(M)}return J})).apply(this,arguments)}function L(g){const W=(0,S.Ue)(S.Gv),F=(0,S.Ue)(S.Gv);for(const A of g){if(A.polygons&&A.polygons.featureSet&&A.polygons.featureSet.features)for(const b of A.polygons.featureSet.features)(0,d.Yg)(W,b.geometry),(0,S.TC)(F,W);if(A.polylines&&A.polylines.featureSet&&A.polylines.featureSet.features)for(const b of A.polylines.featureSet.features)(0,d.Yg)(W,b.geometry),(0,S.TC)(F,W);if(A.points&&A.points.featureSet&&A.points.featureSet.features)for(const b of A.points.featureSet.features)(0,d.Yg)(W,b.geometry),(0,S.TC)(F,W);if(A.mapImages)for(const b of A.mapImages)(0,d.Yg)(W,b.extent),(0,S.TC)(F,W)}return(0,S.fS)(F,S.Gv)?null:{xmin:F[0],ymin:F[1],zmin:F[2],xmax:F[3],ymax:F[4],zmax:F[5],spatialReference:u.Z.WGS84}}},33135:(ee,V,t)=>{t.d(V,{OE:()=>c,Gc:()=>o,Qg:()=>P,Rq:()=>u,gX:()=>a,z2:()=>S,ET:()=>d,Vx:()=>O});t(61243);var v=t(18502);var y=t(11057),D=t(36262);const B=new Map,m=new class{constructor(l=15e3,p=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=l,this._interval=Math.min(l,p)}decreaseRefCount(l,p){const h=l+"/"+p,L=this._cachedBlocks;if(L.has(h)){const g=L.get(h);return g.refCount--,g.refCount<=0&&(L.delete(h),g.controller&&g.controller.abort()),g.refCount}return 0}getBlock(l,p){const h=l+"/"+p,L=this._cachedBlocks;if(L.has(h)){const g=L.get(h);return g.ts=Date.now(),g.refCount++,L.delete(h),L.set(h,g),g.block}return null}putBlock(l,p,h,L=null){const g=this._cachedBlocks,W=l+"/"+p;if(g.has(W)){const F=g.get(W);F.ts=Date.now(),F.refCount++}else g.set(W,{block:h,ts:Date.now(),refCount:1,controller:L});this.trim(),this.updateTimer()}deleteBlock(l,p){const h=this._cachedBlocks,L=l+"/"+p;h.has(L)&&h.delete(L)}updateMaxSize(l){this._size=l,this.trim()}empty(){this._cachedBlocks.clear(),this.clearTimer()}getCurrentSize(){return this._cachedBlocks.size}updateTimer(){if(null!=this._timer)return;const l=this._cachedBlocks;this._timer=setInterval(()=>{const p=Array.from(l),h=Date.now();for(let L=0;L<p.length&&p[L][1].ts<=h-this._duration;L++)l.delete(p[L][0]);0===l.size&&this.clearTimer()},this._interval)}trim(){const l=this._cachedBlocks;if(-1===this._size||this._size>=l.size)return;const p=Array.from(l);for(let h=0;h<p.length-this._size;h++)l.delete(p[h][0])}clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}};function u(_,l){return null==l?_:`${_}?sliceId=${l}`}function S(_,l){const p={extent:null,rasterInfo:l,cache:new Map};if(B.has(_)){const h=B.get(_);return h.push(p),h.length-1}return B.set(_,[p]),0}function d(_,l){if(B.has(_)){const p=B.get(_);p[l]=null,p.some(h=>null!=h)||B.delete(_)}}function c(_,l,p){if(!B.has(_))return null==l?m.decreaseRefCount(_,p):0;const h=B.get(_);if(null==h[l])return m.decreaseRefCount(_,p);const L=h[l].cache;if(L.has(p)){const g=L.get(p);if(g.refCount--,0===g.refCount){L.delete(p);for(let W=0;W<h.length;W++)h[W]&&h[W].cache.has(p)&&h[W].cache.delete(p);g.controller&&g.controller.abort()}return g.refCount}return 0}function P(_,l,p){if(!B.has(_))return null==l?m.getBlock(_,p):null;const h=B.get(_);if(null==h[l]){for(let g=0;g<h.length;g++)if(h[g]&&h[g].cache.has(p)){const W=h[g].cache.get(p);return W.refCount++,W.block}return m.getBlock(_,p)}const L=h[l].cache;if(L.has(p)){const g=L.get(p);return g.refCount++,g.block}for(let g=0;g<h.length;g++)if(g!==l&&h[g]&&h[g]&&h[g].cache.has(p)){const W=h[g].cache.get(p);return W.refCount++,L.set(p,W),W.block}return null}function a(_,l,p,h,L=null){if(!B.has(_))return void(null==l&&m.putBlock(_,p,h,L));const g=B.get(_);if(null==g[l])return void m.putBlock(_,p,h,L);const W={refCount:1,block:h,isResolved:!1,isRejected:!1,controller:L};h.then(()=>W.isResolved=!0).catch(()=>W.isRejected=!0),g[l].cache.set(p,W)}function o(_,l,p){if(!B.has(_))return void(null==l&&m.deleteBlock(_,p));const h=B.get(_);null!=h[l]?h[l].cache.delete(p):m.deleteBlock(_,p)}function O(_,l,p,h,L,g,W=null){const F=function(_,l){if(!B.has(_))return null;const p=B.get(_);return null==p[l]?null:p[l]}(_,l),A=F.extent,{cache:b,rasterInfo:J}=F;if(A&&A.xmin===p.xmin&&A.xmax===p.xmax&&A.ymin===p.ymin&&A.ymax===p.ymax)return;const M=p.clone().normalize(),{spatialReference:j,transform:G}=J,K=new Set;for(let w=0;w<M.length;w++){const $=M[w];if($.xmax-$.xmin<=h||$.ymax-$.ymin<=h)continue;let I=(0,y.tB)($,j,W);(0,v.pC)(G)&&(I=G.inverseTransform(I));const Z=new D.Z({x:h,y:h,spatialReference:$.spatialReference});if(null==L&&!(L=(0,y.VO)(Z,j,$,W)))return;const{pyramidLevel:N,pyramidResolution:R,excessiveReading:z}=(0,y.kr)(L,J,g||"closest");if(z)return;const{storageInfo:T}=J,{origin:x}=T,U={x:Math.max(0,Math.floor((I.xmin-x.x)/R.x)),y:Math.max(0,Math.floor((x.y-I.ymax)/R.y))},H=Math.ceil((I.xmax-I.xmin)/R.x-.1),k=Math.ceil((I.ymax-I.ymin)/R.y-.1),X=N>0?T.pyramidBlockWidth:T.blockWidth,Y=N>0?T.pyramidBlockHeight:T.blockHeight,Q=1,q=Math.max(0,Math.floor(U.x/X)-Q),se=Math.max(0,Math.floor(U.y/Y)-Q),oe=Math.floor((U.x+H-1)/X)+Q,ne=Math.floor((U.y+k-1)/Y)+Q;for(let le=se;le<=ne;le++)for(let re=q;re<=oe;re++)K.add(`${N}/${le}/${re}`)}b.forEach((w,$)=>{if(!K.has($)){const I=b.get($);(null==I||I.isResolved||I.isRejected)&&b.delete($)}}),F.extent={xmin:p.xmin,ymin:p.ymin,xmax:p.xmax,ymax:p.ymax}}},26655:(ee,V,t)=>{t.d(V,{Z:()=>S});var s=t(79076),v=t(41147),C=t(94911),m=(t(45072),t(30627),t(55865),t(96410));let u=class extends v.wq{get affectsPixelSize(){return!1}forwardTransform(d){return d}inverseTransform(d){return d}};(0,s._)([(0,C.Cb)()],u.prototype,"affectsPixelSize",null),(0,s._)([(0,C.Cb)({json:{write:!0}})],u.prototype,"spatialReference",void 0),u=(0,s._)([(0,m.j)("esri.layers.support.rasterTransforms.BaseRasterTransform")],u);const S=u},91646:(ee,V,t)=>{t.d(V,{Z:()=>d});var s=t(79076),v=t(94911),B=(t(45072),t(30627),t(55865),t(73358)),m=t(96410),u=t(26655);let S=class extends u.Z{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(n){return"point"===(n=n.clone()).type?(n.x>180+this.tolerance&&(n.x-=360),n):(n.xmin>=180-this.tolerance?(n.xmax-=360,n.xmin-=360):n.xmax>180+this.tolerance&&(n.xmin=-180,n.xmax=180),n)}inverseTransform(n){return"point"===(n=n.clone()).type?(n.x<-this.tolerance&&(n.x+=360),n):(n.xmin<-this.tolerance&&(n.xmin+=360,n.xmax+=360),n)}};(0,s._)([(0,B.J)({GCSShiftXform:"gcs-shift"})],S.prototype,"type",void 0),(0,s._)([(0,v.Cb)()],S.prototype,"tolerance",void 0),S=(0,s._)([(0,m.j)("esri.layers.support.rasterTransforms.GCSShiftTransform")],S);const d=S},66294:(ee,V,t)=>{t.d(V,{Z:()=>_});var s=t(79076),C=(t(61243),t(94911)),m=(t(45072),t(30627),t(55865),t(73358)),u=t(38650),S=t(96410),d=t(88445),n=t(26655),c=t(36262),P=t(70157);function a(l,p,h){const{x:L,y:g}=p;if(h<2)return{x:l[0]+L*l[2]+g*l[4],y:l[1]+L*l[3]+g*l[5]};if(2===h){const G=L*L,K=g*g,w=L*g;return{x:l[0]+L*l[2]+g*l[4]+G*l[6]+w*l[8]+K*l[10],y:l[1]+L*l[3]+g*l[5]+G*l[7]+w*l[9]+K*l[11]}}const W=L*L,F=g*g,A=L*g,b=W*L,J=W*g,M=L*F,j=g*F;return{x:l[0]+L*l[2]+g*l[4]+W*l[6]+A*l[8]+F*l[10]+b*l[12]+J*l[14]+M*l[16]+j*l[18],y:l[1]+L*l[3]+g*l[5]+W*l[7]+A*l[9]+F*l[11]+b*l[13]+J*l[15]+M*l[17]+j*l[19]}}function o(l,p,h){const{xmin:L,ymin:g,xmax:W,ymax:F,spatialReference:A}=p;let b=[];if(h<2)b.push({x:L,y:F}),b.push({x:W,y:F}),b.push({x:L,y:g}),b.push({x:W,y:g});else{let j=10;for(let G=0;G<j;G++)b.push({x:L,y:g+(F-g)*G/(j-1)}),b.push({x:W,y:g+(F-g)*G/(j-1)});j=8;for(let G=1;G<=j;G++)b.push({x:L+(W-L)*G/j,y:g}),b.push({x:L+(W-L)*G/j,y:F})}b=b.map(j=>a(l,j,h));const J=b.map(j=>j.x),M=b.map(j=>j.y);return new P.Z({xmin:Math.min.apply(null,J),xmax:Math.max.apply(null,J),ymin:Math.min.apply(null,M),ymax:Math.max.apply(null,M),spatialReference:A})}let O=class extends n.Z{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(l,p){const{coeffX:h,coeffY:L}=p;if(null==h||!h.length||null==L||!L.length||h.length!==L.length)return null;const g=[];for(let W=0;W<h.length;W++)g.push(h[W]),g.push(L[W]);return g}writeForwardCoefficients(l,p,h){const L=[],g=[];for(let W=0;W<(null==l?void 0:l.length);W++)W%2==0?L.push(l[W]):g.push(l[W]);p.coeffX=L,p.coeffY=g}get inverseCoefficients(){let l=this._get("inverseCoefficients");const p=this._get("forwardCoefficients");return!l&&p&&this.polynomialOrder<2&&(l=function(l){const[p,h,L,g,W,F]=l,A=L*F-W*g,b=W*g-L*F;return[(W*h-p*F)/A,(L*h-p*g)/b,F/A,g/b,-W/A,-L/b]}(p)),l}set inverseCoefficients(l){this._set("inverseCoefficients",l)}readInverseCoefficients(l,p){const{inverseCoeffX:h,inverseCoeffY:L}=p;if(null==h||!h.length||null==L||!L.length||h.length!==L.length)return null;const g=[];for(let W=0;W<h.length;W++)g.push(h[W]),g.push(L[W]);return g}writeInverseCoefficients(l,p,h){const L=[],g=[];for(let W=0;W<(null==l?void 0:l.length);W++)W%2==0?L.push(l[W]):g.push(l[W]);p.inverseCoeffX=L,p.inverseCoeffY=g}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(l){if("point"===l.type){const p=a(this.forwardCoefficients,l,this.polynomialOrder);return new c.Z({x:p.x,y:p.y,spatialReference:l.spatialReference})}return o(this.forwardCoefficients,l,this.polynomialOrder)}inverseTransform(l){if("point"===l.type){const p=a(this.inverseCoefficients,l,this.polynomialOrder);return new c.Z({x:p.x,y:p.y,spatialReference:l.spatialReference})}return o(this.inverseCoefficients,l,this.polynomialOrder)}};(0,s._)([(0,C.Cb)({json:{write:!0}})],O.prototype,"polynomialOrder",void 0),(0,s._)([(0,C.Cb)()],O.prototype,"forwardCoefficients",void 0),(0,s._)([(0,u.r)("forwardCoefficients",["coeffX","coeffY"])],O.prototype,"readForwardCoefficients",null),(0,s._)([(0,d.c)("forwardCoefficients")],O.prototype,"writeForwardCoefficients",null),(0,s._)([(0,C.Cb)({json:{write:!0}})],O.prototype,"inverseCoefficients",null),(0,s._)([(0,u.r)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],O.prototype,"readInverseCoefficients",null),(0,s._)([(0,d.c)("inverseCoefficients")],O.prototype,"writeInverseCoefficients",null),(0,s._)([(0,C.Cb)()],O.prototype,"affectsPixelSize",null),(0,s._)([(0,m.J)({PolynomialXform:"polynomial"})],O.prototype,"type",void 0),O=(0,s._)([(0,S.j)("esri.layers.support.rasterTransforms.PolynomialTransform")],O);const _=O},36170:(ee,V,t)=>{t.d(V,{j:()=>E,c:()=>O});var s=t(91646),v=t(79076),u=(t(22345),t(55865),t(45072),t(30627),t(72062),t(73358)),S=t(96410),d=t(26655);let n=class extends d.Z{constructor(){super(...arguments),this.type="identity"}};(0,v._)([(0,u.J)({IdentityXform:"identity"})],n.prototype,"type",void 0),n=(0,v._)([(0,S.j)("esri.layers.support.rasterTransforms.IdentityTransform")],n);const c=n;var P=t(66294);const a={GCSShiftXform:s.Z,IdentityXform:c,PolynomialXform:P.Z},o=Object.keys(a);function E(_){const l=null==_?void 0:_.type;return!_||o.includes(l)}function O(_){if(!(null==_?void 0:_.type))return null;const l=a[null==_?void 0:_.type];if(l){const p=new l;return p.read(_),p}return null}},57275:(ee,V,t)=>{t.d(V,{d:()=>C,h:()=>v});var s=t(87940);const v={type:s.Z,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:C}}}}};function C(y,D,B,m){if(!y)return null;const{minScale:u,maxScale:S,minLOD:d,maxLOD:n}=D;if(null!=d&&null!=n)return m&&m.ignoreMinMaxLOD?s.Z.fromJSON(y):s.Z.fromJSON(ae(te({},y),{lods:y.lods.filter(({level:c})=>null!=c&&c>=d&&c<=n)}));if(0!==u&&0!==S){const c=o=>Math.round(1e4*o)/1e4,P=u?c(u):1/0,a=S?c(S):-1/0;return s.Z.fromJSON(ae(te({},y),{lods:y.lods.filter(o=>{const E=c(o.scale);return E<=P&&E>=a})}))}return s.Z.fromJSON(y)}},19265:(ee,V,t)=>{t.d(V,{Z:()=>E});var n,s=t(79076),v=t(60161),C=t(94911),y=t(55865),D=t(73358),B=t(96410),m=t(46796),u=t(12150),S=t(28503),d=t(41147);let c=n=class extends d.wq{constructor(){super(...arguments),this.description=null,this.label=null,this.minValue=0,this.maxValue=0,this.color=null}clone(){return new n({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:(0,v.d9)(this.color)})}};(0,s._)([(0,C.Cb)({type:String,json:{write:!0}})],c.prototype,"description",void 0),(0,s._)([(0,C.Cb)({type:String,json:{write:!0}})],c.prototype,"label",void 0),(0,s._)([(0,C.Cb)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],c.prototype,"minValue",void 0),(0,s._)([(0,C.Cb)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],c.prototype,"maxValue",void 0),(0,s._)([(0,C.Cb)({type:S.Z,json:{type:[y.z8],write:!0}})],c.prototype,"color",void 0),c=n=(0,s._)([(0,B.j)("esri.renderers.support.pointCloud.ColorClassBreakInfo")],c);const P=c;var a;let o=a=class extends m.Z{constructor(O){super(O),this.type="point-cloud-class-breaks",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.colorClassBreakInfos=null}clone(){return new a(ae(te({},this.cloneProperties()),{field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:(0,v.d9)(this.colorClassBreakInfos),legendOptions:(0,v.d9)(this.legendOptions)}))}};(0,s._)([(0,D.J)({pointCloudClassBreaksRenderer:"point-cloud-class-breaks"})],o.prototype,"type",void 0),(0,s._)([(0,C.Cb)({json:{write:!0},type:String})],o.prototype,"field",void 0),(0,s._)([(0,C.Cb)({type:u.Z,json:{write:!0}})],o.prototype,"legendOptions",void 0),(0,s._)([(0,C.Cb)({type:m.Z.fieldTransformTypeKebabDict.apiValues,json:{type:m.Z.fieldTransformTypeKebabDict.jsonValues,read:m.Z.fieldTransformTypeKebabDict.read,write:m.Z.fieldTransformTypeKebabDict.write}})],o.prototype,"fieldTransformType",void 0),(0,s._)([(0,C.Cb)({type:[P],json:{write:!0}})],o.prototype,"colorClassBreakInfos",void 0),o=a=(0,s._)([(0,B.j)("esri.renderers.PointCloudClassBreaksRenderer")],o);const E=o},46796:(ee,V,t)=>{t.d(V,{Z:()=>A});var d,s=t(79076),v=t(74856),C=t(41147),y=t(60161),D=t(94911),m=(t(55865),t(96410));t(45072),t(30627);let n=d=class extends C.wq{constructor(){super(...arguments),this.field=null,this.minValue=0,this.maxValue=255}clone(){return new d({field:this.field,minValue:this.minValue,maxValue:this.maxValue})}};(0,s._)([(0,D.Cb)({type:String,json:{write:!0}})],n.prototype,"field",void 0),(0,s._)([(0,D.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],n.prototype,"minValue",void 0),(0,s._)([(0,D.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],n.prototype,"maxValue",void 0),n=d=(0,s._)([(0,m.j)("esri.renderers.support.pointCloud.ColorModulation")],n);const c=n,P=new v.Xn({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});let a=class extends C.wq{};(0,s._)([(0,D.Cb)({type:P.apiValues,readOnly:!0,nonNullable:!0,json:{type:P.jsonValues,read:!1,write:P.write}})],a.prototype,"type",void 0),a=(0,s._)([(0,m.j)("esri.renderers.support.pointCloud.PointSizeAlgorithm")],a);const o=a;var O,E=t(73358);let _=O=class extends o{constructor(){super(...arguments),this.type="fixed-size",this.size=0,this.useRealWorldSymbolSizes=null}clone(){return new O({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})}};(0,s._)([(0,E.J)({pointCloudFixedSizeAlgorithm:"fixed-size"})],_.prototype,"type",void 0),(0,s._)([(0,D.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],_.prototype,"size",void 0),(0,s._)([(0,D.Cb)({type:Boolean,json:{write:!0}})],_.prototype,"useRealWorldSymbolSizes",void 0),_=O=(0,s._)([(0,m.j)("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],_);const l=_;var p;let h=p=class extends o{constructor(){super(...arguments),this.type="splat",this.scaleFactor=1}clone(){return new p({scaleFactor:this.scaleFactor})}};(0,s._)([(0,E.J)({pointCloudSplatAlgorithm:"splat"})],h.prototype,"type",void 0),(0,s._)([(0,D.Cb)({type:Number,value:1,nonNullable:!0,json:{write:!0}})],h.prototype,"scaleFactor",void 0),h=p=(0,s._)([(0,m.j)("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],h);const g={key:"type",base:o,typeMap:{"fixed-size":l,splat:h}},W=(0,v.wY)()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"});let F=class extends C.wq{constructor(b){super(b),this.type=void 0,this.pointSizeAlgorithm=null,this.colorModulation=null,this.pointsPerInch=10}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}cloneProperties(){return{pointSizeAlgorithm:(0,y.d9)(this.pointSizeAlgorithm),colorModulation:(0,y.d9)(this.colorModulation),pointsPerInch:(0,y.d9)(this.pointsPerInch)}}};(0,s._)([(0,D.Cb)({type:W.apiValues,readOnly:!0,nonNullable:!0,json:{type:W.jsonValues,read:!1,write:W.write}})],F.prototype,"type",void 0),(0,s._)([(0,D.Cb)({types:g,json:{write:!0}})],F.prototype,"pointSizeAlgorithm",void 0),(0,s._)([(0,D.Cb)({type:c,json:{write:!0}})],F.prototype,"colorModulation",void 0),(0,s._)([(0,D.Cb)({json:{write:!0},nonNullable:!0,type:Number})],F.prototype,"pointsPerInch",void 0),F=(0,s._)([(0,m.j)("esri.renderers.PointCloudRenderer")],F),(F||(F={})).fieldTransformTypeKebabDict=new v.Xn({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"});const A=F},67886:(ee,V,t)=>{t.d(V,{Z:()=>c});var d,s=t(79076),v=t(60161),C=t(94911),D=(t(55865),t(73358)),B=t(96410),m=t(46796),u=t(12150),S=t(26093);let n=d=class extends m.Z{constructor(P){super(P),this.type="point-cloud-stretch",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.stops=null}clone(){return new d(ae(te({},this.cloneProperties()),{field:(0,v.d9)(this.field),fieldTransformType:(0,v.d9)(this.fieldTransformType),stops:(0,v.d9)(this.stops),legendOptions:(0,v.d9)(this.legendOptions)}))}};(0,s._)([(0,D.J)({pointCloudStretchRenderer:"point-cloud-stretch"})],n.prototype,"type",void 0),(0,s._)([(0,C.Cb)({json:{write:!0},type:String})],n.prototype,"field",void 0),(0,s._)([(0,C.Cb)({type:u.Z,json:{write:!0}})],n.prototype,"legendOptions",void 0),(0,s._)([(0,C.Cb)({type:m.Z.fieldTransformTypeKebabDict.apiValues,json:{type:m.Z.fieldTransformTypeKebabDict.jsonValues,read:m.Z.fieldTransformTypeKebabDict.read,write:m.Z.fieldTransformTypeKebabDict.write}})],n.prototype,"fieldTransformType",void 0),(0,s._)([(0,C.Cb)({type:[S.Z],json:{write:!0}})],n.prototype,"stops",void 0),n=d=(0,s._)([(0,B.j)("esri.renderers.PointCloudStretchRenderer")],n);const c=n},16979:(ee,V,t)=>{t.d(V,{Z:()=>E});var n,s=t(79076),v=t(60161),C=t(94911),y=t(55865),D=t(73358),B=t(96410),m=t(46796),u=t(12150),S=t(28503),d=t(41147);let c=n=class extends d.wq{constructor(){super(...arguments),this.description=null,this.label=null,this.values=null,this.color=null}clone(){return new n({description:this.description,label:this.label,values:(0,v.d9)(this.values),color:(0,v.d9)(this.color)})}};(0,s._)([(0,C.Cb)({type:String,json:{write:!0}})],c.prototype,"description",void 0),(0,s._)([(0,C.Cb)({type:String,json:{write:!0}})],c.prototype,"label",void 0),(0,s._)([(0,C.Cb)({type:[String],json:{write:!0}})],c.prototype,"values",void 0),(0,s._)([(0,C.Cb)({type:S.Z,json:{type:[y.z8],write:!0}})],c.prototype,"color",void 0),c=n=(0,s._)([(0,B.j)("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],c);const P=c;var a;let o=a=class extends m.Z{constructor(O){super(O),this.type="point-cloud-unique-value",this.field=null,this.fieldTransformType=null,this.colorUniqueValueInfos=null,this.legendOptions=null}clone(){return new a(ae(te({},this.cloneProperties()),{field:(0,v.d9)(this.field),fieldTransformType:(0,v.d9)(this.fieldTransformType),colorUniqueValueInfos:(0,v.d9)(this.colorUniqueValueInfos),legendOptions:(0,v.d9)(this.legendOptions)}))}};(0,s._)([(0,D.J)({pointCloudUniqueValueRenderer:"point-cloud-unique-value"})],o.prototype,"type",void 0),(0,s._)([(0,C.Cb)({json:{write:!0},type:String})],o.prototype,"field",void 0),(0,s._)([(0,C.Cb)({type:m.Z.fieldTransformTypeKebabDict.apiValues,json:{type:m.Z.fieldTransformTypeKebabDict.jsonValues,read:m.Z.fieldTransformTypeKebabDict.read,write:m.Z.fieldTransformTypeKebabDict.write}})],o.prototype,"fieldTransformType",void 0),(0,s._)([(0,C.Cb)({type:[P],json:{write:!0}})],o.prototype,"colorUniqueValueInfos",void 0),(0,s._)([(0,C.Cb)({type:u.Z,json:{write:!0}})],o.prototype,"legendOptions",void 0),o=a=(0,s._)([(0,B.j)("esri.renderers.PointCloudUniqueValueRenderer")],o);const E=o},39115:(ee,V,t)=>{t.d(V,{QM:()=>y,hy:()=>D,uI:()=>v});var s=t(88415);const v=(()=>{if(!("document"in globalThis))return()=>null;const d=document.createElement("canvas"),n=d.getContext("2d");return d.height=512,d.width=1,P=>{n.clearRect(0,0,1,d.height);const a=n.createLinearGradient(0,0,0,d.height);for(const{ratio:o,color:E}of P.colorStops)a.addColorStop(Math.max(o,.001),`rgba(${E[0]}, ${E[1]}, ${E[2]}, ${E[3]})`);return n.fillStyle=a,n.fillRect(0,0,1,d.height),n.getImageData(0,0,1,d.height).data}})();function y(d,n,c,P){const{blurRadius:a,fieldOffset:o,field:E}=n,O=new Float64Array(c*P),_=m(a),l=Math.round(3*a);let p,h=Number.NEGATIVE_INFINITY;const L=function(d,n){return null!=d?"string"==typeof n?c=>-1*+c.readAttribute(d):c=>+c.readAttribute(d)+n:c=>1}(E,o),g=new Set;for(const W of d){const F=W.getCursor();for(;F.next();){const A=F.getObjectId();if(g.has(A))continue;g.add(A);const b=F.readLegacyPointGeometry(),J=128;if(b.x<-J||b.x>=c+J||b.y<-J||b.y>P+J)continue;const M=+L(F),j=Math.round(b.x)-l,G=Math.round(b.y)-l,K=Math.max(0,j),w=Math.max(0,G),$=Math.min(P,Math.round(b.y)+l),I=Math.min(c,Math.round(b.x)+l);for(let Z=w;Z<$;Z++){const N=_[Z-G];for(let R=K;R<I;R++){const z=_[R-j];p=O[Z*c+R]+=N*z*M,p>h&&(h=p)}}}}return{matrix:O.buffer,max:h}}function D(d,n,c,P,a,o){d.canvas.width=d.canvas.height=n,d.clearRect(0,0,n,n);const E=d.getImageData(0,0,n,n);c&&P&&E.data.set(new Uint8ClampedArray(function(d,n,c,P,a){const o=new Uint32Array(d*d),E="buffer"in n?n:new Float64Array(n),O="buffer"in c?new Uint32Array(c.buffer):new Uint32Array(new Uint8Array(c).buffer),_=O.length/(a-P);for(let l=0;l<E.length;l++){const p=E[l],h=Math.floor((p-P)*_);o[l]=O[(0,s.uZ)(h,0,O.length-1)]}return o.buffer}(n,c,P,a,o))),d.putImageData(E,0,0)}function m(d){const n=Math.round(3*d),c=2*d*d,P=new Float64Array(2*n+1);for(let a=0;a<=P.length;a++)P[a]=Math.exp(-Oe(a-n,2)/c)/Math.sqrt(2*Math.PI)*(d/2);return P}},55481:(ee,V,t)=>{t.d(V,{t:()=>C});var s=t(49996),v=t(30351);function C(D,B){return y.apply(this,arguments)}function y(){return(y=(0,s.Z)(function*(D,B){const{data:m}=yield(0,v.default)(D,te({responseType:"image"},B));return m})).apply(this,arguments)}},20655:(ee,V,t)=>{t.d(V,{Z:()=>B});var s=t(14915),v=t(49198),C=t(51256),y=t(56314);class B{constructor(u){this._resourceManager=u}dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(u,S,d){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===u.type||"esriSFS"===u.type){const[l,p,h]=s.fN.rasterizeSimpleFill(this._rasterizationCanvas,u.style,S);return{size:[p,h],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===u.type||"esriSLS"===u.type||"line"===u.type&&u.dashTemplate){let l,p;if("simple-line"===u.type||"esriSLS"===u.type)switch(l=(0,s.U1)(u.style,u.cap),u.cap){case"butt":p="Butt";break;case"square":p="Square";break;default:p="Round"}else l=u.dashTemplate,p=u.cim.capStyle;const[h,L,g]=s.fN.rasterizeSimpleLine(l,p);return{size:[L,g],image:new Uint32Array(h.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let n,c,P;if("simple-marker"===u.type||"esriSMS"===u.type||"line-marker"===u.type?(n=s.B$.fromSimpleMarker(u),P=(0,C.Fp)(n)):u.cim&&"CIMHatchFill"===u.cim.type?(n=s.B$.fromCIMHatchFill(u.cim),c=new v.Z(n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):u.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===u.cim.markerPlacement.type?(n=s.B$.fromCIMInsidePolygon(u.cim),c=new v.Z(n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):(n=u.cim,P=(0,C.Fp)(n)),P&&!d){const[l,p,h]=(0,C.RL)(P);return l?{size:[p,h],image:new Uint32Array(l.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[a,o,E,O,_]=s.B$.rasterize(this._rasterizationCanvas,n,c,this._resourceManager,!d);return a?{size:[o,E],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:O,anchorY:_}:null}rasterizeImageResource(u,S,d,n){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=u,this._rasterizationCanvas.height=S;const c=this._rasterizationCanvas.getContext("2d");d instanceof ImageData?c.putImageData(d,0,0):(d.setAttribute("width",`${u}px`),d.setAttribute("height",`${S}px`),c.drawImage(d,0,0,u,S));const P=c.getImageData(0,0,u,S),a=new Uint8Array(P.data);if(n)for(const p of n)if(p&&p.oldColor&&4===p.oldColor.length&&p.newColor&&4===p.newColor.length){const[h,L,g,W]=p.oldColor,[F,A,b,J]=p.newColor;if(h===F&&L===A&&g===b&&W===J)continue;for(let M=0;M<a.length;M+=4)h===a[M]&&L===a[M+1]&&g===a[M+2]&&W===a[M+3]&&(a[M]=F,a[M+1]=A,a[M+2]=b,a[M+3]=J)}let o;for(let p=0;p<a.length;p+=4)o=a[p+3]/255,a[p]=a[p]*o,a[p+1]=a[p+1]*o,a[p+2]=a[p+2]*o;let E=a,O=u,_=S;const l=512;if(O>=l||_>=l){const p=O/_;p>1?(O=l,_=Math.round(l/p)):(_=l,O=Math.round(l*p)),E=new Uint8Array(4*O*_);const h=new Uint8ClampedArray(E.buffer);(0,y.TT)(a,u,S,h,O,_,!1)}return{size:[O,_],image:new Uint32Array(E.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}},3512:(ee,V,t)=>{t.r(V),t.d(V,{fetchSymbolFromStyle:()=>c,resolveWebStyleSymbol:()=>n});var s=t(85700),v=t(56648),C=t(61414),y=t(30164),D=t(70658),B=t(26912),m=t(21202),u=t(76853),S=t(80415),d=t(98666);function n(a,o,E,O){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?function(a,o,E){const O=S.wm.replace(/\{SymbolName\}/gi,a.name);return(0,S.EJ)(O,E).then(_=>{const l=(0,S.KV)(_.data);return(0,m.i)(l,{portal:o.portal,url:(0,y.mN)((0,y.Yd)(O)),origin:"portal-item"})})}(a,o,O):(0,S.n2)(a,o,O).then(_=>c(_,a.name,o,E,O)):Promise.reject(new C.Z("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function c(a,o,E,O,_){const l=a.data,p={portal:E&&E.portal||D.Z.getDefault(),url:(0,y.mN)(a.baseUrl),origin:"portal-item"},h=l.items.find(A=>A.name===o);if(!h){const A=`The symbol name '${o}' could not be found`;return Promise.reject(new C.Z("symbolstyleutils:symbol-name-not-found",A,{symbolName:o}))}let L=(0,B.f)((0,S.v9)(h,O),p),g=h.thumbnail&&h.thumbnail.href;const W=h.thumbnail&&h.thumbnail.imageData;(0,v.XO)()&&(L=(0,v.pJ)(L),g=(0,v.pJ)(g));const F={portal:E.portal,url:(0,y.mN)((0,y.Yd)(L)),origin:"portal-item"};return(0,S.EJ)(L,_).then(A=>{const b="cimRef"===O?(0,S.KV)(A.data):A.data,J=(0,m.i)(b,F);if(J&&(0,s.dU)(J)){if(g){const M=(0,B.f)(g,p);J.thumbnail=new d.Z({url:M})}else W&&(J.thumbnail=new d.Z({url:`data:image/png;base64,${W}`}));a.styleUrl?J.styleOrigin=new u.Z({portal:E.portal,styleUrl:a.styleUrl,name:o}):a.styleName&&(J.styleOrigin=new u.Z({portal:E.portal,styleName:a.styleName,name:o}))}return J})}},44946:(ee,V,t)=>{t.d(V,{eY:()=>c});var s=t(18502),v=t(72425),C=t(87266),y=t(74181),D=t(17821),B=t(89001),m=t(36079);function n(P,a,o){const E={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return a&&o&&(E.width=a,E.height=o),new m.Z(P,E)}class c extends D.s{constructor(a=null,o,E=!0){super(),this.requestRenderOnSourceChangedEnabled=E,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=o,this.source=a,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(a){this._height=a}get source(){return this._source}set source(a){this._source=a,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(a){this._width=a}beforeRender(a){super.beforeRender(a),this.updateTexture(a.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:(0,C.c)()}}setTransform(a){const o=(0,v.b)(this.transforms.dvs),[E,O]=a.toScreenNoRotation([0,0],[this.x,this.y]),_=this.resolution/this.pixelRatio/a.resolution,l=_*this.width,p=_*this.height,h=Math.PI*this.rotation/180;(0,v.c)(o,o,(0,y.f)(E,O)),(0,v.c)(o,o,(0,y.f)(l/2,p/2)),(0,v.r)(o,o,-h),(0,v.c)(o,o,(0,y.f)(-l/2,-p/2)),(0,v.j)(o,o,(0,y.f)(l,p)),(0,v.m)(this.transforms.dvs,a.displayViewMat3,o)}setSamplingProfile(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))}bind(a,o){this._texture&&a.bindTexture(this._texture,o)}updateTexture(a){var o;if(!this.stage)return null==(o=this._texture)||o.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=n(a,this.sourceWidth,this.sourceHeight):this._texture=n(a));const E=this.source;if(E){if(this._texture.resize(this.sourceWidth,this.sourceHeight),(P=E)&&"render"in P)if(E instanceof B.Z){const O=E.getRenderedRasterPixels();this._texture.setData((0,s.pC)(O)?O.renderedRasterPixels:null)}else this._texture.setData(function(P){const a=document.createElement("canvas");return a.width=P.width,a.height=P.height,P.render(a.getContext("2d")),a}(E));else(function(P){return P&&!("render"in P)})(E)&&this._texture.setData(E);this.ready()}else this._texture.setData(null);var P}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},23335:(ee,V,t)=>{t.d(V,{c:()=>y});var s=t(67495),v=t(31620),C=t(84700);class y extends C.Z{get requiresDedicatedFBO(){return this.children.some(B=>"additive"===B.blendFunction)}prepareRenderPasses(B){const m=B.registerRenderPass({name:"bitmap",brushes:[s.U.bitmap],target:()=>this.children,drawPhase:v.jx.MAP});return[...super.prepareRenderPasses(B),m]}}},99306:(ee,V,t)=>{t.d(V,{s:()=>S});var s=t(7401),v=t(87266),C=t(44946),y=t(62561);class D extends y.I{constructor(n,c,P,a,o,E=null){super(n,c,P,a,o),this.bitmap=new C.eY(E,"standard",!1),this.bitmap.coordScale=[a,o],this.bitmap.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.bitmap.destroy()}beforeRender(n){super.beforeRender(n),this.bitmap.beforeRender(n)}afterRender(n){super.afterRender(n),this.bitmap.afterRender(n)}set stencilRef(n){this.bitmap.stencilRef=n}get stencilRef(){return this.bitmap.stencilRef}_createTransforms(){return{dvs:(0,v.c)(),tileMat3:(0,v.c)()}}setTransform(n,c){super.setTransform(n,c),this.bitmap.transforms.dvs=this.transforms.dvs}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap&&(this.bitmap.stage=null)}}var B=t(67495),m=t(31620),u=t(62642);class S extends u.Z{get requiresDedicatedFBO(){return this.children.some(n=>"additive"===n.bitmap.blendFunction)}createTile(n){const c=this._tileInfoView.getTileBounds((0,s.Ue)(),n),[P,a]=this._tileInfoView.tileInfo.size;return new D(n,c[0],c[3],P,a)}destroyTile(){}prepareRenderPasses(n){const c=n.registerRenderPass({name:"bitmap (tile)",brushes:[B.U.bitmap],target:()=>this.children.map(P=>P.bitmap),drawPhase:m.jx.MAP});return[...super.prepareRenderPasses(n),c]}doRender(n){this.visible&&n.drawPhase===m.jx.MAP&&super.doRender(n)}}},89001:(ee,V,t)=>{t.d(V,{Z:()=>v});var s=t(18502);class v{constructor(y,D,B){this.pixelBlock=y,this.extent=D,this.originalPixelBlock=B}get width(){return(0,s.pC)(this.pixelBlock)?this.pixelBlock.width:0}get height(){return(0,s.pC)(this.pixelBlock)?this.pixelBlock.height:0}render(y){const D=this.pixelBlock;if((0,s.Wi)(D))return;const B=this.filter({pixelBlock:D});if((0,s.Wi)(B.pixelBlock))return;const m=B.pixelBlock.getAsRGBA(),u=y.createImageData(B.pixelBlock.width,B.pixelBlock.height);u.data.set(m),y.putImageData(u,0,0)}getRenderedRasterPixels(){const y=this.filter({pixelBlock:this.pixelBlock});return(0,s.Wi)(y.pixelBlock)?null:{width:y.pixelBlock.width,height:y.pixelBlock.height,renderedRasterPixels:new Uint8Array(y.pixelBlock.getAsRGBA().buffer)}}}},98101:(ee,V,t)=>{t.d(V,{Z:()=>k});var s=t(49996),v=t(79076),C=t(6897),y=t(94911),u=(t(45072),t(30627),t(55865),t(96410)),S=t(62013),d=t(21217),n=t(31620),c=t(84700);class P extends c.Z{constructor(){super(...arguments),this.flowStyle=null}get requiresDedicatedFBO(){return!1}doRender(Y){super.doRender(Y)}prepareRenderPasses(Y){const Q=Y.registerRenderPass({name:"flow",brushes:[d.Z],target:()=>this.children,drawPhase:n.jx.MAP});return[...super.prepareRenderPasses(Y),Q]}}t(61243);var o=t(22345),E=t(88415),O=t(18502),_=t(7808),l=t(36262);const p=o.Z.getLogger("esri.views.2d.engine.flow.FlowDisplayData");class h{constructor(Y,Q,q,se){this.state={name:"created"},this.flowStyle=Y,this.extent=Q,this.size=q,this.pixelRatio=se}load(){var Y=this;return(0,s.Z)(function*(){const Q=new AbortController;Y.state={name:"loading",abortController:Q};const q=yield Y.flowStyle.loadResources({extent:Y.extent,size:Y.size,pixelRatio:Y.pixelRatio},Q.signal);Y.state={name:"loaded",resources:q}})()}prepareForRendering(Y,Q,q){if("loaded"!==this.state.name)return void p.error("Only loaded resources can be attached.");const se=this.state.resources;se.prepareForRendering(Y,Q,q),this.state={name:"attached",resources:se}}destroy(){if("loading"===this.state.name)return this.state.abortController.abort(),void(this.state={name:"detached"});"attached"===this.state.name&&(this.state.resources.detach(),this.state={name:"detached"})}update(Y){return!!this.flowStyle.areResourcesCompatible(Y.flowStyle)&&!(!this.extent.equals(Y.extent)||this.size[0]!==Y.size[0]||this.size[1]!==Y.size[1]||this.pixelRatio!==Y.pixelRatio||(this.flowStyle=Y.flowStyle,0))}}var L=t(72425),g=t(87266),W=t(17821);class F extends W.s{constructor(){super(...arguments),this._displayData=null}get displayData(){return this._displayData}set displayData(Y){this._displayData=Y,this.requestRender()}clear(){(0,O.pC)(this._displayData)&&(this._displayData.destroy(),this._displayData=null,this.requestRender())}setTransform(Y){const{displayData:Q}=this;if((0,O.Wi)(Q))return;const q=Q.extent.xmin,se=Q.extent.ymax,oe=[0,0];Y.toScreen(oe,[q,se]);const ne=(Q.extent.xmax-Q.extent.xmin)/Q.size[0]/Y.resolution,le=(0,E.Vl)(Y.rotation),{dvs:re}=this.transforms;(0,L.b)(re),(0,L.c)(re,re,[-1,1,0]),(0,L.d)(re,re,[2/(Y.size[0]*Y.pixelRatio),-2/(Y.size[1]*Y.pixelRatio),1]),(0,L.c)(re,re,[oe[0],oe[1],0]),(0,L.r)(re,re,le),(0,L.d)(re,re,[ne*Y.pixelRatio,ne*Y.pixelRatio,1])}_createTransforms(){return{dvs:(0,g.c)()}}}var A=t(70157);const J=o.Z.getLogger("esri.views.2d.engine.flow.FlowStrategy");let M=class extends C.Z{constructor(X){super(X),this._flowDisplayObject=new F,this._loading=null}initialize(){this.flowContainer.addChild(this._flowDisplayObject)}destroy(){this._clear(),this.flowContainer.removeAllChildren()}get updating(){return null!=this._loading}update(X){const{flowStyle:Y}=this.flowContainer;if((0,O.Wi)(Y))return void this._clear();const{extent:Q,rotation:q,resolution:se,pixelRatio:oe}=X.state,ne=function(X,Y){const Q=new l.Z({x:(X.xmax+X.xmin)/2,y:(X.ymax+X.ymin)/2,spatialReference:X.spatialReference}),q=X.xmax-X.xmin,se=X.ymax-X.ymin,oe=Math.abs(Math.cos((0,E.Vl)(Y))),ne=Math.abs(Math.sin((0,E.Vl)(Y))),le=oe*q+ne*se,re=ne*q+oe*se,ue=new A.Z({xmin:Q.x-le/2,ymin:Q.y-re/2,xmax:Q.x+le/2,ymax:Q.y+re/2,spatialReference:X.spatialReference});return ue.centerAt(Q),ue}(Q,q);ne.expand(1.15);const le=[Math.round((ne.xmax-ne.xmin)/se),Math.round((ne.ymax-ne.ymin)/se)],re=new h(Y,ne,le,oe);if((0,O.pC)(this._loading)){if(this._loading.update(re))return;this._loading.destroy(),this._loading=null}!(0,O.Wi)(this._flowDisplayObject.displayData)&&this._flowDisplayObject.displayData.update(re)||(re.load().then(()=>{this._flowDisplayObject.clear(),this._flowDisplayObject.displayData=this._loading,this._loading=null},ue=>{(0,_.D_)(ue)||(J.error("A resource failed to load.",ue),this._loading=null)}),this._loading=re)}_clear(){this._flowDisplayObject.clear(),(0,O.pC)(this._loading)&&(this._loading.destroy(),this._loading=null)}};(0,v._)([(0,y.Cb)()],M.prototype,"_loading",void 0),(0,v._)([(0,y.Cb)()],M.prototype,"flowContainer",void 0),(0,v._)([(0,y.Cb)()],M.prototype,"updating",null),M=(0,v._)([(0,u.j)("esri.views.2d.engine.flow.FlowStrategy")],M);const j=M;var K=t(75244);var $=t(20316),T=(t(1907),t(59450),t(42909),t(30905),t(36079),t(86550));class x{constructor(Y,Q){this._vertexData=Y,this._indexData=Q}prepareForRendering(Y,Q,q){const se=$.Z.createVertex(Y,35044,this._vertexData),oe=$.Z.createIndex(Y,35044,this._indexData),ne=new T.Z(Y,Q,q,{geometry:se},oe);this.vertexBuffer=se,this.indexBuffer=oe,this.vertexArray=ne,this._vertexData=null,this._indexData=null}detach(){this.vertexArray.dispose(),this.vertexBuffer.dispose(),this.indexBuffer.dispose()}}class U{constructor(Y,Q,q){this._loadImagery=Y,this._createStreamlinesMesh=Q,this._rendererSettings=function(X){const Y=(0,K.F2)(X.lineWidth),Q=2*Y,q=Math.round((0,K.F2)(X.lineLength)/Q)+1,se=Y,ne=X.lineColor.toRgba(),le=[ne[0]/255,ne[1]/255,ne[2]/255,ne[3]],{lineSpeed:re,fadeDuration:ue,density:ie}=X;return{lineRenderWidth:Y,segmentLength:Q,verticesPerLine:q,lineCollisionWidth:se,lineSpacing:10,lineColor:le,lineSpeed:re,fadeDuration:ue,density:ie,smoothing:(0,K.F2)(X.smoothing),velocityScale:1,minWeightThreshold:.001,minSpeedThreshold:.001,maxTurnAngle:1,mergeLines:!0,interpolate:!0,profile:!1}}(q)}get animated(){return this._rendererSettings.lineSpeed>0}get renderSettings(){return this._rendererSettings}areResourcesCompatible(Y){let Q=!0;return Q=Q&&Y._loadImagery===this._loadImagery,Q=Q&&Y._createStreamlinesMesh===this._createStreamlinesMesh,Q=Q&&Y._rendererSettings.verticesPerLine===this._rendererSettings.verticesPerLine,Q=Q&&Y._rendererSettings.segmentLength===this._rendererSettings.segmentLength,Q=Q&&Y._rendererSettings.lineSpacing===this._rendererSettings.lineSpacing,Q=Q&&Y._rendererSettings.density===this._rendererSettings.density,Q=Q&&Y._rendererSettings.smoothing===this._rendererSettings.smoothing,Q=Q&&Y._rendererSettings.velocityScale===this._rendererSettings.velocityScale,Q=Q&&Y._rendererSettings.minWeightThreshold===this._rendererSettings.minWeightThreshold,Q=Q&&Y._rendererSettings.minSpeedThreshold===this._rendererSettings.minSpeedThreshold,Q=Q&&Y._rendererSettings.mergeLines===this._rendererSettings.mergeLines,Q=Q&&Y._rendererSettings.interpolate===this._rendererSettings.interpolate,Q&&this._rendererSettings.mergeLines&&(Q=Y._rendererSettings.lineCollisionWidth===this._rendererSettings.lineCollisionWidth),!!Q}loadResources(Y,Q){var q=this;return(0,s.Z)(function*(){const{extent:se,size:oe}=Y;(0,_.k_)(Q);const ne=yield q._loadImagery(se,oe[0],oe[1],Q),{vertexData:le,indexData:re}=yield q._createStreamlinesMesh(q._rendererSettings,ne,Q);return new x(le,re)})()}}let H=class extends C.Z{constructor(){var X;super(...arguments),X=this,this._loadImagery=(Y,Q,q,se)=>(0,S.KK)(this.layer,Y,Q,q,se),this._createStreamlinesMesh=(Y,Q,q)=>this.layer.createStreamlinesMesh({flowData:Q,rendererSettings:Y},{signal:q}),this.container=null,this.layer=null,this.type="rasterAnimatedFlow",this.redrawOrRefetch=(0,s.Z)(function*(){X._rendererChanged()})}get updating(){return!this._strategy||this._strategy.updating}update(X){X.stationary?this._strategy.update(X):this.layerView.requestUpdate()}install(X){this.container=new P,X.addChild(this.container),this._strategy=new j({flowContainer:this.container}),this._rendererChanged()}uninstall(){this._strategy.destroy(),this.container.removeAllChildren(),this.container.remove()}moveEnd(){}doRefresh(){return(0,s.Z)(function*(){})()}attach(){}_rendererChanged(){if("animated-flow"!==this.layer.renderer.type)return;const X=new U(this._loadImagery,this._createStreamlinesMesh,this.layer.renderer);this.container.flowStyle=X,this.layerView.requestUpdate()}};(0,v._)([(0,y.Cb)()],H.prototype,"_strategy",void 0),(0,v._)([(0,y.Cb)()],H.prototype,"container",void 0),(0,v._)([(0,y.Cb)()],H.prototype,"layer",void 0),(0,v._)([(0,y.Cb)()],H.prototype,"layerView",void 0),(0,v._)([(0,y.Cb)()],H.prototype,"type",void 0),(0,v._)([(0,y.Cb)()],H.prototype,"updating",null),H=(0,v._)([(0,u.j)("esri.views.2d.engine.flow.AnimatedFlowView2D")],H);const k=H},67431:(ee,V,t)=>{t.d(V,{Y:()=>S});var s=t(79076),m=(t(22345),t(55865),t(45072),t(30627),t(72062),t(96410)),u=t(99306);const S=d=>{let n=class extends d{attach(){this.view.timeline.record(`${this.layer.title} (BitmapTileLayer) Attach`),this._bitmapView=new u.s(this._tileInfoView),this.container.addChild(this._bitmapView)}detach(){var c;this.container.removeChild(this._bitmapView),null==(c=this._bitmapView)||c.removeAllChildren()}};return n=(0,s._)([(0,m.j)("esri.views.2d.layers.BitmapTileLayerView2D")],n),n}},67906:(ee,V,t)=>{t.d(V,{p:()=>P,k:()=>c});var s=t(94546),v=t(33380),y=(t(30627),t(18502)),D=t(30928),B=t(61164),m=t(33044),u=t(14011);function S(a,o){return a<<16|o}function d(a){return(4294901760&a)>>>16}function n(a){return 65535&a}const c={getObjectId:a=>a.getObjectId(),getAttributes:a=>a.readAttributes(),getAttribute:(a,o)=>a.readAttribute(o),cloneWithGeometry:(a,o)=>a,getGeometry:a=>a.readHydratedGeometry(),getCentroid:(a,o)=>a.readCentroid()};class P extends m.J{constructor(o,E,O){super(o,E),this.featureAdapter=c,this.events=new v.Z,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new s.Z(50),this._index=(0,D.r)(9,_=>({minX:this._storage.getXMin(_),minY:this._storage.getYMin(_),maxX:this._storage.getXMax(_),maxY:this._storage.getYMax(_)})),this._storage=E,this.mode=O}get storage(){return this._storage}get storeStatistics(){let o=0,E=0,O=0;return this.forEach(_=>{const l=_.readGeometry();l&&(E+=l.isPoint?1:l.lengths.reduce((p,h)=>p+h,0),O+=l.isPoint?1:l.lengths.length,o+=1)}),{featureCount:o,vertexCount:E,ringCount:O}}hasInstance(o){return this._featureSetsByInstance.has(o)}onTileData(o,E){if((0,y.Wi)(E.addOrUpdate))return E;if(E.addOrUpdate.attachStorage(this._storage),"snapshot"===this.mode){const _=E.addOrUpdate.getCursor();for(;_.next();){const l=_.getDisplayId();this.setComputedAttributes(this._storage,_,l,o.scale)}return E}this._featureSetsByInstance.set(E.addOrUpdate.instance,E.addOrUpdate);const O=E.addOrUpdate.getCursor();for(;O.next();)this._insertFeature(O,o.scale);return this._spatialIndexInvalid=!0,this.events.emit("changed"),E}search(o){this._rebuildIndex();const E=o.id,O=this._indexSearchCache.find(h=>h.tileId===E);if((0,y.pC)(O))return O.readers;const _=new Map,l=this._searchIndex(o.bounds),p=[];for(const h of l){const L=this._storage.getInstanceId(h),g=d(L),W=n(L);_.has(g)||_.set(g,[]),_.get(g).push(W)}return _.forEach((h,L)=>{const g=this._featureSetsByInstance.get(L);p.push(u.t.from(g,h))}),this._indexSearchCache.enqueue({tileId:E,readers:p}),p}insert(o){const E=o.getCursor(),O=this._storage;for(;E.next();){var _;const l=S(E.instance,E.getIndex()),p=E.getObjectId(),h=null!=(_=this._objectIdToDisplayId.get(p))?_:this._storage.createDisplayId();E.setDisplayId(h),O.setInstanceId(h,l),this._objectIdToDisplayId.set(p,h)}this._featureSetsByInstance.set(o.instance,o),this._spatialIndexInvalid=!0}remove(o){const E=this._objectIdToDisplayId.get(o);if(!E)return;const O=this._storage.getInstanceId(E),_=n(O),l=d(O),p=this._featureSetsByInstance.get(l);this._objectIdToDisplayId.delete(o),this._storage.releaseDisplayId(E),p.removeAtIndex(_),p.isEmpty&&this._featureSetsByInstance.delete(l),this._spatialIndexInvalid=!0}forEach(o){this._objectIdToDisplayId.forEach(E=>{const O=this._storage.getInstanceId(E),_=this._lookupFeature(O);o(_)})}forEachUnsafe(o){this._objectIdToDisplayId.forEach(E=>{const O=this._storage.getInstanceId(E),_=d(O),l=n(O),p=this._getFeatureSet(_);p.setIndex(l),o(p)})}forEachInBounds(o,E){const O=this._searchIndex(o);for(const _ of O){const l=this.lookupFeatureByDisplayId(_,this._storage);E((0,y.Wg)(l))}}forEachBounds(o,E,O){this._rebuildIndex();const _=[0,0,0,0];for(const l of o){if(!l.readGeometry())continue;const p=l.getDisplayId();_[0]=this._storage.getXMin(p),_[1]=this._storage.getYMin(p),_[2]=this._storage.getXMax(p),_[3]=this._storage.getYMax(p),E((0,B.JR)(O,_))}}sweepFeatures(o,E,O){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach((_,l)=>{o.has(_)||(E.releaseDisplayId(_),O&&O.unsetAttributeData(_),this._objectIdToDisplayId.delete(l))}),this.events.emit("changed")}sweepFeatureSets(o){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach((E,O)=>{o.has(O)||this._featureSetsByInstance.delete(O)})}lookupObjectId(o,E){const O=this.lookupFeatureByDisplayId(o,E);return(0,y.Wi)(O)?null:O.getObjectId()}lookupDisplayId(o){return this._objectIdToDisplayId.get(o)}lookupFeatureByDisplayId(o,E){const O=E.getInstanceId(o);return this._lookupFeature(O)}lookupByDisplayIdUnsafe(o){const E=this._storage.getInstanceId(o),O=d(E),_=n(E),l=this._getFeatureSet(O);return l?(l.setIndex(_),l):null}_insertFeature(o,E){const O=this._storage,_=o.getObjectId(),l=S(o.instance,o.getIndex());O.getInstanceId(o.getDisplayId());let p=this._objectIdToDisplayId.get(_);p||(p=O.createDisplayId(),this._objectIdToDisplayId.set(_,p),this._spatialIndexInvalid=!0),o.setDisplayId(p),O.setInstanceId(p,l),this.setComputedAttributes(O,o,p,E)}_searchIndex(o){this._rebuildIndex();const E={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]};return this._index.search(E)}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const o=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(E=>{const O=E.getCursor();for(;O.next();){const _=O.getDisplayId();this._storage.setBounds(_,O)&&o.push(_)}}):this._objectIdToDisplayId.forEach(E=>{const O=this._storage.getInstanceId(E);this._storage.setBounds(E,this._lookupFeature(O))&&o.push(E)}),this._index.clear(),this._index.load(o),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(o){const E=d(o),O=n(o),_=this._getFeatureSet(E);if(!_)return null;const l=_.getCursor();return l.setIndex(O),l}_getFeatureSet(o){return this._featureSetsByInstance.get(o)}}},33044:(ee,V,t)=>{t.d(V,{J:()=>S});var s=t(49996),v=t(30627),C=t(18502),y=t(58616),D=t(2999),B=t(22345);const u=t.e(3373).then(t.bind(t,73373));class S{constructor(n,c){this._canCacheExpressionValue=!1,this._sourceInfo=n,this._bitsets={computed:c.getBitset(c.createBitset())}}invalidate(){this._bitsets.computed.clear()}updateSchema(n,c){var P=this;return(0,s.Z)(function*(){const a=(0,y.Hg)(P._schema,c);if(P._schema=c,!c||(0,C.Wi)(a)||!(0,y.uD)(a,"attributes"))return;(0,v.Z)("esri-2d-update-debug")&&console.debug("Applying Update - Store:",a),P._bitsets.computed.clear(),n.targets[c.name]=!0;const o=c.attributes,E=[],O=[];for(const _ in o){const l=o[_];switch(l.type){case"field":break;case"expression":E.push(P._createArcadeComputedField(l));break;case"label-expression":E.push(P._createLabelArcadeComputedField(l));break;case"statistic":O.push(l)}}P._computedFields=yield Promise.all(E),P._canCacheExpressionValue=!P._computedFields.some(_=>"expression"===_.type&&_.expression.referencesScale()),P._statisticFields=O})()}setComputedAttributes(n,c,P,a){const o=this._bitsets.computed;if(!this._canCacheExpressionValue||!o.has(P)){o.set(P);for(const E of this._computedFields){const O=this._evaluateField(c,E,a);switch(E.resultType){case"numeric":n.setComputedNumericAtIndex(P,E.fieldIndex,O);break;case"string":n.setComputedStringAtIndex(P,E.fieldIndex,O)}}}}_createArcadeComputedField(n){var c=this;return(0,s.Z)(function*(){const P=c._sourceInfo.spatialReference,a=c._sourceInfo.fieldsIndex;return ae(te({},n),{expression:yield(0,D.Yi)(n.valueExpression,P,a)})})()}_createLabelArcadeComputedField(n){var c=this;return(0,s.Z)(function*(){const P=c._sourceInfo.spatialReference,a=c._sourceInfo.fieldsIndex,{createLabelFunction:o}=yield u,E=yield o(n.label,a,P);return ae(te({},n),{builder:E})})()}_evaluateField(n,c,P){switch(c.type){case"label-expression":{const a=n.readArcadeFeature();return c.builder.evaluate(a)||""}case"expression":{const{expression:a}=c;return function(d,n,c){d.referencesGeometry();const P=n.readArcadeFeature();try{return d.evaluate(ae(te({},c),{$feature:P}))}catch(a){return B.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}(a,n,{$view:{scale:P}})}}}}},62497:(ee,V,t)=>{t.d(V,{Z:()=>S});var s=t(79076),v=t(62091),C=t(94911),m=(t(45072),t(30627),t(55865),t(96410));let u=class extends v.r{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const d=this.get("tileStore.tileScheme.spatialReference");return d&&d.toJSON()||null}};(0,s._)([(0,C.Cb)({readOnly:!0})],u.prototype,"supportsTileUpdates",null),(0,s._)([(0,C.Cb)({constructOnly:!0})],u.prototype,"remoteClient",void 0),(0,s._)([(0,C.Cb)({constructOnly:!0})],u.prototype,"service",void 0),(0,s._)([(0,C.Cb)()],u.prototype,"spatialReference",null),(0,s._)([(0,C.Cb)({constructOnly:!0})],u.prototype,"tileInfo",void 0),(0,s._)([(0,C.Cb)({constructOnly:!0})],u.prototype,"tileStore",void 0),u=(0,s._)([(0,m.j)("esri.views.2d.layers.features.processors.BaseProcessor")],u);const S=u},14011:(ee,V,t)=>{t.d(V,{t:()=>v});var s=t(56738);class v extends s.s{constructor(y,D){super(s.s.createInstance()),this._currentIndex=-1,this._reader=y,this._indices=D}static from(y,D){return new v(y.copy(),D)}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const y=new v(this._reader.copy(),this._indices);return y._currentIndex=this._currentIndex,y}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(y){this._reader.setArcadeSpatialReference(y)}attachStorage(y){this._reader.attachStorage(y)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}getStorage(){return this._reader.getStorage()}getComputedNumeric(y){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(y,D){return this._reader.setComputedNumericAtIndex(D,0)}getComputedString(y){return this._reader.getComputedStringAtIndex(0)}setComputedString(y,D){return this._reader.setComputedStringAtIndex(0,D)}getComputedNumericAtIndex(y){return this._reader.getComputedNumericAtIndex(y)}setComputedNumericAtIndex(y,D){this._reader.setComputedNumericAtIndex(y,D)}getComputedStringAtIndex(y){return this._reader.getComputedStringAtIndex(y)}setComputedStringAtIndex(y,D){return this._reader.setComputedStringAtIndex(y,D)}transform(y,D,B,m){const u=this.copy();return u._reader=this._reader.transform(y,D,B,m),u}readAttribute(y,D=!1){return this._reader.readAttribute(y,D)}readAttributes(){return this._reader.readAttributes()}joinAttributes(y){return this._reader.joinAttributes(y)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(y){return this.readAttribute(y,!0)}hasField(y){return this._reader.hasField(y)}setField(y,D){return this._reader.setField(y,D)}keys(){return this._reader.keys()}castToText(){return this._reader.castToText()}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(y){return this._reader.setDisplayId(y)}getGroupId(){return this._reader.getGroupId()}setGroupId(y){return this._reader.setGroupId(y)}getXHydrated(){return this._reader.getXHydrated()}getYHydrated(){return this._reader.getYHydrated()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(y){return this._reader.setIndex(y)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_readAttribute(y,D){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}_readAttributes(){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}}},86923:(ee,V,t)=>{t.d(V,{Z:()=>S});var s=t(79076),v=t(62091),C=t(94911),m=(t(45072),t(30627),t(55865),t(96410));let u=class extends v.r{constructor(d){super(d),this.tiles=new Map}destroy(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null}get updating(){return this.isUpdating()}acquireTile(d){const n=this.createTile(d);return n.once("isReady",()=>this.notifyChange("updating")),this.tiles.set(d.id,n),n}forceAttributeTextureUpload(){}forEachTile(d){this.tiles.forEach(d)}releaseTile(d){this.tiles.delete(d.key.id),this.disposeTile(d)}isUpdating(){let d=!0;return this.tiles.forEach(n=>{d=d&&n.isReady}),!d}setHighlight(){}invalidateLabels(){}requestUpdate(){this.layerView.requestUpdate()}};(0,s._)([(0,C.Cb)()],u.prototype,"layer",void 0),(0,s._)([(0,C.Cb)()],u.prototype,"layerView",void 0),(0,s._)([(0,C.Cb)()],u.prototype,"tileInfoView",void 0),(0,s._)([(0,C.Cb)()],u.prototype,"updating",null),u=(0,s._)([(0,m.j)("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],u);const S=u},84853:(ee,V,t)=>{t.d(V,{Z:()=>C});var s=t(31620),v=t(32468);class C extends v.Z{renderChildren(D){this.attributeView.bindTextures(D.context,!1),this.children.some(B=>B.hasData)&&(super.renderChildren(D),D.drawPhase===s.jx.MAP&&this._renderChildren(D),this.hasHighlight()&&D.drawPhase===s.jx.HIGHLIGHT&&this._renderHighlight(D),this._boundsRenderer&&this._boundsRenderer.doRender(D))}_renderHighlight(D){const{painter:B}=D,m=B.effects.highlight;m.bind(D),this._renderChildren(D,m.defines),m.draw(D),m.unbind()}}},62330:(ee,V,t)=>{t.d(V,{Z:()=>J});var s=t(49996),v=t(79076),C=t(6897),y=t(7808),D=t(94911),S=(t(45072),t(30627),t(55865),t(96410)),d=t(70157),n=t(7401),c=t(35169),P=t(87940);const a=Math.PI/180;function O(M,j){const G=function(M){return M*a}(j.rotation),K=Math.abs(Math.cos(G)),w=Math.abs(Math.sin(G)),[$,I]=j.size;return M[0]=Math.round(I*w+$*K),M[1]=Math.round(I*K+$*w),M}var p=t(44946),h=t(71850),L=t(5507);const g=(0,n.Ue)(),W=[0,0],F=new L.Z(0,0,0,0),A_imageMaxWidth=2048,A_imageMaxHeight=2048,A_imageRotationSupported=!1,A_imageNormalizationSupported=!1,A_hidpi=!1;let b=class extends C.Z{constructor(M){var j;super(M),j=this,this._imagePromise=null,this.bitmaps=[],this.hidpi=A_hidpi,this.imageMaxWidth=A_imageMaxWidth,this.imageMaxHeight=A_imageMaxHeight,this.imageRotationSupported=A_imageRotationSupported,this.imageNormalizationSupported=A_imageNormalizationSupported,this.update=(0,y.Ds)(function(){var G=(0,s.Z)(function*(K,w){if(!K.stationary||j.destroyed)return null;const $=K.state,I=(0,c.C5)($.spatialReference),Z=j.hidpi?K.pixelRatio:1,N=j.imageNormalizationSupported&&$.worldScreenWidth&&$.worldScreenWidth<$.size[0];N?(W[0]=$.worldScreenWidth,W[1]=$.size[1]):j.imageRotationSupported?(W[0]=$.size[0],W[1]=$.size[1]):O(W,$);const R=Math.floor(W[0]*Z)>j.imageMaxWidth||Math.floor(W[1]*Z)>j.imageMaxHeight,z=I&&($.extent.xmin<I.valid[0]||$.extent.xmax>I.valid[1]),T=!j.imageNormalizationSupported&&z,x=!R&&!T,U=j.imageRotationSupported?$.rotation:0;if(x){const H=N?$.paddedViewState.center:$.center;j._imagePromise=j._singleExport($,W,H,$.resolution,U,Z,w)}else{let H=Math.min(j.imageMaxWidth,j.imageMaxHeight);T&&(H=Math.min($.worldScreenWidth,H)),j._imagePromise=j._tiledExport($,H,U,Z,w)}return j._imagePromise.then(function(){var H=(0,s.Z)(function*(k){if(j._imagePromise=null,!j.destroyed){j.bitmaps=null!=k?k:[];for(const X of j.container.children)k.includes(X)||X.fadeOut().then(()=>{X.remove()});for(const X of k)j.container.addChild(X),X.fadeIn()}});return function(k){return H.apply(this,arguments)}}()).catch(H=>{throw j._imagePromise=null,H})});return function(K,w){return G.apply(this,arguments)}}(),5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(M){for(const j of this.container.children){if(!j.visible||!j.stage)return;M(j),j.invalidateTexture(),j.requestRender()}}_export(M,j,G,K,w,$){var I=this;return(0,s.Z)(function*(){const Z=yield I.fetchSource(M,Math.floor(j*w),Math.floor(G*w),{rotation:K,pixelRatio:w,signal:$}),N=new p.eY(Z,"additive");return N.x=M.xmin,N.y=M.ymax,N.resolution=M.width/j,N.rotation=K,N.pixelRatio=w,N})()}_singleExport(M,j,G,K,w,$,I){var Z=this;return(0,s.Z)(function*(){!function(M,j,G,K){const[w,$]=j,[I,Z]=K,N=.5*G;M[0]=w-N*I,M[1]=$-N*Z,M[2]=w+N*I,M[3]=$+N*Z}(g,G,K,j);const N=new d.Z(g[0],g[1],g[2],g[3],M.spatialReference);return[yield Z._export(N,j[0],j[1],w,$,I)]})()}_tiledExport(M,j,G,K,w){const $=P.Z.create({size:j,spatialReference:M.spatialReference,scales:[M.scale]}),I=new h.Z($),Z=I.getTileCoverage(M);if(!Z)return null;const N=[];return Z.forEach((R,z,T,x)=>{F.set(R,z,T,x),I.getTileBounds(g,F);const U=new d.Z(g[0],g[1],g[2],g[3],M.spatialReference);N.push(this._export(U,j,j,G,K,w))}),Promise.all(N)}};(0,v._)([(0,D.Cb)()],b.prototype,"_imagePromise",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"bitmaps",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"container",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"fetchSource",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"hidpi",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"imageMaxWidth",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"imageMaxHeight",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"imageRotationSupported",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"imageNormalizationSupported",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"requestUpdate",void 0),(0,v._)([(0,D.Cb)()],b.prototype,"updating",null),b=(0,v._)([(0,S.j)("esri.views.2d.layers.support.ExportStrategy")],b);const J=b},12871:(ee,V,t)=>{function C(D,B,m,u){if(m.level===u.level)return B;const S=D.tileInfo.size,d=D.getTileResolution(m.level),n=D.getTileResolution(u.level);let c=D.getLODInfoAt(u.level);const P=c.getXForColumn(u.col),a=c.getYForRow(u.row);c=D.getLODInfoAt(m.level);const o=c.getXForColumn(m.col),E=c.getYForRow(m.row),O=function(D){return D instanceof HTMLImageElement?D.naturalWidth:D.width}(B)/S[0],_=function(D){return D instanceof HTMLImageElement?D.naturalHeight:D.height}(B)/S[1],l=Math.round(O*((P-o)/d)),p=Math.round(_*(-(a-E)/d)),h=Math.round(O*S[0]*(n/d)),L=Math.round(_*S[1]*(n/d)),g=y(S);return g.getContext("2d").drawImage(B,l,p,h,L,0,0,S[0],S[1]),g}function y(D){const B=document.createElement("canvas");return[B.width,B.height]=D,B}t.d(V,{V:()=>y,i:()=>C})},46880:(ee,V,t)=>{t.d(V,{U$:()=>D});var s=t(13707),v=t(81681);class C{constructor(m,u){this.layout=m,this.buffer="number"==typeof u?new ArrayBuffer(u*m.stride):u;for(const S of m.fieldNames){const d=m.fields.get(S);this[S]=new d.constructor(this.buffer,d.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(m,u){const S=this[m];return S&&S.elementCount===u.ElementCount&&S.elementType===u.ElementType?S:null}slice(m,u){return new C(this.layout,this.buffer.slice(m*this.stride,u*this.stride))}copyFrom(m,u,S,d){const n=this.stride;if(n%4==0){const c=new Uint32Array(m.buffer,u*n,d*n/4);new Uint32Array(this.buffer,S*n,d*n/4).set(c)}else{const c=new Uint8Array(m.buffer,u*n,d*n);new Uint8Array(this.buffer,S*n,d*n).set(c)}}}class y{constructor(){this.stride=0,this.fields=new Map,this.fieldNames=[]}vec2f(m,u){return this.appendField(m,s.Eu,u),this}vec2f64(m,u){return this.appendField(m,s.q6,u),this}vec3f(m,u){return this.appendField(m,s.ct,u),this}vec3f64(m,u){return this.appendField(m,s.fP,u),this}vec4f(m,u){return this.appendField(m,s.ek,u),this}vec4f64(m,u){return this.appendField(m,s.Cd,u),this}mat3f(m,u){return this.appendField(m,s.gK,u),this}mat3f64(m,u){return this.appendField(m,s.ey,u),this}mat4f(m,u){return this.appendField(m,s.bj,u),this}mat4f64(m,u){return this.appendField(m,s.O1,u),this}vec4u8(m,u){return this.appendField(m,s.mc,u),this}f32(m,u){return this.appendField(m,s.ly,u),this}f64(m,u){return this.appendField(m,s.oS,u),this}u8(m,u){return this.appendField(m,s.D_,u),this}u16(m,u){return this.appendField(m,s.av,u),this}i8(m,u){return this.appendField(m,s.Hz,u),this}vec2i8(m,u){return this.appendField(m,s.Vs,u),this}vec2i16(m,u){return this.appendField(m,s.or,u),this}vec2u8(m,u){return this.appendField(m,s.xA,u),this}vec4u16(m,u){return this.appendField(m,s.v6,u),this}u32(m,u){return this.appendField(m,s.Nu,u),this}appendField(m,u,S){const d=u.ElementCount*(0,v.n1)(u.ElementType),n=this.stride;this.fields.set(m,{size:d,constructor:u,offset:n,optional:S}),this.stride+=d,this.fieldNames.push(m)}alignTo(m){return this.stride=Math.floor((this.stride+m-1)/m)*m,this}hasField(m){return this.fieldNames.indexOf(m)>=0}createBuffer(m){return new C(this,m)}createView(m){return new C(this,m)}clone(){const m=new y;return m.stride=this.stride,m.fields=new Map,this.fields.forEach((u,S)=>m.fields.set(S,u)),m.fieldNames=this.fieldNames.slice(),m.BufferType=this.BufferType,m}}function D(){return new y}},81269:(ee,V,t)=>{t.d(V,{$L:()=>D,$x:()=>d,ve:()=>m,IB:()=>y,wu:()=>v,je:()=>S});var s=t(89501);const v=(0,s.wK)(770,1,771,771),C=(0,s.if)(1,1),y=(0,s.if)(0,771);function D(n){return 2===n?null:1===n?y:C}const m=5e5,u={factor:-1,units:-2};function S(n){return n?u:null}function d(n){return 3===n||2===n?513:515}},61791:(ee,V,t)=>{t.d(V,{Z:()=>v});var s=t(80541);class v{constructor(y){this._programCacheByTemplate=new Map,this._rctx=y}dispose(){this._programCacheByTemplate.forEach(y=>y.programs.forEach(D=>D.dispose())),this._programCacheByTemplate=null}getProgram(y,D){return this._programCacheByTemplate.has(y)||this.addProgramTemplate(y,B=>(0,s.H)(this._rctx,y,B)),this.getProgramTemplateInstance(y,D)}addProgramTemplate(y,D){this._programCacheByTemplate.set(y,{constructor:D,programs:new Map})}getProgramTemplateInstance(y,D){const B=this._programCacheByTemplate.get(y);if(B){const m=D?JSON.stringify(D):"default";if(!B.programs.has(m)){const u=B.constructor(D);B.programs.set(m,u)}return B.programs.get(m)}return null}}},46117:(ee,V,t)=>{function v(m,u,S){for(let d=0;d<S;++d)u[2*d]=m[d],u[2*d+1]=m[d]-u[2*d]}function y(m,u,S,d){for(let n=0;n<d;++n)D[0]=m[n],v(D,B,1),u[n]=B[0],S[n]=B[1]}t.d(V,{LF:()=>v,po:()=>y});const D=new Float64Array(1),B=new Float32Array(2)},89501:(ee,V,t)=>{function s(R,z,T=32774,x=[0,0,0,0]){return{srcRgb:R,srcAlpha:R,dstRgb:z,dstAlpha:z,opRgb:T,opAlpha:T,color:{r:x[0],g:x[1],b:x[2],a:x[3]}}}function v(R,z,T,x,U=32774,H=32774,k=[0,0,0,0]){return{srcRgb:R,srcAlpha:z,dstRgb:T,dstAlpha:x,opRgb:U,opAlpha:H,color:{r:k[0],g:k[1],b:k[2],a:k[3]}}}t.d(V,{jp:()=>N,zp:()=>D,BK:()=>m,LZ:()=>B,sm:()=>E,wK:()=>v,if:()=>s});const C={face:1029,mode:2305},y={face:1028,mode:2305},D=R=>2===R?C:1===R?y:null,B={zNear:0,zFar:1},m={r:!0,g:!0,b:!0,a:!0};function u(R){return l.intern(R)}function S(R){return h.intern(R)}function d(R){return g.intern(R)}function n(R){return F.intern(R)}function c(R){return b.intern(R)}function P(R){return M.intern(R)}function a(R){return G.intern(R)}function o(R){return w.intern(R)}function E(R){return I.intern(R)}class O{constructor(z,T){this.makeKey=z,this.makeRef=T,this.interns=new Map}intern(z){if(!z)return null;const T=this.makeKey(z),x=this.interns;return x.has(T)||x.set(T,this.makeRef(z)),x.get(T)}}function _(R){return"["+R.join(",")+"]"}const l=new O(p,R=>te({__tag:"Blending"},R));function p(R){return R?_([R.srcRgb,R.srcAlpha,R.dstRgb,R.dstAlpha,R.opRgb,R.opAlpha,R.color.r,R.color.g,R.color.b,R.color.a]):null}const h=new O(L,R=>te({__tag:"Culling"},R));function L(R){return R?_([R.face,R.mode]):null}const g=new O(W,R=>te({__tag:"PolygonOffset"},R));function W(R){return R?_([R.factor,R.units]):null}const F=new O(A,R=>te({__tag:"DepthTest"},R));function A(R){return R?_([R.func]):null}const b=new O(J,R=>te({__tag:"StencilTest"},R));function J(R){return R?_([R.function.func,R.function.ref,R.function.mask,R.operation.fail,R.operation.zFail,R.operation.zPass]):null}const M=new O(j,R=>te({__tag:"DepthWrite"},R));function j(R){return R?_([R.zNear,R.zFar]):null}const G=new O(K,R=>te({__tag:"ColorWrite"},R));function K(R){return R?_([R.r,R.g,R.b,R.a]):null}const w=new O($,R=>te({__tag:"StencilWrite"},R));function $(R){return R?_([R.mask]):null}const I=new O(function(R){return R?_([p(R.blending),L(R.culling),W(R.polygonOffset),A(R.depthTest),J(R.stencilTest),j(R.depthWrite),K(R.colorWrite),$(R.stencilWrite)]):null},R=>({blending:u(R.blending),culling:S(R.culling),polygonOffset:d(R.polygonOffset),depthTest:n(R.depthTest),stencilTest:c(R.stencilTest),depthWrite:P(R.depthWrite),colorWrite:a(R.colorWrite),stencilWrite:o(R.stencilWrite)}));class N{constructor(z){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=z}setPipeline(z){(this._pipelineInvalid||z!==this._pipeline)&&(this.setBlending(z.blending),this.setCulling(z.culling),this.setPolygonOffset(z.polygonOffset),this.setDepthTest(z.depthTest),this.setStencilTest(z.stencilTest),this.setDepthWrite(z.depthWrite),this.setColorWrite(z.colorWrite),this.setStencilWrite(z.stencilWrite),this._pipeline=z),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}setBlending(z){this._blending=this.setSubState(z,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}setCulling(z){this._culling=this.setSubState(z,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}setPolygonOffset(z){this._polygonOffset=this.setSubState(z,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}setDepthTest(z){this._depthTest=this.setSubState(z,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}setStencilTest(z){this._stencilTest=this.setSubState(z,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}setDepthWrite(z){this._depthWrite=this.setSubState(z,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}setColorWrite(z){this._colorWrite=this.setSubState(z,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}setStencilWrite(z){this._stencilWrite=this.setSubState(z,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}setSubState(z,T,x,U){return(x||z!==T)&&(U(z),this._pipelineInvalid=!0),z}}}}]);
//# sourceMappingURL=common.837dbfd3a75c7a0afcac.js.map