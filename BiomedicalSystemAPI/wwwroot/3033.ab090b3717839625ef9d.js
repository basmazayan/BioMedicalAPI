"use strict";var H=Object.defineProperty,z=Object.defineProperties,G=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,W=(d,n,e)=>n in d?H(d,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[n]=e,B=(d,n)=>{for(var e in n||(n={}))Q.call(n,e)&&W(d,e,n[e]);if(L)for(var e of L(n))J.call(n,e)&&W(d,e,n[e]);return d},j=(d,n)=>z(d,G(n));(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[3033],{93033:(d,n,e)=>{e.r(n),e.d(n,{default:()=>g});var p=e(49996),v=e(79076),c=(e(30627),e(18502)),u=(e(22345),e(55865),e(45072),e(72062),e(96410)),h=e(58616),T=e(39115),A=e(30603),S=e(62497),E=e(66998);class M{constructor(s,i){this.offset=s,this.extent=i}}let U=class extends S.Z{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}update(r,s){var i=this;return(0,p.Z)(function*(){const _=s.schema.processors[0];"heatmap"===_.type&&(0,h.Hg)(i._schema,_)&&(r.mesh=!0,i._schema=_)})()}onTileUpdate(r){for(const s of r.removed)this._tileKeyToFeatureSets.delete(s.key.id)}onTileClear(r){return this._tileKeyToFeatureSets.delete(r.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:r.id,data:{clear:!0}})}onTileMessage(r,s,i){var _=this;return(0,p.Z)(function*(){_._tileKeyToFeatureSets.has(r.key.id)||_._tileKeyToFeatureSets.set(r.key.id,new Map);const t=_._tileKeyToFeatureSets.get(r.key.id);if((0,c.pC)(s.addOrUpdate)&&s.addOrUpdate.hasFeatures&&t.set(s.addOrUpdate.instance,s),s.end){const l=[],I=function(r){const s=r.key,i=new Map,_=256,t=A.I_,l=r.tileInfoView.tileInfo.isWrappable;return i.set((0,E.M)(s,-1,-1,l).id,new M([-t,-t],[t-_,t-_,t,t])),i.set((0,E.M)(s,0,-1,l).id,new M([0,-t],[0,t-_,t,t])),i.set((0,E.M)(s,1,-1,l).id,new M([t,-t],[0,t-_,_,t])),i.set((0,E.M)(s,-1,0,l).id,new M([-t,0],[t-_,0,t,t])),i.set((0,E.M)(s,1,0,l).id,new M([t,0],[0,0,_,t])),i.set((0,E.M)(s,-1,1,l).id,new M([-t,t],[t-_,0,t,_])),i.set((0,E.M)(s,0,1,l).id,new M([0,t],[0,0,t,_])),i.set((0,E.M)(s,1,1,l).id,new M([t,t],[0,0,_,_])),i}(r);_._tileKeyToFeatureSets.forEach((R,m)=>{if(m===r.key.id)R.forEach(y=>(0,c.Po)(y.addOrUpdate,K=>l.push(K)));else if(I.has(m)){const y=I.get(m),[K,V]=y.offset;R.forEach(Z=>(0,c.Po)(Z.addOrUpdate,b=>{const x=b.transform(K,V,1,1);l.push(x)}))}});const C=(0,T.QM)(l,_._schema.mesh,512,512),F={tileKey:r.key.id,intensityInfo:C},k=[C.matrix];return _.remoteClient.invoke("tileRenderer.onTileData",F,j(B({},i),{transferList:k}))}})()}onTileError(r,s,i){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:r.id,error:s},i)}};U=(0,v._)([(0,u.j)("esri.views.2d.layers.features.processors.HeatmapProcessor")],U);const g=U},66998:(d,n,e)=>{e.d(n,{M:()=>D});e(65533);function D(c,O,P,f){const a=c.clone(),u=1<<a.level,h=a.col+O,T=a.row+P;return f&&h<0?(a.col=h+u,a.world-=1):h>=u?(a.col=h-u,a.world+=1):a.col=h,a.row=T,a}}}]);
//# sourceMappingURL=3033.ab090b3717839625ef9d.js.map