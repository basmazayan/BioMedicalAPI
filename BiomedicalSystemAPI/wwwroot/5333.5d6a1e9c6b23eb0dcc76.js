"use strict";var Ye=Object.defineProperty,Qe=Object.defineProperties,$e=Object.getOwnPropertyDescriptors,we=Object.getOwnPropertySymbols,qe=Object.prototype.hasOwnProperty,ti=Object.prototype.propertyIsEnumerable,be=Math.pow,ze=(bt,yt,_)=>yt in bt?Ye(bt,yt,{enumerable:!0,configurable:!0,writable:!0,value:_}):bt[yt]=_,ne=(bt,yt)=>{for(var _ in yt||(yt={}))qe.call(yt,_)&&ze(bt,_,yt[_]);if(we)for(var _ of we(yt))ti.call(yt,_)&&ze(bt,_,yt[_]);return bt},ae=(bt,yt)=>Qe(bt,$e(yt));(self.webpackChunkbio_medical=self.webpackChunkbio_medical||[]).push([[5333,6648],{56648:(bt,yt,_)=>{function tt(p){return p=p||globalThis.location.hostname,D.some(d=>{var B;return null!=(null==(B=p)?void 0:B.match(d))})}function at(p,d){return p&&(d=d||globalThis.location.hostname)?null!=d.match(E)||null!=d.match(q)?p.replace("static.arcgis.com","staticdev.arcgis.com"):null!=d.match(U)||null!=d.match(st)?p.replace("static.arcgis.com","staticqa.arcgis.com"):p:p}_.d(yt,{pJ:()=>at,XO:()=>tt});const E=/^devext.arcgis.com$/,U=/^qaext.arcgis.com$/,q=/^[\w-]*\.mapsdevext.arcgis.com$/,st=/^[\w-]*\.mapsqa.arcgis.com$/,D=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,E,U,/^jsapps.esri.com$/,q,st]},2607:(bt,yt,_)=>{_.d(yt,{j:()=>st,b:()=>B});var tt=_(49996),at=_(22287),A=_(30627);let U=null,q=null;function st(){return D.apply(this,arguments)}function D(){return(D=(0,tt.Z)(function*(){return U||(U=p()),U})).apply(this,arguments)}function p(){return d.apply(this,arguments)}function d(){return(d=(0,tt.Z)(function*(){q=yield((0,A.Z)("esri-csp-restrictions")?yield _.e(5919).then(_.bind(_,35919)).then(u=>u.l):yield _.e(6460).then(_.bind(_,36460)).then(u=>u.l)).load({locateFile:()=>(0,at.V)("esri/core/libs/libtess/libtess.wasm")})})).apply(this,arguments)}function B(W,u){const n=Math.max(W.length,128e3);return q.triangulate(W,u,n)}},87009:(bt,yt,_)=>{_.d(yt,{i:()=>A});var tt=_(30026),at=_(42822);class A{static getPlacement(U,q,st){const D=(0,at.W)(q);if(!D)return null;const p=(0,tt.GP)(U);return D.execute(p,q,st)}}},74953:(bt,yt,_)=>{_.d(yt,{E:()=>tt});class tt{constructor(A,E){this.x=A,this.y=E}clone(){return new tt(this.x,this.y)}equals(A,E){return A===this.x&&E===this.y}isEqual(A){return A.x===this.x&&A.y===this.y}setCoords(A,E){this.x=A,this.y=E}normalize(){const A=this.x,E=this.y,U=Math.sqrt(A*A+E*E);this.x/=U,this.y/=U}rightPerpendicular(){const A=this.x;this.x=this.y,this.y=-A}move(A,E){this.x+=A,this.y+=E}assign(A){this.x=A.x,this.y=A.y}assignAdd(A,E){this.x=A.x+E.x,this.y=A.y+E.y}assignSub(A,E){this.x=A.x-E.x,this.y=A.y-E.y}rotate(A,E){const U=this.x,q=this.y;this.x=U*A-q*E,this.y=U*E+q*A}scale(A){this.x*=A,this.y*=A}length(){const A=this.x,E=this.y;return Math.sqrt(A*A+E*E)}static distance(A,E){const U=E.x-A.x,q=E.y-A.y;return Math.sqrt(U*U+q*q)}static add(A,E){return new tt(A.x+E.x,A.y+E.y)}static sub(A,E){return new tt(A.x-E.x,A.y-E.y)}}},24145:(bt,yt,_)=>{_.d(yt,{I:()=>q,b:()=>U});var tt=_(30603),at=_(74953),A=_(76272);class E{constructor(p,d,B){this.ratio=p,this.x=d,this.y=B}}class U{constructor(p,d,B,W=8,u=8){this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=W,this.pixelMargin=u,this.tileSize=tt.I_*W,this.dz=p,this.yPos=d,this.xPos=B}setPixelMargin(p){p!==this.pixelMargin&&(this.pixelMargin=p,this.setExtent(this._extent))}setExtent(p){this._extent=p,this.finalRatio=this.tileSize/p*(1<<this.dz);let d=this.pixelRatio*this.pixelMargin;d/=this.finalRatio;const B=p>>this.dz;d>B&&(d=B),this.margin=d,this.xmin=B*this.xPos-d,this.ymin=B*this.yPos-d,this.xmax=this.xmin+B+2*d,this.ymax=this.ymin+B+2*d}reset(p){this.type=p,this.lines=[],this.starts=[],this.line=null,this.start=0}moveTo(p,d){this._pushLine(),this._prevIsIn=this._isIn(p,d),this._moveTo(p,d,this._prevIsIn),this._prevPt=new at.E(p,d),this._firstPt=new at.E(p,d),this._dist=0}lineTo(p,d){const B=this._isIn(p,d),W=new at.E(p,d),u=at.E.distance(this._prevPt,W);let n,h,y,I,J,N,O,V;if(B)this._prevIsIn?this._lineTo(p,d,!0):(n=this._prevPt,h=W,y=this._intersect(h,n),this.start=this._dist+u*(1-this._r),this._lineTo(y.x,y.y,!0),this._lineTo(h.x,h.y,!0));else if(this._prevIsIn)h=this._prevPt,n=W,y=this._intersect(h,n),this._lineTo(y.x,y.y,!0),this._lineTo(n.x,n.y,!1);else{const R=this._prevPt,M=W;if(R.x<=this.xmin&&M.x<=this.xmin||R.x>=this.xmax&&M.x>=this.xmax||R.y<=this.ymin&&M.y<=this.ymin||R.y>=this.ymax&&M.y>=this.ymax)this._lineTo(M.x,M.y,!1);else{const z=[];if((R.x<this.xmin&&M.x>this.xmin||R.x>this.xmin&&M.x<this.xmin)&&(I=(this.xmin-R.x)/(M.x-R.x),V=R.y+I*(M.y-R.y),V<=this.ymin?N=!1:V>=this.ymax?N=!0:z.push(new E(I,this.xmin,V))),(R.x<this.xmax&&M.x>this.xmax||R.x>this.xmax&&M.x<this.xmax)&&(I=(this.xmax-R.x)/(M.x-R.x),V=R.y+I*(M.y-R.y),V<=this.ymin?N=!1:V>=this.ymax?N=!0:z.push(new E(I,this.xmax,V))),(R.y<this.ymin&&M.y>this.ymin||R.y>this.ymin&&M.y<this.ymin)&&(I=(this.ymin-R.y)/(M.y-R.y),O=R.x+I*(M.x-R.x),O<=this.xmin?J=!1:O>=this.xmax?J=!0:z.push(new E(I,O,this.ymin))),(R.y<this.ymax&&M.y>this.ymax||R.y>this.ymax&&M.y<this.ymax)&&(I=(this.ymax-R.y)/(M.y-R.y),O=R.x+I*(M.x-R.x),O<=this.xmin?J=!1:O>=this.xmax?J=!0:z.push(new E(I,O,this.ymax))),0===z.length)J?N?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):N?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(z.length>1&&z[0].ratio>z[1].ratio)this.start=this._dist+u*z[1].ratio,this._lineTo(z[1].x,z[1].y,!0),this._lineTo(z[0].x,z[0].y,!0);else{this.start=this._dist+u*z[0].ratio;for(let P=0;P<z.length;P++)this._lineTo(z[P].x,z[P].y,!0)}this._lineTo(M.x,M.y,!1)}}this._dist+=u,this._prevIsIn=B,this._prevPt=W}close(){if(this.line.length>2){const p=this._firstPt,d=this._prevPt;p.x===d.x&&p.y===d.y||this.lineTo(p.x,p.y);const B=this.line;let W=B.length;for(;W>=4&&(B[0].x===B[1].x&&B[0].x===B[W-2].x||B[0].y===B[1].y&&B[0].y===B[W-2].y);)B.pop(),B[0].x=B[W-2].x,B[0].y=B[W-2].y,--W}}result(p=!0){return this._pushLine(),0===this.lines.length?null:(3===this.type&&p&&st.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}resultWithStarts(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();const p=this.lines,d=p.length;if(0===d)return null;const B=[];for(let W=0;W<d;W++)B.push({line:p[W],start:this.starts[W]||0});return B}_isIn(p,d){return p>=this.xmin&&p<=this.xmax&&d>=this.ymin&&d<=this.ymax}_intersect(p,d){let B,W,u;if(d.x>=this.xmin&&d.x<=this.xmax)W=d.y<=this.ymin?this.ymin:this.ymax,u=(W-p.y)/(d.y-p.y),B=p.x+u*(d.x-p.x);else if(d.y>=this.ymin&&d.y<=this.ymax)B=d.x<=this.xmin?this.xmin:this.xmax,u=(B-p.x)/(d.x-p.x),W=p.y+u*(d.y-p.y);else{W=d.y<=this.ymin?this.ymin:this.ymax,B=d.x<=this.xmin?this.xmin:this.xmax;const n=(B-p.x)/(d.x-p.x),h=(W-p.y)/(d.y-p.y);n<h?(u=n,W=p.y+n*(d.y-p.y)):(u=h,B=p.x+h*(d.x-p.x))}return this._r=u,new at.E(B,W)}_pushLine(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}_moveTo(p,d,B){3!==this.type?B&&(p=Math.round((p-(this.xmin+this.margin))*this.finalRatio),d=Math.round((d-(this.ymin+this.margin))*this.finalRatio),this.line.push(new at.E(p,d))):(B||(p<this.xmin&&(p=this.xmin),p>this.xmax&&(p=this.xmax),d<this.ymin&&(d=this.ymin),d>this.ymax&&(d=this.ymax)),p=Math.round((p-(this.xmin+this.margin))*this.finalRatio),d=Math.round((d-(this.ymin+this.margin))*this.finalRatio),this.line.push(new at.E(p,d)),this._is_h=!1,this._is_v=!1)}_lineTo(p,d,B){let W,u;if(3!==this.type)if(B){if(p=Math.round((p-(this.xmin+this.margin))*this.finalRatio),d=Math.round((d-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(W=this.line[this.line.length-1],W.equals(p,d)))return;this.line.push(new at.E(p,d))}else this.line&&this.line.length>0&&this._pushLine();else if(B||(p<this.xmin&&(p=this.xmin),p>this.xmax&&(p=this.xmax),d<this.ymin&&(d=this.ymin),d>this.ymax&&(d=this.ymax)),p=Math.round((p-(this.xmin+this.margin))*this.finalRatio),d=Math.round((d-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){W=this.line[this.line.length-1];const n=W.x===p,h=W.y===d;if(n&&h)return;this._is_h&&n||this._is_v&&h?(W.x=p,W.y=d,u=this.line[this.line.length-2],u.x===p&&u.y===d?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(u=this.line[this.line.length-2],this._is_h=u.x===p,this._is_v=u.y===d)):(this._is_h=u.x===p,this._is_v=u.y===d)):(this.line.push(new at.E(p,d)),this._is_h=n,this._is_v=h)}else this.line.push(new at.E(p,d))}}class q{setExtent(p){this._ratio=4096===p?1:4096/p}get validateTessellation(){return this._ratio<1}reset(p){this.lines=[],this.line=null}moveTo(p,d){this.line&&this.lines.push(this.line),this.line=[];const B=this._ratio;this.line.push(new at.E(p*B,d*B))}lineTo(p,d){const B=this._ratio;this.line.push(new at.E(p*B,d*B))}close(){const p=this.line;p&&!p[0].isEqual(p[p.length-1])&&p.push(p[0])}result(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:this.lines}}class st{static simplify(p,d,B){if(!B)return;const W=-d,u=p+d,n=-d,h=p+d,y=[],I=[],J=B.length;for(let O=0;O<J;++O){const V=B[O];if(!V||V.length<2)continue;let R,M=V[0];const z=V.length;for(let P=1;P<z;++P)R=V[P],M.x===R.x&&(M.x<=W&&(M.y>R.y?(y.push(O),y.push(P),y.push(0),y.push(-1)):(I.push(O),I.push(P),I.push(0),I.push(-1))),M.x>=u&&(M.y<R.y?(y.push(O),y.push(P),y.push(1),y.push(-1)):(I.push(O),I.push(P),I.push(1),I.push(-1)))),M.y===R.y&&(M.y<=n&&(M.x<R.x?(y.push(O),y.push(P),y.push(2),y.push(-1)):(I.push(O),I.push(P),I.push(2),I.push(-1))),M.y>=h&&(M.x>R.x?(y.push(O),y.push(P),y.push(3),y.push(-1)):(I.push(O),I.push(P),I.push(3),I.push(-1)))),M=R}if(0===y.length||0===I.length)return;st.fillParent(B,I,y),st.fillParent(B,y,I);const N=[];st.calcDeltas(N,I,y),st.calcDeltas(N,y,I),st.addDeltas(N,B)}static fillParent(p,d,B){const W=B.length,u=d.length;for(let n=0;n<u;n+=4){const h=d[n],y=d[n+1],I=d[n+2],J=p[h][y-1],N=p[h][y];let O=8092,V=-1;for(let R=0;R<W;R+=4){if(B[R+2]!==I)continue;const M=B[R],z=B[R+1],P=p[M][z-1],S=p[M][z];switch(I){case 0:case 1:if((0,A.vX)(J.y,P.y,S.y)&&(0,A.vX)(N.y,P.y,S.y)){const C=Math.abs(S.y-P.y);C<O&&(O=C,V=R)}break;case 2:case 3:if((0,A.vX)(J.x,P.x,S.x)&&(0,A.vX)(N.x,P.x,S.x)){const C=Math.abs(S.x-P.x);C<O&&(O=C,V=R)}}}d[n+3]=V}}static calcDeltas(p,d,B){const W=d.length;for(let u=0;u<W;u+=4){const n=[],h=st.calcDelta(u,d,B,n);p.push(d[u]),p.push(d[u+1]),p.push(d[u+2]),p.push(h)}}static calcDelta(p,d,B,W){const u=d[p+3];if(-1===u)return 0;const n=W.length;return n>1&&W[n-2]===u?0:(W.push(u),st.calcDelta(u,B,d,W)+1)}static addDeltas(p,d){const B=p.length;let W=0;for(let u=0;u<B;u+=4){const n=p[u+3];n>W&&(W=n)}for(let u=0;u<B;u+=4){const n=d[p[u]],h=p[u+1],y=W-p[u+3];switch(p[u+2]){case 0:n[h-1].x-=y,n[h].x-=y,1===h&&(n[n.length-1].x-=y),h===n.length-1&&(n[0].x-=y);break;case 1:n[h-1].x+=y,n[h].x+=y,1===h&&(n[n.length-1].x+=y),h===n.length-1&&(n[0].x+=y);break;case 2:n[h-1].y-=y,n[h].y-=y,1===h&&(n[n.length-1].y-=y),h===n.length-1&&(n[0].y-=y);break;case 3:n[h-1].y+=y,n[h].y+=y,1===h&&(n[n.length-1].y+=y),h===n.length-1&&(n[0].y+=y)}}}}},63537:(bt,yt,_)=>{_.d(yt,{z:()=>W});var tt=_(30603);function at(u,n){return u.x===n.x&&u.y===n.y}function E(u,n){return u.x=n.y,u.y=-n.x,u}function U(u,n){return u.x=-n.y,u.y=n.x,u}function q(u,n){return u.x=n.x,u.y=n.y,u}function st(u,n){return u.x=-n.x,u.y=-n.y,u}function D(u){return Math.sqrt(u.x*u.x+u.y*u.y)}function p(u,n){return u.x*n.y-u.y*n.x}function d(u,n){return u.x*n.x+u.y*n.y}function B(u,n,h,y){return u.x=n.x*h+n.y*y,u.y=n.x*y-n.y*h,u}class W{constructor(n,h,y){this.writeVertex=n,this.writeTriangle=h,this.canUseThinTessellation=y,this.prevNormal={x:void 0,y:void 0},this.nextNormal={x:void 0,y:void 0},this.textureNormalLeft={x:0,y:1},this.textureNormalRight={x:0,y:-1},this.textureNormal={x:void 0,y:void 0},this.joinNormal={x:void 0,y:void 0},this.inner={x:void 0,y:void 0},this.outer={x:void 0,y:void 0},this.roundStart={x:void 0,y:void 0},this.roundEnd={x:void 0,y:void 0},this.startBreak={x:void 0,y:void 0},this.endBreak={x:void 0,y:void 0},this.innerPrev={x:void 0,y:void 0},this.innerNext={x:void 0,y:void 0},this.bevelStart={x:void 0,y:void 0},this.bevelEnd={x:void 0,y:void 0},this.bevelMiddle={x:void 0,y:void 0}}tessellate(n,h){(function(u){if(!u)return;const n=u.length;if(n<=1)return;let h=0;for(let y=1;y<n;y++)at(u[y],u[h])||++h===y||(u[h]=u[y]);u.length=h+1})(n),this.canUseThinTessellation&&h.halfWidth<tt.tQ&&!h.offset?this.tessellateThin_(n,h):this.tessellate_(n,h)}tessellateThin_(n,h){if(n.length<2)return;const y=h.wrapDistance||65535;let I=h.initialDistance||0,J=!1,N=n[0].x,O=n[0].y;const V=n.length;for(let R=1;R<V;++R){J&&(J=!1,I=0);let M=n[R].x,z=n[R].y,P=M-N,S=z-O,C=Math.sqrt(P*P+S*S);if(P/=C,S/=C,I+C>y){J=!0;const m=(y-I)/C;C=y-I,M=(1-m)*N+m*M,z=(1-m)*O+m*z,--R}const b=this.writeVertex(N,O,0,0,P,S,S,-P,0,-1,I),ct=this.writeVertex(N,O,0,0,P,S,-S,P,0,1,I);I+=C;const _t=this.writeVertex(M,z,0,0,P,S,S,-P,0,-1,I),w=this.writeVertex(M,z,0,0,P,S,-S,P,0,1,I);this.writeTriangle(b,ct,_t),this.writeTriangle(ct,_t,w),N=M,O=z}}tessellate_(n,h){const y=n[0],I=n[n.length-1],J=at(y,I),N=J?3:2;if(n.length<N)return;const O=h.pixelCoordRatio,V=null!=h.capType?h.capType:0,R=null!=h.joinType?h.joinType:2,M=null!=h.miterLimit?Math.min(h.miterLimit,4):2,z=null!=h.roundLimit?Math.min(h.roundLimit,1.05):1.05,P=null!=h.halfWidth?h.halfWidth:2,S=!!h.textured;let C,b,ct=null,_t=null;const w=this.prevNormal,m=this.nextNormal;let Q=-1,et=-1;const H=this.joinNormal;let nt,pt;const Lt=this.textureNormalLeft,Et=this.textureNormalRight,ft=this.textureNormal;let vt=-1,Wt=-1;const At=h.wrapDistance||65535;let St=h.initialDistance||0;const Xt=this.writeVertex,Y=this.writeTriangle,c=function(T,Z,j,K,it,mt){const dt=Xt(C,b,nt,pt,j,K,T,Z,it,mt,St);return vt>=0&&Wt>=0&&dt>=0&&Y(vt,Wt,dt),vt=Wt,Wt=dt,dt};J&&(ct=n[n.length-2],m.x=I.x-ct.x,m.y=I.y-ct.y,et=D(m),m.x/=et,m.y/=et);let L=!1;for(let T=0;T<n.length;++T){if(L&&(L=!1,St=0),ct&&(w.x=-m.x,w.y=-m.y,Q=et,St+Q>At&&(L=!0)),L){const rt=(At-St)/Q;Q=At-St,ct={x:(1-rt)*ct.x+rt*n[T].x,y:(1-rt)*ct.y+rt*n[T].y},--T}else ct=n[T];C=ct.x,b=ct.y;const Z=T<=0&&!L,j=T===n.length-1;if(Z||(St+=Q),_t=j?J?n[1]:null:n[T+1],_t?(m.x=_t.x-C,m.y=_t.y-b,et=D(m),m.x/=et,m.y/=et):(m.x=void 0,m.y=void 0),!J){if(Z){U(H,m),nt=H.x,pt=H.y,2===V&&(c(-m.y-m.x,m.x-m.y,m.x,m.y,0,-1),c(m.y-m.x,-m.x-m.y,m.x,m.y,0,1)),1===V&&(c(-m.y-m.x,m.x-m.y,m.x,m.y,-1,-1),c(m.y-m.x,-m.x-m.y,m.x,m.y,-1,1)),1!==V&&0!==V||(c(-m.y,m.x,m.x,m.y,0,-1),c(m.y,-m.x,m.x,m.y,0,1));continue}if(j){E(H,w),nt=H.x,pt=H.y,1!==V&&0!==V||(c(w.y,-w.x,-w.x,-w.y,0,-1),c(-w.y,w.x,-w.x,-w.y,0,1)),2===V&&(c(w.y-w.x,-w.x-w.y,-w.x,-w.y,0,-1),c(-w.y-w.x,w.x-w.y,-w.x,-w.y,0,1)),1===V&&(c(w.y-w.x,-w.x-w.y,-w.x,-w.y,1,-1),c(-w.y-w.x,w.x-w.y,-w.x,-w.y,1,1));continue}}let K,it,mt=-p(w,m);if(Math.abs(mt)<.01)d(w,m)>0?(H.x=w.x,H.y=w.y,mt=1,K=Number.MAX_VALUE,it=!0):(U(H,m),mt=1,K=1,it=!1);else{H.x=(w.x+m.x)/mt,H.y=(w.y+m.y)/mt,K=D(H);const rt=(K-1)*P*O;it=K>4||rt>Q&&rt>et}nt=H.x,pt=H.y;let dt=R;switch(R){case 0:K<1.05&&(dt=2);break;case 1:K<z&&(dt=2);break;case 2:K>M&&(dt=0)}switch(dt){case 2:if(c(H.x,H.y,-w.x,-w.y,0,-1),c(-H.x,-H.y,-w.x,-w.y,0,1),j)break;if(S){const rt=L?0:St;vt=this.writeVertex(C,b,nt,pt,m.x,m.y,H.x,H.y,0,-1,rt),Wt=this.writeVertex(C,b,nt,pt,m.x,m.y,-H.x,-H.y,0,1,rt)}break;case 0:{const rt=mt<0;let $,Tt,Ct,Rt;if(rt){const Mt=vt;vt=Wt,Wt=Mt,$=Lt,Tt=Et}else $=Et,Tt=Lt;if(it)Ct=rt?U(this.innerPrev,w):E(this.innerPrev,w),Rt=rt?E(this.innerNext,m):U(this.innerNext,m);else{const Mt=rt?st(this.inner,H):q(this.inner,H);Ct=Mt,Rt=Mt}const gt=rt?E(this.bevelStart,w):U(this.bevelStart,w);c(Ct.x,Ct.y,-w.x,-w.y,$.x,$.y);const Ot=c(gt.x,gt.y,-w.x,-w.y,Tt.x,Tt.y);if(j)break;const It=rt?U(this.bevelEnd,m):E(this.bevelEnd,m);if(it){const Mt=this.writeVertex(C,b,nt,pt,-w.x,-w.y,0,0,0,0,St);vt=this.writeVertex(C,b,nt,pt,m.x,m.y,Rt.x,Rt.y,$.x,$.y,St),Wt=this.writeVertex(C,b,nt,pt,m.x,m.y,It.x,It.y,Tt.x,Tt.y,St),this.writeTriangle(Ot,Mt,Wt)}else{if(S){const Mt=this.bevelMiddle;Mt.x=(gt.x+It.x)/2,Mt.y=(gt.y+It.y)/2,B(ft,Mt,-w.x,-w.y),c(Mt.x,Mt.y,-w.x,-w.y,ft.x,ft.y),B(ft,Mt,m.x,m.y),vt=this.writeVertex(C,b,nt,pt,m.x,m.y,Mt.x,Mt.y,ft.x,ft.y,St),Wt=this.writeVertex(C,b,nt,pt,m.x,m.y,Rt.x,Rt.y,$.x,$.y,St)}else{const Mt=vt;vt=Wt,Wt=Mt}c(It.x,It.y,m.x,m.y,Tt.x,Tt.y)}if(rt){const Mt=vt;vt=Wt,Wt=Mt}break}case 1:{const rt=mt<0;let $,Tt;if(rt){const Zt=vt;vt=Wt,Wt=Zt,$=Lt,Tt=Et}else $=Et,Tt=Lt;const Ct=rt?st(this.inner,H):q(this.inner,H);let Rt,gt;it?(Rt=rt?U(this.innerPrev,w):E(this.innerPrev,w),gt=rt?E(this.innerNext,m):U(this.innerNext,m)):(Rt=Ct,gt=Ct);const Ot=rt?E(this.roundStart,w):U(this.roundStart,w),It=rt?U(this.roundEnd,m):E(this.roundEnd,m),Mt=c(Rt.x,Rt.y,-w.x,-w.y,$.x,$.y),Ft=c(Ot.x,Ot.y,-w.x,-w.y,Tt.x,Tt.y);if(j)break;const wt=this.writeVertex(C,b,nt,pt,-w.x,-w.y,0,0,0,0,St);it||this.writeTriangle(vt,Wt,wt);const Ut=st(this.outer,Ct),Dt=this.writeVertex(C,b,nt,pt,m.x,m.y,It.x,It.y,Tt.x,Tt.y,St);let Kt,Gt;const se=K>2;if(se){let Zt;K!==Number.MAX_VALUE?(Ut.x/=K,Ut.y/=K,Zt=d(w,Ut),Zt=(K*(Zt*Zt-1)+1)/Zt):Zt=-1,Kt=rt?E(this.startBreak,w):U(this.startBreak,w),Kt.x+=w.x*Zt,Kt.y+=w.y*Zt,Gt=rt?U(this.endBreak,m):E(this.endBreak,m),Gt.x+=m.x*Zt,Gt.y+=m.y*Zt}B(ft,Ut,-w.x,-w.y);const Yt=this.writeVertex(C,b,nt,pt,-w.x,-w.y,Ut.x,Ut.y,ft.x,ft.y,St);B(ft,Ut,m.x,m.y);const oe=S?this.writeVertex(C,b,nt,pt,m.x,m.y,Ut.x,Ut.y,ft.x,ft.y,St):Yt,jt=wt,re=S?this.writeVertex(C,b,nt,pt,m.x,m.y,0,0,0,0,St):wt;let Qt=-1,$t=-1;if(se&&(B(ft,Kt,-w.x,-w.y),Qt=this.writeVertex(C,b,nt,pt,-w.x,-w.y,Kt.x,Kt.y,ft.x,ft.y,St),B(ft,Gt,m.x,m.y),$t=this.writeVertex(C,b,nt,pt,m.x,m.y,Gt.x,Gt.y,ft.x,ft.y,St)),S?se?(this.writeTriangle(jt,Ft,Qt),this.writeTriangle(jt,Qt,Yt),this.writeTriangle(re,oe,$t),this.writeTriangle(re,$t,Dt)):(this.writeTriangle(jt,Ft,Yt),this.writeTriangle(re,oe,Dt)):se?(this.writeTriangle(wt,Ft,Qt),this.writeTriangle(wt,Qt,$t),this.writeTriangle(wt,$t,Dt)):(this.writeTriangle(wt,Ft,Yt),this.writeTriangle(wt,oe,Dt)),it?(vt=this.writeVertex(C,b,nt,pt,m.x,m.y,gt.x,gt.y,$.x,$.y,St),Wt=Dt):(vt=S?this.writeVertex(C,b,nt,pt,m.x,m.y,gt.x,gt.y,$.x,$.y,St):Mt,this.writeTriangle(vt,re,Dt),Wt=Dt),rt){const Zt=vt;vt=Wt,Wt=Zt}break}}}}}},48860:(bt,yt,_)=>{_.d(yt,{_:()=>_t});_(1153),_(71850);var A=_(5507),q=(_(73795),_(98548),_(30603)),st=_(71369),D=_(31620),p=_(67201);const d=new Map;d.set(D.LW.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),d.set(D.LW.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),d.set(D.LW.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),d.set(D.LW.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),d.set(D.LW.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});var u=_(29541);class n{constructor(m,Q,et){this._start={index:0,vertex:0};const H=function(w,m,Q){const{indicesPerRecord:et,multiplier:H,verticesPerRecord:nt}=d.get(w);return{recordBytes:Q*q.XJ*Uint32Array.BYTES_PER_ELEMENT,indexBytes:H*et*Q*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:H*nt*Q*m}}(m,Q,et),nt=Q/4;this.geometryType=m,this._records=new u.Z(Int32Array,H.recordBytes),this._indices=new u.Z(Uint32Array,H.indexBytes),this._vertices=new u.Z(Uint32Array,H.vertexBytes),this._metrics=new u.Z(Float32Array,0),this._strideInt=nt}serialize(m){const Q=this._records.buffer(),et=this._indices.buffer(),H=this._vertices.buffer(),nt=this._metrics.length?this._metrics.buffer():null,pt=4*this._strideInt;return m.push(Q,et,H),{stride:pt,records:Q,indices:et,vertices:H,metrics:nt}}get strideInt(){return this._strideInt}get recordCount(){return this._records.length/q.XJ}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}vertexEnsureSize(m){this._vertices.ensureSize(m)}indexEnsureSize(m){this._indices.ensureSize(m)}recordStart(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}recordEnd(m,Q,et,H,nt,pt,Lt,Et){this._records.push(m),this._records.push(Q),this._records.push(et),this._records.push(H),this._records.push(nt),this._records.push(pt),this._records.push(Lt),this._records.writeF32(Et)}writeIndex(m){this._indices.push(m)}writeVertex(m){this._vertices.push(m)}writeVertexF32(m){this._vertices.writeF32(m)}copyLastFrom(m,Q,et){const H=m._records.length-q.XJ,nt=m._records.getValue(H),pt=m._records.getValue(H+1),Lt=m._records.getValue(H+2),Et=m._records.getValue(H+4),ft=m._records.getValue(H+6),vt=m._records.getValue(H+7),Wt=this._vertices.length,At=(m._start.vertex-this._vertices.length)/this._strideInt,St=this._indices.length,Xt=this.vertexCount;for(let Y=m._start.index;Y!==m._indices.length;Y++){const c=m._indices.getValue(Y);this._indices.push(c-At)}for(let Y=m._start.vertex;Y!==m._vertices.length;Y++){const c=m._vertices.getValue(Y);this._vertices.push(c)}for(let Y=Wt;Y<=this._vertices.length;Y+=this._strideInt)this._vertices.i1616Add(Y,Q,et);this._records.push(nt),this._records.push(pt),this._records.push(Lt),this._records.push(St),this._records.push(Et),this._records.push(Xt),this._records.push(ft),this._records.push(vt)}}var h=_(66998);const M=128;function z(w){switch(w){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case M:return 1}}function P(w){switch(w){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case M:return 1}}class _t{constructor(m,Q,et,H,nt){this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=Q,this.tileKey=m,this._hasAggregate=H,this._pixelBufferEnabled=nt,this._strideOptions=et}get hasAggregates(){return this._hasAggregate}get hasPixelBufferEnabled(){return this._pixelBufferEnabled}serialize(m){const Q=[];return Q.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self)),this._data.neighbors.forEach((et,H)=>{const nt=1<<H,pt=z(nt),Lt=P(nt),Et=(0,h.M)(new A.Z(this.tileKey),pt,Lt,m),ft=this._serializeTileVertexData(this.tileKey,Et.id,et.vertexData);ft.message.bufferIds=et.displayIds,Q.push(ft)}),Q}_serializeTileVertexData(m,Q,et){var H,nt,pt,Lt,Et;const ft=new Array;return{message:{tileKeyOrigin:m,tileKey:Q,data:{[D.LW.MARKER]:null==(H=et.get(D.LW.MARKER))?void 0:H.serialize(ft),[D.LW.FILL]:null==(nt=et.get(D.LW.FILL))?void 0:nt.serialize(ft),[D.LW.LINE]:null==(pt=et.get(D.LW.LINE))?void 0:pt.serialize(ft),[D.LW.TEXT]:null==(Lt=et.get(D.LW.TEXT))?void 0:Lt.serialize(ft),[D.LW.LABEL]:null==(Et=et.get(D.LW.LABEL))?void 0:Et.serialize(ft)}},transferList:ft}}featureStart(m,Q){this._current.insertAfter=m,this._current.sortKey=Q}featureEnd(){}recordStart(m,Q,et,H){this._current.writer=this._getVertexWriter(et),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=H,this._current.id=m,this._current.materialKey=Q,this._current.geometryType=et,this._current.isDotDensity=!1,this._current.writer.recordStart()}recordCount(){return this._current.writer.recordCount}vertexCount(){return this._current.writer.vertexCount}indexCount(){return this._current.writer.indexCount}vertexEnsureSize(m){this._current.writer.vertexEnsureSize(m)}indexEnsureSize(m){this._current.writer.indexEnsureSize(m)}vertexBounds(m,Q,et,H){this._current.bufferingEnabled&&this._addOverlap(m,Q,et,H)}vertexWrite(m){this._current.writer.writeVertex(m)}vertexWriteF32(m){this._current.writer.writeVertexF32(m)}vertexEnd(){}vertexWriter(){return this._current.writer.vertexWriter}indexWrite(m){this._current.writer.writeIndex(m)}indexWriter(){return this._current.writer.indexWriter}metricWriter(){return this._current.writer.metricWriter}metricStart(m,Q,et,H,nt,pt,Lt,Et){this._current.writer=this._getVertexWriter(D.LW.LABEL);const ft=this._current.writer.metricWriter;ft.push((0,st.jL)(m)),ft.push(Q),ft.push(et),ft.push(H),ft.push(nt),ft.push(pt),ft.push(Lt),ft.push(Et),ft.push(255),this._current.metricBoxLenPointer=ft.push(0)}metricEnd(){const m=this._current.writer.metricWriter;0===m.getValue(this._current.metricBoxLenPointer)&&m.seek(m.length-10)}metricBoxWrite(m,Q,et,H){const nt=this._current.writer.metricWriter;nt.incr(this._current.metricBoxLenPointer),nt.push(0),nt.push(0),nt.push(m),nt.push(Q),nt.push(et),nt.push(H)}recordEnd(){const m=this._current.indexStart,Q=this._current.writer.indexCount;if(m===Q)return!1;this.hasRecords=!0;const et=Q-m,H=this._current.vertStart,nt=this._current.writer.vertexCount-H;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,m,et,H,nt,this._current.sortKey),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===D.LW.LABEL)return!0;const pt=this._current.writer;for(let Lt=0;Lt<8;Lt++){const Et=1<<Lt;if(this._current.overlaps&Et){this._data.neighbors[Lt]||(this._data.neighbors[Lt]={vertexData:new Map,displayIds:new Set});const ft=this._data.neighbors[Lt],vt=this._current.geometryType;if(!ft.vertexData.has(vt)){const Y=(0,p.$_)(vt,this._strideOptions).geometry,c=new n(vt,Y,q.Ip);ft.vertexData.set(vt,c)}const Wt=ft.vertexData.get(this._current.geometryType),At=8,St=512*-z(Et)*At,Xt=512*-P(Et)*At;Wt.copyLastFrom(pt,St,Xt),ft.displayIds.add(this._current.id)}}return!0}_addOverlap(m,Q,et,H){const nt=255^((m<0+et?148:m>=q.I_-et?41:189)|(Q<0+H?224:Q>=q.I_-H?7:231));this._current.overlaps|=nt}_getVertexWriter(m){if(!this._data.self.has(m)){const Q=this._data.self,et=(0,p.$_)(m,this._strideOptions).geometry;Q.set(m,new n(m,et,this.hint.records))}return this._data.self.get(m)}}},21167:(bt,yt,_)=>{_.d(yt,{j:()=>Xt});var tt=_(49996),A=(_(30627),_(18502)),E=_(7808),U=_(2607),q=_(71369),st=_(61414),D=_(22345),p=_(88415),d=_(75244),B=_(48197),W=_(20727),u=_(30603),n=_(31620),h=_(47677),y=_(23155),I=_(44915),J=_(28852);function O(Y){return Y.length-1}function V(Y){let c=0;for(let L=0;L<O(Y);L++)c+=R(Y,L);return c}function R(Y,c,L=1){const[T,Z]=function(Y,c){return Y[c+1]}(Y,c);return Math.sqrt(T*T+Z*Z)*L}class M{constructor(c,L,T,Z,j){this._segments=c,this._index=L,this._distance=T,this._xStart=Z,this._yStart=j,this._done=!1}static create(c){return new M(c,0,0,c[0][0],c[0][1])}clone(){return new M(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(c){return this._index===c._index||c._index===this._index-1&&(0===this._distance||1===c._distance)||c._index===this._index+1&&(1===this._distance||0===c._distance)}leq(c){return this._index<c._index||this._index===c._index&&this._distance<=c._distance}geq(c){return this._index>c._index||this._index===c._index&&this._distance>=c._distance}get _segment(){return this._segments[this._index+1]}get angle(){const c=this.dy,L=(0*c+-1*-this.dx)/(1*this.length);let T=Math.acos(L);return c>0&&(T=2*Math.PI-T),T}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:c,dy:L}=this;return Math.sqrt(c*c+L*L)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<O(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(c,L){const T=this.backwardLength;if(c<=T)return this._distance=(T-c)/this.length,this;let Z=this.backwardLength;for(;this.prev();){if(Z+this.length>c)return this._seekBackwards(c-Z);Z+=this.length}return this._distance=0,L?this:null}seek(c,L=!1){if(c<0)return this._seekBackwards(Math.abs(c),L);if(c<=this.remainingLength)return this._distance=(this.backwardLength+c)/this.length,this;let T=this.remainingLength;for(;this.next();){if(T+this.length>c)return this.seek(c-T,L);T+=this.length}return this._distance=1,L?this:null}}function z(Y,c,L,T=!0){const Z=V(Y),j=M.create(Y),K=Z/2;if(!T)return j.seek(K),void L(j.clone(),0,K+0*c,Z);const it=Math.max((Z-c)/2,0),mt=Math.floor(it/c),dt=K-mt*c;j.seek(dt);for(let rt=-mt;rt<=mt;rt++)j.x<512&&j.x>=0&&j.y<512&&j.y>=0&&L(j.clone(),rt,K+rt*c,Z),j.seek(c)}function b(Y,c){const L=1e-6;if(c<=0)return;const T=Y.length;if(T<3)return;const Z=[];let j=0;Z.push(0);for(let $=1;$<T;$++)j+=(0,J.TK)(Y[$],Y[$-1]),Z.push(j);c=Math.min(c,.2*j);const K=[];K.push(Y[0][0]),K.push(Y[0][1]);const it=Y[T-1][0],mt=Y[T-1][1],dt=(0,J.lu)([0,0],Y[0],Y[1]);(0,J.Fv)(dt),Y[0][0]+=c*dt[0],Y[0][1]+=c*dt[1],(0,J.lu)(dt,Y[T-1],Y[T-2]),(0,J.Fv)(dt),Y[T-1][0]+=c*dt[0],Y[T-1][1]+=c*dt[1];for(let $=1;$<T;$++)Z[$]+=c;Z[T-1]+=c;const rt=.5*c;for(let $=1;$<T-1;$++){let Tt=0,Ct=0,Rt=0;for(let gt=$-1;gt>=0&&!(Z[gt+1]<Z[$]-rt);gt--){const Ot=rt+Z[gt+1]-Z[$],It=Z[gt+1]-Z[gt],Mt=Z[$]-Z[gt]<rt?1:Ot/It;if(Math.abs(Mt)<L)break;const Ft=Mt*Mt,wt=Mt*Ot-.5*Ft*It,Ut=Mt*It/c,Dt=Y[gt+1],Kt=Y[gt][0]-Dt[0],Gt=Y[gt][1]-Dt[1];Tt+=Ut/wt*(Dt[0]*Mt*Ot+.5*Ft*(Ot*Kt-It*Dt[0])-Ft*Mt*It*Kt/3),Ct+=Ut/wt*(Dt[1]*Mt*Ot+.5*Ft*(Ot*Gt-It*Dt[1])-Ft*Mt*It*Gt/3),Rt+=Ut}for(let gt=$+1;gt<T&&!(Z[gt-1]>Z[$]+rt);gt++){const Ot=rt-Z[gt-1]+Z[$],It=Z[gt]-Z[gt-1],Mt=Z[gt]-Z[$]<rt?1:Ot/It;if(Math.abs(Mt)<L)break;const Ft=Mt*Mt,wt=Mt*Ot-.5*Ft*It,Ut=Mt*It/c,Dt=Y[gt-1],Kt=Y[gt][0]-Dt[0],Gt=Y[gt][1]-Dt[1];Tt+=Ut/wt*(Dt[0]*Mt*Ot+.5*Ft*(Ot*Kt-It*Dt[0])-Ft*Mt*It*Kt/3),Ct+=Ut/wt*(Dt[1]*Mt*Ot+.5*Ft*(Ot*Gt-It*Dt[1])-Ft*Mt*It*Gt/3),Rt+=Ut}K.push(Tt/Rt),K.push(Ct/Rt)}K.push(it),K.push(mt);for(let $=0,Tt=0;$<T;$++)Y[$][0]=K[Tt++],Y[$][1]=K[Tt++]}var ct=_(51253);const _t=D.Z.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");const Lt=function(Y){const c=new Map;return L=>(c.has(L)||c.set(L,Y(L)),c.get(L))}(Y=>{let c=0;if(0===Y)return 1/0;for(;!(Y%2);)c++,Y/=2;return c}),Et=Y=>Math.floor(127*Y+127),ft=Y=>Math.floor(10*Y),vt=Y=>Math.round(Y*(254/360));class Wt extends ct.Z{constructor(c,L,T,Z){var j,K,it;super(c,T.font.size,T.haloSize||0,T.font.size,T.color&&(0,W.aH)(T.color)||0,T.haloColor&&(0,W.aH)(T.haloColor)||0,T.horizontalAlignment,T.verticalAlignment,(0,I.N)(L.labelPlacement)?1:0,T.font.decoration,!1,T.angle||0,T.xoffset,T.yoffset,T.lineWidth,T.lineHeight,null,null,null,null,null),this._outLineLabelAngle=0,this._refPlacementPadding=0,this._refPlacementDirX=0,this._refPlacementDirY=0,this._refOffsetX=0,this._refOffsetY=0,this._zoomLevel=0,this.geometryType=n.LW.LABEL,this._allowOverrun=null!=(j=L.allowOverrun)&&j,this._repeatLabel=null==(K=L.repeatLabel)||K,this._labelPosition=null!=(it=L.labelPosition)?it:"curved";const mt=function(Y,c){const L=!!Y.minScale&&c.scaleToZoom(Y.minScale)||0;return(0,p.uZ)(L,0,25.5)}(L,Z),dt=function(Y,c){const L=!!Y.maxScale&&c.scaleToZoom(Y.maxScale)||255;return(0,p.uZ)(L,0,25.5)}(L,Z),rt=L.labelPlacement,[$,Tt]=(0,B.qv)(rt);this._xAlignD=$,this._yAlignD=Tt,this._minZoom=mt,this._maxZoom=dt,this._refPlacementPadding=(0,d.F2)(T.haloSize)+u.Iw,this._repeatLabelDistance=L.repeatLabelDistance?(0,d.F2)(L.repeatLabelDistance):128;const Ct=y.Gq.load(c);Ct.sdf=!0,this._materialKey=Ct.data}static fromLabelClass(c,L){if("esriServerLinePlacementCenterAlong"===c.labelPlacement){const T=c.symbol;T.xoffset=0,T.yoffset=0,T.angle=0,T.font.decoration="none"}return new Wt(c.materialKey,c,c.symbol,L)}get _shapedBox(){return(0,A.Wg)(this._shapingInfo).bounds}setZoomLevel(c){this._zoomLevel=c}bindReferenceTemplate(c){let L=(0,B.g)(this._xAlignD),T=(0,B.tf)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,(0,A.Wi)(c))return void(this._refSymbolAndPlacementOffset=(0,h.Jz)(0,0,Et(L),Et(T)));if("circle"===c.boundsType&&(L||T)){const K=Math.sqrt(L*L+T*T);L/=K,T/=K}const Z=Math.max(c.height,c.width),j=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=(0,h.Jz)(j,Z,Et(L),Et(T)),this._referenceSize=Z,this._refPlacementDirX=L,this._refPlacementDirY=T,this._refOffsetX=c.xOffset,this._refOffsetY=c.yOffset}_write(c,L){if((0,A.Wi)(this._shapingInfo))return;const T=this._shapingInfo,Z=L.getDisplayId(),j="esriGeometryPolygon"===L.geometryType?L.readLegacyCentroid():L.readLegacyGeometry();if(j)switch(this.current={out:c,inId:Z,inShaping:T,zoomLevel:this._zoomLevel},L.geometryType){case"esriGeometryPolyline":this._placeLineLabels(j);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(j);break;default:((Y,c="mapview-labeling")=>{_t.error(new st.Z(c,Y))})("mapview-labeling",`Geometry of type ${L.geometryType} is not supported`)}}_isVisible(c,L){const T=ft(this.current.zoomLevel);return ft(c)<=T&&T<=ft(L)}_placePointLabels(c){const{out:L,inId:T,inShaping:Z}=this.current;this._writeGlyphs(L,T,c,Z)}_placeLineLabels(c){const L=function(Y,c){const L=c;for(let T=0;T<Y.length;T++){let Z=Y[T];const j=[];j.push(Z[0]);for(let it=1;it<Z.length;it++){let[mt,dt]=j[it-1];mt+=Z[it][0],dt+=Z[it][1],j.push([mt,dt])}b(j,L);const K=[];K.push(j[0]);for(let it=1;it<j.length;it++){const[mt,dt]=j[it-1],[rt,$]=j[it],Tt=Math.round(rt-mt),Ct=Math.round($-dt);K.push([Tt,Ct])}Y[T]=K,Z=K}return Y}(c.paths,this.current.inShaping.bounds.width),T=this._placeSubdivGlyphs.bind(this),Z=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const j of L)z(j,Z,T,this._repeatLabel)}_placeSubdivGlyphs(c,L,T,Z){const j=Lt(L),K=this._shapedBox.width/2,it=Math.sqrt(this._repeatLabelDistance)/2,mt=Math.min(T,Z-T),dt=Math.log2(mt/(it+K/2)),rt=0===L?dt:Math.min(j,dt),$=Math.max(this._minZoom,this.current.zoomLevel+1-rt),Tt=this.current.zoomLevel-$,Ct=this._shapedBox.width/2*be(2,Tt);this.current.inShaping.isMultiline?0===L&&this._placeStraight(c,$):this._allowOverrun&&Tt<0?this._placeStraightAlong(c,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(c,$):"curved"===this._labelPosition&&this._placeCurved(c,$,Ct)}_placeStraight(c,L){const{out:T,inId:Z,inShaping:j}=this.current;this._writeGlyphs(T,Z,c,j,L)}_placeCurved(c,L,T){const{out:Z,inId:j}=this.current;Z.metricStart(j,L,c.x,c.y,0,0,0,0);const K=c.clone(),it=c.angle*(180/Math.PI)%360,mt=(c.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=vt(it),this._placeFirst(K,L,1),this._placeBack(c,K,L,T,1),this._placeForward(c,K,L,T,1),this._outLineLabelAngle=vt(mt),this._placeFirst(K,L,0),this._placeBack(c,K,L,T,0),this._placeForward(c,K,L,T,0),Z.metricEnd()}_placeStraightAlong(c,L){const{out:T,inId:Z}=this.current;T.metricStart(Z,L,c.x,c.y,0,0,0,0);const j=c.clone(),K=c.angle*(180/Math.PI)%360,it=(c.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=vt(K),this._placeFirst(j,L,1,!0),this._outLineLabelAngle=vt(it),this._placeFirst(j,L,0,!0),T.metricEnd()}_placeBack(c,L,T,Z,j){const K=c.clone();let it=c.backwardLength+0;for(;K.prev()&&!(it>=Z);)this._placeOnSegment(K,L,it,T,-1,j),it+=K.length+0}_placeForward(c,L,T,Z,j){const K=c.clone();let it=c.remainingLength+0;for(;K.next()&&!(it>=Z);)this._placeOnSegment(K,L,it,T,1,j),it+=K.length+0}_placeFirst(c,L,T,Z=!1){const j=c,K=this.current.inShaping,it=K.glyphs,mt=this.current.zoomLevel,{out:dt,inId:rt}=this.current;for(const $ of it){const Tt=$.x>K.bounds.x?T:1-T,Ct=Tt*c.remainingLength+(1-Tt)*c.backwardLength,Rt=Math.abs($.x+$.width/2-K.bounds.x),gt=Math.max(0,mt+Math.log2(Rt/(Ct+0))),Ot=Math.max(L,Z?0:gt);if($.maxZoom=25,$.angle=c.angle+(1-T)*Math.PI,$.minZoom=Ot,this._writeGlyph(dt,rt,j.x,j.y,$),T&&this._isVisible($.minZoom,$.maxZoom)){const It=$.bounds;dt.metricBoxWrite(It.center[0],It.center[1],It.width,It.height)}}}_placeOnSegment(c,L,T,Z,j,K){const it=this.current.inShaping.glyphs,{out:mt,inId:dt}=this.current,rt=this.current.inShaping,$=this.current.zoomLevel,Tt=c.dx/c.length,Ct=c.dy/c.length,Rt={x:c.x+T*-j*Tt,y:c.y+T*-j*Ct};for(const gt of it){const Ot=gt.x>rt.bounds.x?K:1-K;if(!(Ot&&1===j||!Ot&&-1===j))continue;const It=Math.abs(gt.x+gt.width/2-rt.bounds.x),Mt=Math.max(0,$+Math.log2(It/T)-.1),Ft=Math.max(Z,$+Math.log2(It/(T+c.length+0)));if(0!==Mt&&(gt.angle=c.angle+(1-K)*Math.PI,gt.minZoom=Ft,gt.maxZoom=Mt,this._writeGlyph(mt,dt,Rt.x,Rt.y,gt),K&&this._isVisible(gt.minZoom,gt.maxZoom))){const wt=gt.bounds,Ut=c.x-L.x,Dt=c.y-L.y;mt.metricBoxWrite(wt.center[0]+Ut,wt.center[1]+Dt,wt.width,wt.height)}}}_writeGlyphs(c,L,T,Z,j=this._minZoom){if(T.x<0||T.x>=512||T.y<0||T.y>=512)return;const K=T.x+this._refOffsetX,it=T.y-this._refOffsetY;for(const $ of Z.glyphs)$.minZoom=j,$.maxZoom=this._maxZoom,this._writeGlyph(c,L,K,it,$);const mt=this._refPlacementDirX,dt=this._refPlacementDirY,rt=Z.boundsT;c.metricStart(L,j,K,it,mt,dt,this._referenceSize,this._materialKey),c.metricBoxWrite(rt.center[0],rt.center[1],rt.width,rt.height),c.metricEnd()}_writeVertexCommon(c,L,T,Z){const j=this._color,K=this._haloColor,it=(0,h.Jz)(0,0,this._size,this._haloSize),mt=Math.max(Z.minZoom,this._minZoom),dt=Math.min(Z.maxZoom,this._maxZoom),rt=(0,h.Jz)(ft(mt),ft(dt),this._outLineLabelAngle,0);c.vertexWrite(T),c.vertexWrite(L),c.vertexWrite(j),c.vertexWrite(K),c.vertexWrite(it),c.vertexWrite(this._refSymbolAndPlacementOffset),c.vertexWrite(rt)}}var At=_(38981),St=_(75596);class Xt{constructor(c,L,T){this._loadPromise=(0,U.j)(),this._geometryType=c,this._idField=L,this._templateStore=T}update(c,L){(0,A.pC)(c.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(c.mesh.labels,L)),this._schema=c}_createLabelTemplates(c,L){const T=new Map;if("simple"===c.type){for(const Z of c.classes){const j=Wt.fromLabelClass(Z,L);T.set(Z.index,j)}return T}for(const Z in c.classes){const j=c.classes[Z];for(const K of j){const it=Wt.fromLabelClass(K,L);T.set(K.index,it)}}return T}get templates(){return this._templateStore}analyze(c,L,T,Z,j,K,it){var mt=this;return(0,tt.Z)(function*(){if((0,E.Hc)(it))return;let dt;"dictionary"===T.type&&(dt=yield T.analyze(mt._idField,c.copy(),L,j,K,it));let rt=0;for(;c.next();){let $;if($=dt?dt[rt++]:(0,A.pC)(Z)&&(0,q.nE)(c.getDisplayId())&&1!==c.readAttribute("cluster_count")?Z.match(mt._idField,c,mt._geometryType,j,K):T.match(mt._idField,c,mt._geometryType,j,K),c.setGroupId($),(0,St.Sl)($)){const Tt=mt._templateStore.getDynamicTemplateGroup($);for(const Ct of Tt)Ct&&Ct.analyze&&Ct.analyze(mt._templateStore,c,j,K)}}return yield mt._loadPromise,mt._templateStore.finalize(it)})()}analyzeGraphics(c,L,T,Z,j,K){var it=this;return(0,tt.Z)(function*(){if((0,E.Hc)(K))return;const mt=c.getCursor();for(T&&(yield T.analyze(it._idField,mt.copy(),L,Z,j,K));mt.next();){let dt=mt.getGroupId();if(null!=dt&&-1!==dt||(dt=T.match(it._idField,mt,mt.geometryType,Z,j),mt.setGroupId(dt)),(0,St.Sl)(dt)){const rt=it._templateStore.getDynamicTemplateGroup(dt);for(const $ of rt)$&&$.analyze&&$.analyze(it._templateStore,mt,Z,j)}mt.setGroupId(dt)}return yield it._loadPromise,it._templateStore.finalize(K)})()}writeGraphic(c,L,T){const Z=L.getGroupId(),j=L.getDisplayId(),K=this._templateStore.getTemplateGroup(Z);if(c.featureStart(L.insertAfter,0),null!=j){if((0,St.Sl)(Z))for(const it of K)it&&it.bindFeature(L,null,null);if(K){for(const it of K)it&&it.write(c,L,T);c.featureEnd()}}}writeCursor(c,L,T,Z,j,K){const it=L.getGroupId(),mt=L.getDisplayId(),dt=this._templateStore.getTemplateGroup(it),rt=this._schema.mesh.sortKey;let $=0;if((0,A.pC)(rt)&&($=null!=rt.fieldIndex?L.getComputedNumericAtIndex(rt.fieldIndex):null!=rt.field?L.readAttribute(rt.field):L.readAttribute(this._idField),$*="asc"===rt.order?1:-1),c.featureStart(0,null==$||isNaN($)?0:$),null!=mt&&dt){if((0,St.Sl)(it))for(const Tt of dt)Tt.bindFeature(L,T,Z);for(const Tt of dt)Tt.write(c,L,j);if((0,A.pC)(K)&&c.hasRecords){const Tt=K&&this._findLabelRef(dt);this._writeLabels(c,L,K,Tt,j)}c.featureEnd()}}_findLabelRef(c){for(const L of c)if(L instanceof At.Z)return L;return null}_writeLabels(c,L,T,Z,j){for(const K of T)if((0,A.pC)(K)&&K){const{glyphs:it,rtl:mt,index:dt}=K,rt=this._labelTemplates.get(dt);rt.setZoomLevel(j),rt.bindReferenceTemplate(Z),rt.bindTextInfo(it,mt),rt.write(c,L,null)}}}},84440:(bt,yt,_)=>{_.d(yt,{Z:()=>u});var tt=_(18502),at=_(75244),A=_(62039),E=_(63319),U=_(68292),q=_(74181),st=_(42187),D=_(87009),p=_(31620),d=_(47677);const B=3.14159265359/180,u=n=>class extends n{constructor(...h){super(...h),this.angle=0,this.xOffset=0,this.yOffset=0,this.width=0,this.height=0,this.boundsType="square",this._anchorX=0,this._anchorY=0,this._computedWidth=0,this._computedHeight=0,this._vertexBoundsScaleX=1,this._vertexBoundsScaleY=1,this._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},this.geometryType=p.LW.MARKER}_write(h,y,I){const J=y.getDisplayId();h.recordStart(J,this._materialKey,this.geometryType,!0),this._writeGeometry(h,y,J,I),h.recordEnd()}_writeGeometry(h,y,I,J){if((0,tt.pC)(this._markerPlacement))return this._writePlacedMarkers(h,y,J);const N=J?(0,st.oB)((0,st.GH)(J),2):"esriGeometryPolygon"===y.geometryType?y.readCentroid():y.readGeometryForDisplay();if(!(0,tt.Wi)(N)){if(N.isPoint){const[O,V]=N.coords;return!h.hasAggregates&&h.hasPixelBufferEnabled&&(O<0||O>=512||V<0||V>=512)?void 0:this._writeVertices(h,I,this._getPos(O,V),O,V)}N.forEachVertex((O,V)=>this._writeVertices(h,I,this._getPos(O,V),O,V))}}_writePlacedMarkers(h,y,I){const J=null!=I?I:y.readLegacyGeometryForDisplay(),N=D.i.getPlacement(J,(0,tt.Wg)(this._markerPlacement),(0,at.F2)(1));if(!N)return;const O=y.getDisplayId(),V=(0,q.c)(),R=(0,E.c)();let P=N.next();for(;null!=P;){const{tx:S,ty:C}=P;S>=-128&&S<=640&&C>=-128&&C<=640&&(this._applyTransformation(R,V,P.getAngle()/B),this._writeVertices(h,O,this._getPos(S,C),S,C)),P=N.next()}}_writeVertices(h,y,I,J,N){const O=h.vertexCount();h.vertexBounds(J+this.xOffset,N-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY),h.vertexWrite(I),h.vertexWrite(this._offsetUpperLeft),h.vertexWrite(this._texUpperLeft),h.vertexWrite(this._bitestAndDistRatio),h.vertexWrite(y),h.vertexWrite(this._fillColor),h.vertexWrite(this._outlineColor),h.vertexWrite(this._sizeOutlineWidth),h.vertexWrite(this._minMaxZoom),h.vertexEnd(),h.vertexWrite(I),h.vertexWrite(this._offsetUpperRight),h.vertexWrite(this._texUpperRight),h.vertexWrite(this._bitestAndDistRatio),h.vertexWrite(y),h.vertexWrite(this._fillColor),h.vertexWrite(this._outlineColor),h.vertexWrite(this._sizeOutlineWidth),h.vertexWrite(this._minMaxZoom),h.vertexEnd(),h.vertexWrite(I),h.vertexWrite(this._offsetBottomLeft),h.vertexWrite(this._texBottomLeft),h.vertexWrite(this._bitestAndDistRatio),h.vertexWrite(y),h.vertexWrite(this._fillColor),h.vertexWrite(this._outlineColor),h.vertexWrite(this._sizeOutlineWidth),h.vertexWrite(this._minMaxZoom),h.vertexEnd(),h.vertexWrite(I),h.vertexWrite(this._offsetBottomRight),h.vertexWrite(this._texBottomRight),h.vertexWrite(this._bitestAndDistRatio),h.vertexWrite(y),h.vertexWrite(this._fillColor),h.vertexWrite(this._outlineColor),h.vertexWrite(this._sizeOutlineWidth),h.vertexWrite(this._minMaxZoom),h.vertexEnd(),h.indexWrite(O+0),h.indexWrite(O+1),h.indexWrite(O+2),h.indexWrite(O+1),h.indexWrite(O+3),h.indexWrite(O+2)}_applyTransformation(h,y,I=0){(0,A.i)(h),(0,A.t)(h,h,(0,q.f)(this.xOffset,-this.yOffset)),this.angle+I!==0&&(0,A.r)(h,h,B*(this.angle+I));const J=this._computedWidth,N=this._computedHeight,O=(this._anchorX-.5)*J,V=(this._anchorY-.5)*N;(0,U.s)(y,O,V),(0,U.t)(y,y,h),this._offsetUpperLeft=(0,d.UJ)(16*y[0],16*y[1]),this._offsets.xUpperLeft=y[0],this._offsets.yUpperLeft=y[1],(0,U.s)(y,O+J,V),(0,U.t)(y,y,h),this._offsetUpperRight=(0,d.UJ)(16*y[0],16*y[1]),this._offsets.xUpperRight=y[0],this._offsets.yUpperRight=y[1],(0,U.s)(y,O,V+N),(0,U.t)(y,y,h),this._offsetBottomLeft=(0,d.UJ)(16*y[0],16*y[1]),this._offsets.xBottomLeft=y[0],this._offsets.yBottomLeft=y[1],(0,U.s)(y,O+J,V+N),(0,U.t)(y,y,h),this._offsetBottomRight=(0,d.UJ)(16*y[0],16*y[1]),this._offsets.xBottomRight=y[0],this._offsets.yBottomRight=y[1]}_getPos(h,y){return(0,d.UJ)(Math.round(8*h),Math.round(8*y))}}},26387:(bt,yt,_)=>{_.d(yt,{Z:()=>B});var tt=_(18502),at=_(75244),A=_(42187),E=_(87009),U=_(30603),q=_(31620),st=_(47677),D=_(23155),p=_(20800);const B=W=>class extends W{constructor(...u){super(...u),this._isCIM=!1,this._vertexBoundsScale=1,this.geometryType=q.LW.TEXT,this._aux=(0,st.Jz)(0,0,this._referenceSize,this._bitset)}bindTextInfo(u,n){u&&u.length?this._shapingInfo=(0,tt.Po)(u,h=>(0,p.Nr)(h,n,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:U.xm*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):this._shapingInfo=null}_write(u,n,h){const y=n.getDisplayId();this._writeGeometry(u,n,y,h)}_writeGeometry(u,n,h,y){const I=this._shapingInfo;if((0,tt.Wi)(I))return;if((0,tt.pC)(this._textPlacement)){const N=null!=y?y:n.readLegacyGeometryForDisplay();return this._writePlacedText(u,h,N,I)}const J=y?(0,A.oB)((0,A.GH)(y),2):"esriGeometryPolygon"===n.geometryType?n.readCentroid():n.readGeometryForDisplay();if(!(0,tt.Wi)(J)){if(J.isPoint){const[N,O]=J.coords;return!u.hasAggregates&&u.hasPixelBufferEnabled&&(N<0||N>=512||O<0||O>=512)?void 0:this._writeGlyphs(u,h,{x:N,y:O},I)}J.forEachVertex((N,O)=>this._writeGlyphs(u,h,{x:N,y:O},I))}}_writePlacedText(u,n,h,y){const I=(0,tt.Wg)(this._textPlacement),J=E.i.getPlacement(h,I,(0,at.F2)(1));if(!J)return;let N=J.next();for(;null!=N;){const O=N.getAngle();y.setRotation(O);const V=N.tx,R=N.ty;V<0||V>=512||R<0||R>=512||(this._writeGlyphs(u,n,{x:V,y:R},y),y.setRotation(-O)),N=J.next()}}_writeGlyphs(u,n,h,y){const I=D.m2.load(this._materialKey),J=(0,st.UJ)(Math.round(8*h.x),Math.round(8*h.y)),N=this._vertexBoundsScale,O=y.bounds,V=2*Math.max(O.width,O.height);for(const R of y.glyphs)I.textureBinding=R.textureBinding,u.recordStart(n,I.data,this.geometryType,!0),u.vertexBounds(h.x+O.x+this._xOffset,h.y+O.y-this._yOffset,V*N,V*N),this._writeVertices(u,n,J,R),u.recordEnd()}_writeGlyph(u,n,h,y,I){const J=D.m2.load(this._materialKey),N=(0,st.UJ)(Math.round(8*h),Math.round(8*y));J.textureBinding=I.textureBinding,u.recordStart(n,J.data,this.geometryType,!0);const O=I.bounds,V=this._vertexBoundsScale;u.vertexBounds(h+O.x*V,y+O.y*V,O.width*V,O.height*V),this._writeVertices(u,n,N,I),u.recordEnd()}_writeVertices(u,n,h,y){const I=u.vertexCount();this._writeVertexCommon(u,n,h,y),u.vertexWrite(y.offsets.upperLeft),u.vertexWrite(y.texcoords.upperLeft),u.vertexEnd(),this._writeVertexCommon(u,n,h,y),u.vertexWrite(y.offsets.upperRight),u.vertexWrite(y.texcoords.upperRight),u.vertexEnd(),this._writeVertexCommon(u,n,h,y),u.vertexWrite(y.offsets.lowerLeft),u.vertexWrite(y.texcoords.lowerLeft),u.vertexEnd(),this._writeVertexCommon(u,n,h,y),u.vertexWrite(y.offsets.lowerRight),u.vertexWrite(y.texcoords.lowerRight),u.vertexEnd(),u.indexWrite(I+0),u.indexWrite(I+1),u.indexWrite(I+2),u.indexWrite(I+1),u.indexWrite(I+3),u.indexWrite(I+2)}_writeVertexCommon(u,n,h,y){const I=this._color,J=this._haloColor,N=(0,st.Jz)(0,0,this._referenceSize,this._bitset),O=(0,st.Jz)(0,0,this._size,this._haloSize);u.vertexWrite(h),u.vertexWrite(n),u.vertexWrite(I),u.vertexWrite(J),u.vertexWrite(O),u.vertexWrite(N),u.vertexWrite(this._minMaxZoom)}}},38981:(bt,yt,_)=>{_.d(yt,{Z:()=>W});var tt=_(18502),at=_(75244),A=_(63319),E=_(74181),U=_(20727),q=_(30603),st=_(47677),D=_(23155),p=_(28852),d=_(84440),B=_(82530);class W extends((0,d.Z)(B.Z)){constructor(n,h,y,I,J,N,O,V,R,M,z,P,S,C,b,ct,_t,w,m,Q,et,H,nt){super(),this.angle=I,this.height=O,this.width=N,this.xOffset=h*m,this.yOffset=y*m,this._markerPlacement=Q,this._effects=et,this._anchorX=.5-(.5+ct)*b.width/b.width,this._anchorY=.5-(.5+_t)*b.height/b.height,this._minMaxZoom=(0,st.UJ)(Math.round(H*q.MI),Math.round(nt*q.MI));const pt=(1===C?q.Tz:q.CQ)|(z?q.Uh:0)|(S?q.oK:0)|(P?q.e0:0),Lt=b&&b.sdf,Et=D.mE.load(n);Et.sdf=Lt,Et.pattern=!0,Et.textureBinding=b.textureBinding,this._materialKey=Et.data,this._fillColor=J,this._outlineColor=R,this._sizeOutlineWidth=(0,st.Jz)(Math.round(Math.min(Math.sqrt(128*N),255)),Math.round(Math.min(Math.sqrt(128*O),255)),Math.round(Math.min(Math.sqrt(128*M),255)),Math.round(Math.min(Math.sqrt(128*V),255)));const ft=b.rect.x+q.fL,vt=b.rect.y+q.fL,Wt=ft+b.width,At=vt+b.height;this._offsets.xUpperLeft=ft,this._offsets.yUpperLeft=vt,this._offsets.xUpperRight=Wt,this._offsets.yUpperRight=vt,this._offsets.xBottomLeft=ft,this._offsets.yBottomLeft=At,this._offsets.xBottomRight=Wt,this._offsets.yBottomRight=At,this._texUpperLeft=(0,st.UJ)(ft,vt),this._texUpperRight=(0,st.UJ)(Wt,vt),this._texBottomLeft=(0,st.UJ)(ft,At),this._texBottomRight=(0,st.UJ)(Wt,At),N*=w,O*=w,N*=m,O*=m;const St=Math.round(64*w);this._bitestAndDistRatio=(0,st.UJ)(pt,St),this._computedWidth=N,this._computedHeight=O;const Xt=(0,E.c)(),Y=(0,A.c)();this._applyTransformation(Y,Xt)}static fromCIMMarker(n,h,y){const I=h&&h.width||1,J=h&&h.height||1,N=n.size,O=I/J*n.scaleX,V=n.scaleSymbolsProportionally&&n.frameHeight?N/n.frameHeight:1;let R=(0,U.t2)(n.color);const M=(0,U.t2)(n.outlineColor),z=(0,at.F2)(N),P=z*O,S=(0,at.F2)(n.offsetX||0),C=(0,at.F2)(n.offsetY||0),b=(0,at.F2)(n.outlineWidth||0)*V,ct=n.alignment||0,_t=(0,at.F2)(n.referenceSize),[w,m]=(0,p._f)(n.scaleInfo,y);h.sdf||0!==R||(R=-1);let Q=n.rotation||0;n.rotateClockwise||(Q=-Q);let et=0,H=0;const nt=n.anchorPoint;nt&&(n.isAbsoluteAnchorPoint?N&&(et=-nt.x/(N*O),H=nt.y/N):(et=nt.x,H=nt.y));const pt=new W(n.materialKey,S,C,Q,R,P,z,_t,M,b,n.colorLocked,n.scaleSymbolsProportionally,!1,ct,h,et,H,n.sizeRatio,(0,tt.Pt)(n.scaleFactor,1),n.markerPlacement,n.effects,w,m);return pt._vertexBoundsScaleX=n.maxVVSize?n.maxVVSize/P:1,pt._vertexBoundsScaleY=n.maxVVSize?n.maxVVSize/z:1,pt}static fromPictureMarker(n,h){const y=Math.round((0,at.F2)(n.width)),I=Math.round((0,at.F2)(n.height)),J=q.ru,N=Math.round((0,at.F2)(n.xoffset||0)),O=Math.round((0,at.F2)(n.yoffset||0)),V=new W(n.materialKey,N,O,n.angle,J,y,I,I,0,0,!1,!1,!1,0,h,0,0,1,1,null,null,p.Xe,p.eW);return V._vertexBoundsScaleX=n.maxVVSize?n.maxVVSize/n.width:1,V._vertexBoundsScaleY=n.maxVVSize?n.maxVVSize/n.height:1,V}static fromSimpleMarker(n,h){const y=(0,U.aH)(n.color),I=Math.round((0,at.F2)(n.size)),J=I,N=Math.round((0,at.F2)(n.xoffset||0)),O=Math.round((0,at.F2)(n.yoffset||0)),V=n.style,R=n.outline,M=0|(R&&R.color&&(0,U.aH)(R.color)),z=0|(R&&R.width&&Math.round((0,at.F2)(R.width))),P=new W(n.materialKey,N,O,n.angle,y,I,J,J,M,z,!1,!1,"esriSMSCross"===V||"esriSMSX"===V,0,h,0,0,126/64,1,null,null,p.Xe,p.eW);return P.boundsType="esriSMSCircle"===V?"circle":"square",P._vertexBoundsScaleX=n.maxVVSize?n.maxVVSize/n.size:1,P._vertexBoundsScaleY=n.maxVVSize?n.maxVVSize/n.size:1,P}static fromLineSymbolMarker(n,h){const y=(0,U.aH)(n.color),J=Math.round((0,at.F2)(6*n.lineWidth)),N=J,O="cross"===n.style||"x"===n.style;let V;switch(n.placement){case"begin-end":V="Both";break;case"begin":V="JustBegin";break;case"end":V="JustEnd";break;default:V="None"}const R={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:V,offsetAlongLine:0},M=new W(n.materialKey,0,0,0,y,J,N,N/6,y,O?Math.round((0,at.F2)(n.lineWidth)):0,!1,!1,O,1,h,0,0,126/64,1,R,null,p.Xe,p.eW);return M.boundsType="circle"===n.style?"circle":"square",M}}},82530:(bt,yt,_)=>{_.d(yt,{Z:()=>A});var tt=_(18502),at=_(7019);class A{bindFeature(U,q,st){}write(U,q,st){var D;if((0,tt.Wi)(this._effects)||0===(null==(D=this._effects)?void 0:D.length))return this._write(U,q);const p=at.j.executeEffects(this._effects,q.readLegacyGeometryForDisplay());let d=at.j.next(p);for(;d;)this._write(U,q,d),d=at.j.next(p)}_write(U,q,st){}}},75596:(bt,yt,_)=>{_.d(yt,{Wr:()=>Ne,Sl:()=>Ie});var tt=_(49996),at=_(61414),A=_(22345),E=_(7808),U=_(70338),q=_(31620),st=_(23155),D=_(75244),p=_(20727),d=_(30603),B=_(76272),W=_(47677),u=_(28852),n=_(18502),h=_(42187),I=(_(2226),_(2607)),J=_(82760),N=_(24145);function O(l,i,s,a,r,f,x){j=0;const g=(a-s)*f,v=r&&r.length,F=v?(r[0]-s)*f:g;let G,ot,ht,X,k,xt=V(i,s,a,0,F,f,!0);if(xt&&xt.next!==xt.prev){if(v&&(xt=function(l,i,s,a,r,f){const x=new Array;for(let g=0,v=a.length;g<v;g++){const F=V(l,i,s,a[g]*f,g<v-1?a[g+1]*f:s*f,f,!1);F===F.next&&(F.steiner=!0),x.push(b(F))}x.sort(Wt);for(const g of x)_t(g,r),r=R(r,r.next);return r}(i,s,a,r,xt,f)),g>80*f){G=ht=i[0+s*f],ot=X=i[1+s*f];for(let lt=f;lt<F;lt+=f){const ut=i[lt+s*f],Pt=i[lt+1+s*f];G=Math.min(G,ut),ot=Math.min(ot,Pt),ht=Math.max(ht,ut),X=Math.max(X,Pt)}k=Math.max(ht-G,X-ot),k=0!==k?1/k:0}M(xt,l,f,G,ot,k,x,0)}}function V(l,i,s,a,r,f,x){let g;if(x===function(l,i,s,a,r,f){let x=0;for(let g=a,v=r-f;g<r;g+=f)x+=(l[v+i*f]-l[g+i*f])*(l[g+1+i*f]+l[v+1+i*f]),v=g;return x}(l,i,0,a,r,f)>0)for(let v=a;v<r;v+=f)g=S(v+i*f,l[v+i*f],l[v+1+i*f],g);else for(let v=r-f;v>=a;v-=f)g=S(v+i*f,l[v+i*f],l[v+1+i*f],g);return g&&vt(g,g.next)&&(C(g),g=g.next),g}function R(l,i=l){if(!l)return l;let s,a=l;do{if(s=!1,a.steiner||!vt(a,a.next)&&0!==et(a.prev,a,a.next))a=a.next;else{if(C(a),a=i=a.prev,a===a.next)break;s=!0}}while(s||a!==i);return i}function M(l,i,s,a,r,f,x,g){if(!l)return;!g&&f&&(l=m(l,a,r,f));let v=l;for(;l.prev!==l.next;){const F=l.prev,G=l.next;if(f?P(l,a,r,f):z(l))i.push(F.index/s+x),i.push(l.index/s+x),i.push(G.index/s+x),C(l),l=G.next,v=G.next;else if((l=G)===v){g?1===g?M(l=At(l,i,s,x),i,s,a,r,f,x,2):2===g&&St(l,i,s,a,r,f,x):M(R(l),i,s,a,r,f,x,1);break}}}function z(l){const i=l.prev,s=l,a=l.next;if(et(i,s,a)>=0)return!1;let r=l.next.next;const f=r;let x=0;for(;r!==l.prev&&(0===x||r!==f);){if(x++,Lt(i.x,i.y,s.x,s.y,a.x,a.y,r.x,r.y)&&et(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function P(l,i,s,a){const r=l.prev,f=l,x=l.next;if(et(r,f,x)>=0)return!1;const g=r.x<f.x?r.x<x.x?r.x:x.x:f.x<x.x?f.x:x.x,v=r.y<f.y?r.y<x.y?r.y:x.y:f.y<x.y?f.y:x.y,F=r.x>f.x?r.x>x.x?r.x:x.x:f.x>x.x?f.x:x.x,G=r.y>f.y?r.y>x.y?r.y:x.y:f.y>x.y?f.y:x.y,ot=ft(g,v,i,s,a),ht=ft(F,G,i,s,a);let X=l.prevZ,k=l.nextZ;for(;X&&X.z>=ot&&k&&k.z<=ht;){if(X!==l.prev&&X!==l.next&&Lt(r.x,r.y,f.x,f.y,x.x,x.y,X.x,X.y)&&et(X.prev,X,X.next)>=0||(X=X.prevZ,k!==l.prev&&k!==l.next&&Lt(r.x,r.y,f.x,f.y,x.x,x.y,k.x,k.y)&&et(k.prev,k,k.next)>=0))return!1;k=k.nextZ}for(;X&&X.z>=ot;){if(X!==l.prev&&X!==l.next&&Lt(r.x,r.y,f.x,f.y,x.x,x.y,X.x,X.y)&&et(X.prev,X,X.next)>=0)return!1;X=X.prevZ}for(;k&&k.z<=ht;){if(k!==l.prev&&k!==l.next&&Lt(r.x,r.y,f.x,f.y,x.x,x.y,k.x,k.y)&&et(k.prev,k,k.next)>=0)return!1;k=k.nextZ}return!0}function S(l,i,s,a){const r=L.create(l,i,s);return a?(r.next=a.next,r.prev=a,a.next.prev=r,a.next=r):(r.prev=r,r.next=r),r}function C(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function b(l){let i=l,s=l;do{(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),i=i.next}while(i!==l);return s}function _t(l,i){if(i=function(l,i){let s=i;const a=l.x,r=l.y;let f,x=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){const ht=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(ht<=a&&ht>x){if(x=ht,ht===a){if(r===s.y)return s;if(r===s.next.y)return s.next}f=s.x<s.next.x?s:s.next}}s=s.next}while(s!==i);if(!f)return null;if(a===x)return f.prev;const g=f,v=f.x,F=f.y;let G,ot=1/0;for(s=f.next;s!==g;)a>=s.x&&s.x>=v&&a!==s.x&&Lt(r<F?a:x,r,v,F,r<F?x:a,r,s.x,s.y)&&(G=Math.abs(r-s.y)/(a-s.x),(G<ot||G===ot&&s.x>f.x)&&Et(s,l)&&(f=s,ot=G)),s=s.next;return f}(l,i)){const s=c(i,l);R(s,s.next)}}function m(l,i,s,a){for(let r;r!==l;r=r.next){if(r=r||l,null===r.z&&(r.z=ft(r.x,r.y,i,s,a)),r.prev.next!==r||r.next.prev!==r)return r.prev.next=r,r.next.prev=r,m(l,i,s,a);r.prevZ=r.prev,r.nextZ=r.next}return l.prevZ.nextZ=null,l.prevZ=null,function(l){let i,s=1;for(;;){let a,r=l;l=null,i=null;let f=0;for(;r;){f++,a=r;let x=0;for(;x<s&&a;x++)a=a.nextZ;let g=s;for(;x>0||g>0&&a;){let v;0===x?(v=a,a=a.nextZ,g--):0!==g&&a?r.z<=a.z?(v=r,r=r.nextZ,x--):(v=a,a=a.nextZ,g--):(v=r,r=r.nextZ,x--),i?i.nextZ=v:l=v,v.prevZ=i,i=v}r=a}if(i.nextZ=null,s*=2,f<2)return l}}(l)}function et(l,i,s){return(i.y-l.y)*(s.x-i.x)-(i.x-l.x)*(s.y-i.y)}function H(l,i,s,a){return!!(vt(l,i)&&vt(s,a)||vt(l,a)&&vt(s,i))||et(l,i,s)>0!=et(l,i,a)>0&&et(s,a,l)>0!=et(s,a,i)>0}function Lt(l,i,s,a,r,f,x,g){return(r-x)*(i-g)-(l-x)*(f-g)>=0&&(l-x)*(a-g)-(s-x)*(i-g)>=0&&(s-x)*(f-g)-(r-x)*(a-g)>=0}function Et(l,i){return et(l.prev,l,l.next)<0?et(l,i,l.next)>=0&&et(l,l.prev,i)>=0:et(l,i,l.prev)<0||et(l,l.next,i)<0}function ft(l,i,s,a,r){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-s)*r)|l<<8))|l<<4))|l<<2))|l<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-a)*r)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function vt(l,i){return l.x===i.x&&l.y===i.y}function Wt(l,i){return l.x-i.x}function At(l,i,s,a){let r=l;do{const f=r.prev,x=r.next.next;!vt(f,x)&&H(f,r,r.next,x)&&Et(f,x)&&Et(x,f)&&(i.push(f.index/s+a),i.push(r.index/s+a),i.push(x.index/s+a),C(r),C(r.next),r=l=x),r=r.next}while(r!==l);return r}function St(l,i,s,a,r,f,x){let g=l;do{let v=g.next.next;for(;v!==g.prev;){if(g.index!==v.index&&Xt(g,v)){let F=c(g,v);return g=R(g,g.next),F=R(F,F.next),M(g,i,s,a,r,f,x,0),void M(F,i,s,a,r,f,x,0)}v=v.next}g=g.next}while(g!==l)}function Xt(l,i){return l.next.index!==i.index&&l.prev.index!==i.index&&!function(l,i){let s=l;do{if(s.index!==l.index&&s.next.index!==l.index&&s.index!==i.index&&s.next.index!==i.index&&H(s,s.next,l,i))return!0;s=s.next}while(s!==l);return!1}(l,i)&&Et(l,i)&&Et(i,l)&&function(l,i){let s=l,a=!1;const r=(l.x+i.x)/2,f=(l.y+i.y)/2;do{s.y>f!=s.next.y>f&&s.next.y!==s.y&&r<(s.next.x-s.x)*(f-s.y)/(s.next.y-s.y)+s.x&&(a=!a),s=s.next}while(s!==l);return a}(l,i)}function c(l,i){const s=L.create(l.index,l.x,l.y),a=L.create(i.index,i.x,i.y),r=l.next,f=i.prev;return l.next=i,i.prev=l,s.next=r,r.prev=s,a.next=s,s.prev=a,f.next=a,a.prev=f,a}class L{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(i,s,a){const r=j<T.length?T[j++]:new L;return r.index=i,r.x=s,r.y=a,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const T=new Array;let j=0;for(let l=0;l<8096;l++)T.push(new L);const it=new N.b(0,0,0,1,0),mt=new N.b(0,0,0,1,0);function dt(l,i,s){let a=0;for(let r=1;r<s;r++){const f=l[2*(i+r-1)],x=l[2*(i+r-1)+1];a+=(l[2*(i+r)]-f)*(l[2*(i+r)+1]+x)}return a}function rt(l,i,s,a,r){let f=0;for(let g=s;g<a;g+=3){const v=2*(l.getValue(g)-r),F=2*(l.getValue(g+1)-r),G=2*(l.getValue(g+2)-r);f+=Math.abs((i[v]-i[G])*(i[F+1]-i[v+1])-(i[v]-i[F])*(i[G+1]-i[v+1]))}return f}it.setExtent(d.I_),mt.setExtent(d.I_);var It=_(67201),Mt=_(63537);const Dt=l=>class extends l{constructor(...i){super(...i),this.tessellationProperties={},this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},this.geometryType=q.LW.LINE}writeGeometry(i,s,a,r){this._writeGeometry(i,s,a,r)}_initializeTessellator(i){const s=st.a.load(this._materialKey),a=st.dk.load(this._materialKey),r=this._tessellationOptions,f=s.vvSizeFieldStops||s.vvSizeMinMaxValue||s.vvSizeScaleStops||s.vvSizeUnitValue,x=this.tessellationProperties._halfWidth<d.tQ&&!i&&!f;this.tessellationProperties.minMaxZoom=this._minMaxZoom,r.wrapDistance=65535,r.textured=this._isDashed||this._hasPattern,r.offset=this.tessellationProperties.offset,r.halfWidth=this.tessellationProperties._halfWidth;const g=x?0:1,v=a.outlinedFill?Gt:Kt;this._lineTessellator=new Mt.z(v(this.tessellationProperties,g,g),se(this.tessellationProperties),x)}_write(i,s,a){const r="esriGeometryPoint"===s.geometryType;i.recordStart(s.getDisplayId(),this._materialKey,this.geometryType,r),this._writeGeometry(i,s,a,r),i.recordEnd()}_writeGeometry(i,s,a,r){const f=null!=a?a:s.readLegacyGeometryForDisplay(),x=this._getLines(f,r);(0,n.Wi)(x)||this._writeVertices(i,s,x)}_getLines(i,s){if((0,n.Wi)(i))return null;const a=i.paths||i.rings;return(0,n.Wi)(a)?null:function(l,i){mt.setPixelMargin(i);const s=mt,a=-i,r=d.I_+i;let f=[],x=!1,g=0;for(;g<l.length;){const v=[],F=l[g];if(!F)return null;s.reset(2);let[G,ot]=F[0];if(x)s.moveTo(G,ot);else{if(G<a||G>r||ot<a||ot>r){x=!0;continue}v.push({x:G,y:ot})}let ht=!1;const X=F.length;for(let k=1;k<X;++k)if(G+=F[k][0],ot+=F[k][1],x)s.lineTo(G,ot);else{if(G<a||G>r||ot<a||ot>r){ht=!0;break}v.push({x:G,y:ot})}if(ht)x=!0;else{if(x){const k=s.resultWithStarts();if(k)for(const xt of k)f.push(xt)}else f.push({line:v,start:0});g++,x=!1}}return f=f.filter(v=>v.line.length>1),0===f.length?null:f}(a,s?256:16)}_writeVertices(i,s,a){const r=s.getDisplayId(),f=i.vertexCount(),x=this.tessellationProperties,g=this._tessellationOptions;x.out=i,x.id=r,x.indexCount=0,x.vertexCount=0,x.offset=f,g.capType=this._capType,g.joinType=this._joinType;const v=st.dk.load(this._materialKey);this.tessellationProperties.key=v.outlinedFill?v:st.a.load(this._materialKey);for(const{line:F,start:G}of a)g.initialDistance=G%65535,this._lineTessellator.tessellate(F,g)}},Kt=(l,i,s)=>(a,r,f,x,g,v,F,G,ot,ht,X)=>{const k=(0,W.UJ)(X,Math.ceil(16*l._halfWidth)),xt=(0,W.Jz)(Math.round(16*F),Math.round(16*G),Math.round(16*ot),Math.round(16*ht)),lt=(0,W.Jz)(16*g,16*v,0,l._bitset),ut=l.out;return ut.vertexBounds(a,r,i,s),ut.vertexWrite((0,W.UJ)(8*a,8*r)),ut.vertexWrite(l.id),ut.vertexWrite(l._fillColor),ut.vertexWrite(xt),ut.vertexWrite(k),ut.vertexWrite(l._tl),ut.vertexWrite(l._br),ut.vertexWrite(lt),ut.vertexWrite((0,W.UJ)(Math.ceil(16*l._halfReferenceWidth),0)),ut.vertexWrite(l.minMaxZoom),ut.vertexEnd(),l.offset+l.vertexCount++},Gt=(l,i,s)=>(a,r,f,x,g,v,F,G,ot,ht,X)=>{const k=(0,W.Jz)(0,0,16*l._halfWidth,16*l._halfReferenceWidth),xt=(0,W.Jz)(16*F+128,16*G+128,16*ot+128,16*ht+128),lt=l.out,ut=l._bitset<<24|l.id;return lt.vertexBounds(a,r,i,s),lt.vertexWrite((0,W.UJ)(8*a,8*r)),lt.vertexWrite(ut),lt.vertexWrite(l._fillColor),l.key.simple||(lt.vertexWrite(0),lt.vertexWrite(0)),lt.vertexWrite(k),lt.vertexWrite(xt),l.key.simple||lt.vertexWrite(l.minMaxZoom),lt.vertexEnd(),l.offset+l.vertexCount++},se=l=>(i,s,a)=>{const r=l.out;r.indexWrite(i),r.indexWrite(s),r.indexWrite(a),l.indexCount+=3};var Yt=_(82530);const oe=A.Z.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");class jt extends(Dt(Yt.Z)){constructor(i,s,a,r,f,x,g,v,F,G,ot,ht,X,k,xt,lt,ut,Pt,zt){super();const Bt=st.a.load(i);s&&(Bt.sdf=s.sdf,Bt.pattern=!0,Bt.textureBinding=s.textureBinding),this._capType=r,this._joinType=f,this._miterLimitCosine=(0,u.NW)(x),this.tessellationProperties._fillColor=g,this.tessellationProperties._tl=v,this.tessellationProperties._br=F,this._hasPattern=G,this._isDashed=ot,this._zOrder=lt,this._effects=ut,this._minMaxZoom=(0,W.UJ)(Math.round(Pt*d.MI),Math.round(zt*d.MI)),this._materialKey=Bt.data;const Nt=(X?d.Uh:0)|(k?d.SD:0)|(ht?d._6:0);this.tessellationProperties._bitset=Nt,this.tessellationProperties._halfWidth=.5*a,this.tessellationProperties._halfReferenceWidth=.5*xt,this.tessellationProperties.offset=0,this._initializeTessellator(!1)}static fromCIMLine(i,s,a){const r=i.color,f=i.scaleFactor||1,x=!!i.dashTemplate;let g=i.cap;x&&1===g&&(g=2);const v=i.join,F=(0,D.F2)(i.width)*f,G=(0,D.F2)(i.referenceWidth),ot=(0,D.F2)(i.miterLimit),ht=r&&(0,p.t2)(r)||0,[X,k]=(0,u._f)(i.scaleInfo,a);if(!s)return new jt(i.materialKey,s,F,g,v,ot,ht,0,0,!1,x,i.scaleDash,i.colorLocked,!1,G,i.zOrder,i.effects,X,k);const{rect:lt,width:ut,height:Pt}=s,zt=lt.x+d.fL,Bt=lt.y+d.fL,Nt=zt+ut,te=Bt+Pt,ee=(0,W.UJ)(zt,Bt),ie=(0,W.UJ)(Nt,te);return new jt(i.materialKey,s,F,g,v,ot,ht,ee,ie,!0,x,i.scaleDash,i.colorLocked,!1,G,i.zOrder,i.effects,X,k)}static fromFillOutline(i){var s;return i.isOutlinedFill&&i.outline&&"esriSLSSolid"===(null==(s=i.outline)?void 0:s.style)?jt.fromSimpleLine(ne({hash:"",materialKey:i.materialKey},i.outline),null,!0):null}static fromSimpleLine(i,s,a=!1){const{color:r}=i,f="esriSLSSolid"!==i.style&&"esriSLSNull"!==i.style,x=(0,It.ws)(i.cap||"round"),g=(0,It.xV)(i.join||"round");let v=r&&"esriSLSNull"!==i.style&&(0,p.aH)(r)||0;"esriSLSNull"===i.style&&(v=0);const F=(0,D.F2)(i.width),G=i.miterLimit;if(!s)return new jt(i.materialKey,s,F,x,g,G,v,0,0,!1,f,!0,!1,a,F,0,null,u.Xe,u.eW);const{rect:ot,width:ht,height:X}=s,k=ot.x+d.fL,xt=ot.y+d.fL,lt=k+ht,ut=xt+X,Pt=(0,W.UJ)(k,xt),zt=(0,W.UJ)(lt,ut);return new jt(i.materialKey,s,F,x,g,G,v,Pt,zt,!0,f,!0,!1,a,F,0,null,u.Xe,u.eW)}static fromPictureLineSymbol(i,s,a,r){return oe.error("PictureLineSymbol support does not exist!"),null}}const $t=l=>class extends l{constructor(...i){super(...i),this.forceLibtess=!1,this._bitset=0,this._lineTemplate=null,this.geometryType=q.LW.FILL}_maybeAddLineTemplate(i){this._lineTemplate=jt.fromFillOutline(i)}_write(i,s,a){const r="esriGeometryPoint"===s.geometryType,f=st.dk.load(this._materialKey);i.recordStart(s.getDisplayId(),this._materialKey,this.geometryType,r),this._writeGeometry(i,s,f,a,r),f.outlinedFill&&(0,n.pC)(this._lineTemplate)&&this._lineTemplate.writeGeometry(i,s,a,r),i.recordEnd()}_writeGeometry(i,s,a,r,f){const x=this._getGeometry(s,r,f);if((0,n.Wi)(x))return;const g=i.indexCount();if(!(x.maxLength>100)&&!this.forceLibtess&&function(l,i){const{coords:s,lengths:a,hasIndeterminateRingOrder:r}=i,f=l.indexWriter(),x=l.vertexCount();if(r)return!1;const g=f.length;let v=0;for(let F=0;F<a.length;){let G=F,ot=a[F],ht=dt(s,v,ot);const X=[];for(;++G<a.length;){const ut=a[G],Pt=dt(s,v+ot,ut);if(!(Pt>0))break;ht+=Pt,X.push(v+ot),ot+=ut}const k=f.length;O(f,s,v,v+ot,X,2,x);const xt=rt(f,s,k,f.length,x),lt=Math.abs(ht);if(Math.abs((xt-lt)/Math.max(1e-7,lt))>1e-5)return f.seek(g),!1;F=G,v+=ot}return!0}(i,x))return void(g!==i.indexCount()&&this._writeVertices(i,s,x.coords,x.lengths,a));const v=function(l,i){const s=l.indexWriter(),a=l.vertexCount(),{coords:r,lengths:f}=i,{buffer:x,vertexCount:g}=(0,I.b)(r,f);s.ensureSize(g);for(let v=0;v<g;v++)s.push(v+a);return x}(i,x);g!==i.indexCount()&&this._writeVertices(i,s,v,[v.length/2],a)}_writeVertices(i,s,a,r,f){const x=s.getDisplayId(),g=this._bitset<<24|x;let v=0;const F=r.reduce((ot,ht)=>ot+ht),G=f.dotDensity?4:10;i.vertexEnsureSize(G*F);for(const ot of r){const ht=ot+v;for(let X=v;X<ht;X++){const k=a[2*X],xt=a[2*X+1],lt=(0,W.UJ)(1*k,1*xt);i.vertexBounds(k,xt,0,0),i.vertexWrite(lt),i.vertexWrite(g),f.dotDensity?i.vertexWriteF32(1/Math.abs(s.readGeometryArea())):(i.vertexWrite(this.fillColor),f.simple||(i.vertexWrite(this.tl),i.vertexWrite(this.br)),i.vertexWrite(this.aux2),i.vertexWrite(this.aux3),f.simple||i.vertexWrite(this._minMaxZoom))}v+=ot}}_getGeometry(i,s,a){const r=s?(0,h.oB)((0,h.GH)(s),2):i.readGeometryForDisplay();return r?function(l,i){if((0,n.Wi)(l))return null;if(!function(l,i,s){let a=0;for(let r=0;r<l.lengths.length;r++){const f=l.lengths[r];for(let x=0;x<f;x++){const g=l.coords[2*(x+a)],v=l.coords[2*(x+a)+1];if(g<i||g>s||v<i||v>s)return!0}a+=f}return!1}(l,-128,d.I_+128))return l;it.setPixelMargin(i),it.reset(3);let s=0;for(let x=0;x<l.lengths.length;x++){const g=l.lengths[x];let v=l.coords[2*(0+s)],F=l.coords[2*(0+s)+1];it.moveTo(v,F);for(let G=1;G<g;G++)v=l.coords[2*(G+s)],F=l.coords[2*(G+s)+1],it.lineTo(v,F);it.close(),s+=g}const a=it.result(!1);if(!a)return null;const r=[],f=[];for(const x of a){let g=0;for(const v of x)f.push(v.x),f.push(v.y),g++;r.push(g)}return new J.Z(r,f)}(r,a?256:8):null}};var Zt=_(77600),de=_(56314);const Me=A.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");class le extends Yt.Z{constructor(i){super(),this._ongoingMaterialRequestMap=new Map,this._materialCache=new Map,this._dynamicPropertyMap=new Map,this._cimLayer=i}analyze(i,s,a,r,f){if(f&&0===f.length)return null;const x=f&&f.length>0,g=s.readLegacyFeature(),v=this._materialCache,F=this._cimLayer.materialHash;if(!F)return Me.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const G="function"==typeof F?F(g,a,r):F;if(v.has(G)){const Pt=v.get(G);return Promise.resolve(Pt)}const ot=this._ongoingMaterialRequestMap.get(G);if(ot)return ot;const ht=this._cimLayer,X=(0,Zt.S)(ht.cim,this._cimLayer.materialOverrides);X.mosaicHash=G;const{type:k,url:xt}=ht,lt={cim:X,type:k,mosaicHash:G,url:xt,size:null,dashTemplate:null,text:null,fontName:null};switch(k){case"marker":lt.size=(0,de.hf)(ht.size,g,a,r);break;case"line":lt.dashTemplate=ht.dashTemplate;break;case"text":lt.text=(0,de.hf)(ht.text,g,a,r),lt.fontName=(0,de.hf)(ht.fontName,g,a,r)}const ut=i.getMosaicItem(lt,f).then(Pt=>(x||(this._ongoingMaterialRequestMap.delete(G),v.set(G,Pt)),Pt)).catch(Pt=>(this._ongoingMaterialRequestMap.delete(G),Me.error(".analyze()",Pt.message),null));return x||this._ongoingMaterialRequestMap.set(G,ut),ut}}var kt=_(81476);class _e extends($t(le)){constructor(i,s,a){var r;if(super(i),this._minMaxZoom=(0,W.UJ)(Math.round(s*d.MI),Math.round(a*d.MI)),(0,u.mf)(i.color)){const lt=(ut,Pt,zt)=>{const Bt=i.color(ut,Pt,zt);return Bt&&(0,p.t2)(Bt)||0};this._dynamicPropertyMap.set("fillColor",lt)}else{const lt=i.color;this.fillColor=lt&&(0,p.t2)(lt)||0}let f=0;(0,u.mf)(i.height)||(f=i.height||0);const x="CIMMarkerPlacementInsidePolygon"===(null==(r=i.cim.placement)?void 0:r.type)&&i.cim.placement.shiftOddRows?2:1;this._dynamicPropertyMap.set("_height",(lt,ut,Pt)=>(0,u.mf)(i.height)?i.height(lt,ut,Pt)*x:f*x);let v=0;(0,u.mf)(i.offsetX)||(v=(0,D.F2)(i.offsetX||0)+128,v>255&&(v=255));this._dynamicPropertyMap.set("_offsetX",(lt,ut,Pt)=>{if((0,u.mf)(i.offsetX)){let zt=(0,D.F2)(i.offsetX(lt,ut,Pt))+128;return zt>255&&(zt=255),zt}return v});let G=1;(0,u.mf)(i.scaleX)||(G=i.scaleX||1);this._dynamicPropertyMap.set("_scaleX",(lt,ut,Pt)=>(0,u.mf)(i.scaleX)?i.scaleX(lt,ut,Pt):G);let ht=0;(0,u.mf)(i.offsetY)||(ht=(0,D.F2)(-i.offsetY||0)+128,ht>255&&(ht=255));this._dynamicPropertyMap.set("_offsetY",(lt,ut,Pt)=>{if((0,u.mf)(i.offsetY)){let zt=(0,D.F2)(-i.offsetY(lt,ut,Pt))+128;return zt>255&&(zt=255),zt}return ht});let k=0;(0,u.mf)(i.angle)||(k=(0,B.Or)(i.angle)||0);this._dynamicPropertyMap.set("_angle",(lt,ut,Pt)=>(0,u.mf)(i.angle)?(0,B.Or)(i.angle(lt,ut,Pt)):k),this._effects=i.effects,this._cimFillLayer=i,this._fillMaterialKey=st.dk.load(i.materialKey)}static fromCIMFill(i,s){const[a,r]=(0,u._f)(i.scaleInfo,s);return new _e(i,a,r)}bindFeature(i,s,a){const r=i.readLegacyFeature();this._dynamicPropertyMap.forEach((G,ot)=>{this[ot]=G(r,s,a)});const f=this._fillMaterialKey,x=this._materialCache,g=(0,this._cimFillLayer.materialHash)(r,s,a),v=x.get(g);let F=null;if(v&&(0,kt.ok)(v.spriteMosaicItem)&&(F=v.spriteMosaicItem),F){const{rect:G,width:ot,height:ht}=F,X=G.x+d.fL,k=G.y+d.fL,xt=X+ot,lt=k+ht;let ut=Math.round((0,D.F2)(this._height));ut>255?ut=255:ut<=0&&(ut=lt-k);let Pt=Math.round((0,D.F2)(this._height/ht*ot||0));Pt>255?Pt=255:Pt<=0&&(Pt=xt-X);const zt=this._scaleX,Bt=1;this.tl=(0,W.UJ)(X,k),this.br=(0,W.UJ)(xt,lt),this.aux2=(0,W.Jz)(Pt,ut,this._offsetX,this._offsetY),this.aux3=(0,W.Jz)(zt,Bt,this._angle,0),f.sdf=F.sdf,f.pattern=!0,f.textureBinding=F.textureBinding}else this.tl=0,this.br=0,this.aux2=0,this.aux3=0,f.sdf=!1,f.pattern=!1,f.textureBinding=0;this._materialKey=f.data}}class xe extends(Dt(le)){constructor(i,s,a){super(i),this._minMaxZoom=(0,W.UJ)(Math.round(s*d.MI),Math.round(a*d.MI)),this._cimLineLayer=i;let r=0;(0,u.mf)(i.width)||(r=.5*(0,D.F2)(i.width));if(this._dynamicPropertyMap.set("_halfWidth",(x,g,v)=>(0,u.mf)(i.width)?.5*(0,D.F2)(i.width(x,g,v)):r),(0,u.mf)(i.cap)?this._dynamicPropertyMap.set("_capType",i.cap):this._capType=i.cap,(0,u.mf)(i.join)?this._dynamicPropertyMap.set("_joinType",i.join):this._joinType=i.join,(0,u.mf)(i.color)){const x=(g,v,F)=>{const G=i.color(g,v,F);return G&&(0,p.t2)(G)||0};this._dynamicPropertyMap.set("_fillColor",x)}else{const x=i.color;this._fillColor=x&&(0,p.t2)(x)||0}if((0,u.mf)(i.miterLimit)){const x=(g,v,F)=>(0,u.NW)(i.miterLimit(g,v,F));this._dynamicPropertyMap.set("_miterLimitCosine",x)}else this._miterLimitCosine=(0,u.NW)(i.miterLimit);this._scaleFactor=i.scaleFactor||1,this._isDashed=null!=i.dashTemplate,this._effects=i.effects,this.tessellationProperties._bitset=(i.colorLocked?1:0)|(i.scaleDash?1:0)<<1,this._materialKey=i.materialKey,this._initializeTessellator(!0)}static fromCIMLine(i,s){const[a,r]=(0,u._f)(i.scaleInfo,s);return new xe(i,a,r)}bindFeature(i,s,a){const r=i.readLegacyFeature();this._dynamicPropertyMap.forEach((G,ot)=>{this[ot]=G(r,s,a)}),this._halfWidth*=this._scaleFactor;const f=this._materialCache,x=(0,this._cimLineLayer.materialHash)(r,s,a),g=f.get(x);let v=null;if(g&&(0,kt.ok)(g.spriteMosaicItem)&&(v=g.spriteMosaicItem),v){this._hasPattern=!0;const{rect:G,width:ot,height:ht}=v,X=G.x+d.fL,k=G.y+d.fL,xt=X+ot,lt=k+ht;this.tessellationProperties._tl=(0,W.UJ)(X,k),this.tessellationProperties._br=(0,W.UJ)(xt,lt)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const F=st.a.load(this._materialKey);v&&(F.sdf=v.sdf,F.pattern=!0,F.textureBinding=v.textureBinding),this._materialKey=F.data}}var Ce=_(63319),De=_(74181),Oe=_(84440);const Be=(0,De.c)(),Re=(0,Ce.c)(),Fe=A.Z.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");class ye extends((0,Oe.Z)(le)){constructor(i,s,a){if(super(i),this._cimMarkerLayer=i,this._minMaxZoom=(0,W.UJ)(Math.round(s*d.MI),Math.round(a*d.MI)),(0,u.mf)(i.color)){const r=(f,x,g)=>(0,p.t2)(i.color(f,x,g));this._dynamicPropertyMap.set("_fillColor",r)}else this._fillColor=(0,p.t2)(i.color);if((0,u.mf)(i.outlineColor)){const r=(f,x,g)=>(0,p.t2)(i.outlineColor(f,x,g));this._dynamicPropertyMap.set("_outlineColor",r)}else this._outlineColor=(0,p.t2)(i.outlineColor);if((0,u.mf)(i.size)){const r=(f,x,g)=>(0,D.F2)(i.size(f,x,g));this._dynamicPropertyMap.set("_size",r)}else this._size=(0,D.F2)(i.size)||0;if((0,u.mf)(i.scaleX)?this._dynamicPropertyMap.set("_scaleX",i.scaleX):this._scaleX=i.scaleX||1,(0,u.mf)(i.offsetX)){const r=(f,x,g)=>(0,D.F2)(i.offsetX(f,x,g));this._dynamicPropertyMap.set("xOffset",r)}else this.xOffset=(0,D.F2)(i.offsetX)||0;if((0,u.mf)(i.offsetY)){const r=(f,x,g)=>(0,D.F2)(i.offsetY(f,x,g));this._dynamicPropertyMap.set("yOffset",r)}else this.yOffset=(0,D.F2)(i.offsetY)||0;if((0,u.mf)(i.outlineWidth)){const r=(f,x,g)=>(0,D.F2)(i.outlineWidth(f,x,g));this._dynamicPropertyMap.set("_outlineWidth",r)}else this._outlineWidth=(0,D.F2)(i.outlineWidth)||0;(0,u.mf)(i.rotation)?this._dynamicPropertyMap.set("_angle",i.rotation):this._angle=i.rotation||0,this._scaleFactor=(0,n.Pt)(i.scaleFactor,1),this._markerPlacement=i.markerPlacement,this._effects=i.effects,this._bitSet=(1===i.alignment?1:0)|(i.colorLocked?1:0)<<1|(i.scaleSymbolsProportionally?1:0)<<3,this._materialKey=i.materialKey}static fromCIMMarker(i,s){const[a,r]=(0,u._f)(i.scaleInfo,s);return new ye(i,a,r)}bindFeature(i,s,a){const r=i.readLegacyFeature();this._dynamicPropertyMap.forEach((Je,He)=>{this[He]=Je(r,s,a)});const f=this._cimMarkerLayer.materialHash,x="function"==typeof f?f(r,s,a):f,g=this._materialCache.get(x);if(!g||!(0,kt.ok)(g.spriteMosaicItem)||!g.spriteMosaicItem)return void Fe.error(new at.Z("mapview-cim","Encountered an error when binding feature"));const v=g.spriteMosaicItem,F=this._cimMarkerLayer.sizeRatio,G=v.width/v.height*this._scaleX,ot=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle;let ht=this._size,X=ht*G;const k=this.xOffset,xt=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;const lt=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/(0,D.F2)(this._cimMarkerLayer.frameHeight):1,ut=this._outlineWidth*lt,Pt=(0,D.F2)(this._cimMarkerLayer.referenceSize);let zt=0,Bt=0;const Nt=this._cimMarkerLayer.anchorPoint;Nt&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(zt=-Nt.x/(this._size*G),Bt=Nt.y/this._size):(zt=Nt.x,Bt=Nt.y)),this._sizeOutlineWidth=(0,W.Jz)(Math.round(Math.min(Math.sqrt(128*X),255)),Math.round(Math.min(Math.sqrt(128*ht),255)),Math.round(Math.min(Math.sqrt(128*ut),255)),Math.round(Math.min(Math.sqrt(128*Pt),255))),this.angle=ot;const te=Math.round(64*F);this._bitestAndDistRatio=(0,W.UJ)(this._bitSet,te);const ee=v.rect.x+d.fL,ie=v.rect.y+d.fL,fe=ee+v.width,Se=ie+v.height;this._texUpperLeft=(0,W.UJ)(ee,ie),this._texUpperRight=(0,W.UJ)(fe,ie),this._texBottomLeft=(0,W.UJ)(ee,Se),this._texBottomRight=(0,W.UJ)(fe,Se);const me=st.mE.load(this._materialKey);me.sdf=v.sdf,me.pattern=!0,me.textureBinding=v.textureBinding,this._materialKey=me.data,this._anchorX=.5-(.5+zt)*v.width/v.width,this._anchorY=.5-(.5+Bt)*v.height/v.height,X*=F,ht*=F,X*=this._scaleFactor,ht*=this._scaleFactor,X*=v.rect.width/v.width,ht*=v.rect.height/v.height,this._computedWidth=X,this._computedHeight=ht,this._applyTransformation(Re,Be),this.xOffset=k,this.yOffset=xt}}var Le=_(48197),Ue=_(26387),Te=_(77439);class pe extends((0,Ue.Z)(le)){constructor(i,s,a){super(i),this._horizontalAlignment="center",this._verticalAlignment="middle",this._textToGlyphs=new Map,this._minMaxZoom=(0,W.UJ)(Math.round(s*d.MI),Math.round(a*d.MI));const r=i.scaleFactor||1;if(this._cimTextLayer=i,(0,u.mf)(i.color)){const X=(k,xt,lt)=>(0,p.t2)(i.color(k,xt,lt));this._dynamicPropertyMap.set("_color",X)}else this._color=(0,p.t2)(i.color);if((0,u.mf)(i.color)){const X=(k,xt,lt)=>(0,p.t2)(i.outlineColor(k,xt,lt));this._dynamicPropertyMap.set("_haloColor",X)}else this._haloColor=(0,p.t2)(i.outlineColor);let f;(0,u.mf)(i.size)||(f=Math.min(Math.round((0,D.F2)(i.size*i.sizeRatio)),127));if(this._dynamicPropertyMap.set("_size",(X,k,xt)=>(0,u.mf)(i.size)?Math.min(Math.round((0,D.F2)(i.size(X,k,xt)*i.sizeRatio)),127):f),(0,u.mf)(i.outlineSize)){const X=(k,xt,lt)=>Math.min(Math.floor(5*(0,D.F2)(i.outlineSize(k,xt,lt)*i.sizeRatio)),127);this._dynamicPropertyMap.set("_haloSize",X)}else this._haloSize=Math.min(Math.floor(5*(0,D.F2)(i.outlineSize*i.sizeRatio)),127);let g;(0,u.mf)(i.offsetX)||(g=Math.round((0,D.F2)(i.offsetX*i.sizeRatio)));let F;this._dynamicPropertyMap.set("_xOffset",(X,k,xt)=>(0,u.mf)(i.offsetX)?Math.round((0,D.F2)(i.offsetX(X,k,xt)*i.sizeRatio)):g),(0,u.mf)(i.offsetY)||(F=Math.round((0,D.F2)(i.offsetY*i.sizeRatio)));this._dynamicPropertyMap.set("_yOffset",(X,k,xt)=>(0,u.mf)(i.offsetY)?Math.round((0,D.F2)(i.offsetY(X,k,xt)*i.sizeRatio)):F),(0,u.mf)(i.angle)?this._dynamicPropertyMap.set("_angle",i.angle):this._angle=i.angle,(0,u.mf)(i.horizontalAlignment)?this._dynamicPropertyMap.set("_horizontalAlignment",i.horizontalAlignment):this._horizontalAlignment=i.horizontalAlignment,(0,u.mf)(i.verticalAlignment)?this._dynamicPropertyMap.set("_verticalAlignment",i.verticalAlignment):this._verticalAlignment=i.verticalAlignment,this._scaleFactor=r,(0,u.mf)(i.text)?this._dynamicPropertyMap.set("_text",i.text):this._text=i.text;const ot=Math.min(Math.round((0,D.F2)(i.referenceSize*i.sizeRatio)),127);this._referenceSize=Math.round(Math.sqrt(256*ot)),this._materialKey=i.materialKey;const ht=st.qr.load(this._materialKey);ht.sdf=!0,this._bitset=(1===i.alignment?1:0)|(i.colorLocked?1:0)<<1,this._materialKey=ht.data,this._decoration="none",this._lineHeight=1,this._lineWidth=512,this._textPlacement=i.markerPlacement,this._effects=i.effects,this._isCIM=!0}static fromCIMText(i,s){const[a,r]=(0,u._f)(i.scaleInfo,s);return new pe(i,a,r)}analyze(i,s,a,r){var f=()=>super.analyze,x=this;return(0,tt.Z)(function*(){const g=s.readLegacyFeature(),v=function(l,i,s,a){return"string"==typeof l.text?l.text:"function"==typeof l.text?l.text(i,s,a):""}(x._cimTextLayer,g,a,r),F=yield f().call(x,i,s,a,r,(0,Te._)(v));return F&&F.glyphMosaicItems&&x._textToGlyphs.set(v,F.glyphMosaicItems),F})()}bindFeature(i,s,a){const r=i.readLegacyFeature();if(this._dynamicPropertyMap.forEach((x,g)=>{this[g]=x(r,s,a)}),!this._text||0===this._text.length)return void(this._shapingInfo=null);this._size*=this._scaleFactor,this._scale=this._size/d.Ex,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=(0,Le.kH)(this._horizontalAlignment||"center"),this._yAlignD=(0,Le.b7)(this._verticalAlignment||"baseline");const f=this._textToGlyphs.get(this._text);this.bindTextInfo(f,!1)}}const Jt=128;class Ht extends($t(Yt.Z)){constructor(i,s,a,r,f,x,g,v,F,G,ot,ht,X,k,xt,lt){super(),this._effects=k;const ut=st.dk.load(i);s&&(ut.sdf=s.sdf,ut.pattern=!0,ut.textureBinding=s.textureBinding),this.fillColor=a,this.tl=r,this.br=f,this.aux2=(0,W.Jz)(x,g,v,F),this.aux3=(0,W.Jz)(G,ot,ht,0),this._bitset=X,this._minMaxZoom=(0,W.UJ)(Math.round(xt*d.MI),Math.round(lt*d.MI)),this._materialKey=ut.data}static fromCIMFill(i,s,a){const r=i.color,f=r&&(0,p.t2)(r)||0,x=i.materialKey,[g,v]=(0,u._f)(i.scaleInfo,a);if(!s)return new Ht(x,null,f,0,0,0,0,0,0,0,0,0,i.colorLocked?1:0,i.effects,g,v);const{rect:F,width:G,height:ot}=s,ht=i.scaleX||1,X=F.x+d.fL,k=F.y+d.fL,xt=X+G,lt=k+ot,ut=i.height,Pt=ht*ut;let zt=Math.round(ut);zt>255?zt=255:zt<=0&&(zt=lt-k);let Bt=Math.round(Pt);Bt>255?Bt=255:Bt<=0&&(Bt=xt-X);let Nt=(0,D.F2)(i.offsetX||0)+Jt;Nt>255&&(Nt=255);let te=(0,D.F2)(-i.offsetY||0)+Jt;te>255&&(te=255);const ee=(0,W.UJ)(X,k),ie=(0,W.UJ)(xt,lt);return new Ht(x,s,f,ee,ie,Bt,zt,Nt,te,Jt,Jt,(0,B.s5)(i.angle),i.colorLocked?1:0,i.effects,g,v)}static fromSimpleFill(i,s,a=!1){const{color:r}=i,f=r&&"esriSFSNull"!==i.style&&(0,p.aH)(r)||0,x=a?d.Uh:0,g=i.materialKey;let v;if(s){const{rect:F,width:G,height:ot}=s,ht=F.x+d.fL,X=F.y+d.fL,k=ht+G,xt=X+ot,lt=(0,W.UJ)(ht,X),ut=(0,W.UJ)(k,xt);v=new Ht(g,s,f,lt,ut,G,ot,0,0,Jt,Jt,0,x,null,u.Xe,u.eW)}else v=new Ht(g,null,f,0,0,0,0,0,0,0,0,0,x,null,u.Xe,u.eW);return v._maybeAddLineTemplate(i),v}static fromPictureFill(i,s,a=!1){const r=d.ru,{rect:f,width:x,height:g}=s,v=f.x+d.fL,F=f.y+d.fL,G=v+x,ot=F+g,ht=(0,W.UJ)(v,F),X=(0,W.UJ)(G,ot);let k=Math.round((0,D.F2)(i.width));k>255&&(k=255);let xt=Math.round((0,D.F2)(i.height));xt>255&&(xt=255);let lt=(0,D.F2)(i.xoffset)+Jt;lt>255&&(lt=255);let ut=(0,D.F2)(-i.yoffset)+Jt;ut>255&&(ut=255);const Pt=i.materialKey,zt=a?d.Uh:0,Bt=new Ht(Pt,s,r,ht,X,k,xt,lt,ut,Jt*i.xscale,Jt*i.yscale,0,zt,null,u.Xe,u.eW);return Bt._maybeAddLineTemplate(i),Bt}}var ce=_(38981),Ee=_(51253);class Ze{constructor(){this._resolver=null}isHeld(){return!!this._resolver}acquire(){var i=this;return(0,tt.Z)(function*(){if(!i._resolver)return i._resolver=(0,E.hh)(),Promise.resolve();yield i._resolver.promise,yield i.acquire()})()}release(){const i=this._resolver;this._resolver=null,i.resolve()}}function ge(){return(ge=(0,tt.Z)(function*(l,i,s){try{yield l.acquire(),yield i(s),l.release()}catch(a){throw l.release(),a}})).apply(this,arguments)}var ue=_(90985);const Vt=A.Z.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),We=new Array,ve={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:0},Ge=ae(ne({},U.eG),{hash:JSON.stringify(U.eG),materialKey:(0,st.jj)(q.LW.MARKER,ve)}),Ve=ae(ne({},U.wW),{hash:JSON.stringify(U.wW),materialKey:(0,st.jj)(q.LW.LINE,ve)}),je=ae(ne({},U.lj),{hash:JSON.stringify(U.lj),materialKey:(0,st.jj)(q.LW.FILL,ve)});function qt(l,i){const s=l.length;return l.push(null),i.then(a=>l[s]=a),l}function Ie(l){return!!(1&l)}class Ne{constructor(i,s){this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Ze,this._fetchResource=i,this._tileInfo=s}get _markerError(){return this._errorTemplates.marker[0]}get _fillError(){return this._errorTemplates.fill[0]}get _lineError(){return this._errorTemplates.line[0]}get _textError(){return this._errorTemplates.line[0]}createTemplateGroup(i,s){this._initErrorTemplates();const a=i.hash;if(this._symbolToTemplate.has(a))return this._symbolToTemplate.get(a);const r=new Array;s&&this._createMeshTemplates(r,s,!0),this._createMeshTemplates(r,i,!1);const f=this._createGroupId("expanded-cim"===i.type&&Xe(i));return this._idToTemplateGroup.set(f,r),this._symbolToTemplate.set(a,f),f}getTemplateGroup(i){return this._idToTemplateGroup.has(i)?this._idToTemplateGroup.get(i):We}getDynamicTemplateGroup(i){return this._idToTemplateGroup.has(i)?(Ie(i)||Vt.error("mapview-template-store",`Id ${i} does not refer to a dynamic template`),this._idToTemplateGroup.get(i)):We}getMosaicItem(i,s){const a=this._createTemplateId(),r=new Promise(f=>this._idToResolver.set(a,f));return this._fetchQueue.push({symbol:i,id:a,glyphIds:s}),r}finalize(i){return this._fetchQueue.length||this._lock.isHeld()?function(l,i,s){return ge.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),i):Promise.resolve()}_initErrorTemplates(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],je,!1),marker:this._createMeshTemplates([],Ge,!1),line:this._createMeshTemplates([],Ve,!1)})}_fetchAllQueuedResources(i){if(!this._fetchQueue.length)return Promise.resolve();const s=this._fetchQueue,a=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(a).then(()=>this._fetchResource(s,i).then(r=>{for(const{id:f,mosaicItem:x}of r)this._idToResolver.get(f)(x),this._idToResolver.delete(f)})).catch(r=>{(0,E.D_)(r)?this._fetchQueue=this._fetchQueue.concat(s):"worker:port-closed"===r.name||Vt.error(new at.Z("mapview-template-store","Unable to fetch requested texture resources",r))})}_createGroupId(i){return this._idCounter++<<1|(i?1:0)}_createTemplateId(){return this._templateIdCounter++}_createSMS(i){var s=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:a}=yield s.getMosaicItem(i);return(0,kt.ok)(a,Vt)?ce.Z.fromSimpleMarker(i,a):s._markerError})()}_createPMS(i){var s=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:a}=yield s.getMosaicItem(i);return(0,kt.ok)(a,Vt)?ce.Z.fromPictureMarker(i,a):s._markerError})()}_createSFS(i,s){var a=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:r}=yield a.getMosaicItem(i);return(0,kt.ok)(r,Vt)?Ht.fromSimpleFill(i,r,s):a._fillError})()}_createPFS(i,s){var a=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:r}=yield a.getMosaicItem(i);return(0,kt.ok)(r,Vt)?Ht.fromPictureFill(i,r,s):a._fillError})()}_createSLS(i,s){var a=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:r}=yield a.getMosaicItem(i);return(0,kt.ok)(r,Vt)?jt.fromSimpleLine(i,r):a._lineError})()}_createLMS(i){var s=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:a}=yield s.getMosaicItem(i);return(0,kt.ok)(a,Vt)?ce.Z.fromLineSymbolMarker(i,a):s._markerError})()}_createTS(i){var s=this;return(0,tt.Z)(function*(){const{glyphMosaicItems:a}=yield s.getMosaicItem(i);return Ee.Z.fromText(i,a)})()}_createCIMText(i){var s=this;return(0,tt.Z)(function*(){const{glyphMosaicItems:a}=yield s.getMosaicItem((0,ue.xS)(i),(0,Te._)(i.text));return(0,kt.ok)(a,Vt)?Ee.Z.fromCIMText(i,a,s._tileInfo):s._textError})()}_createCIMFill(i){var s=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:a}=yield s.getMosaicItem((0,ue.xS)(i));return(0,kt.ok)(a,Vt)?Ht.fromCIMFill(i,a,s._tileInfo):s._fillError})()}_createCIMLine(i){var s=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:a}=yield s.getMosaicItem((0,ue.xS)(i));return(0,kt.ok)(a,Vt)?jt.fromCIMLine(i,a,s._tileInfo):s._lineError})()}_createCIMMarker(i){var s=this;return(0,tt.Z)(function*(){const{spriteMosaicItem:a}=yield s.getMosaicItem((0,ue.xS)(i));return(0,kt.ok)(a,Vt)?ce.Z.fromCIMMarker(i,a,s._tileInfo):s._markerError})()}_createCIM(i){var s=this;return(0,tt.Z)(function*(){const a=i.templateHash;if(s._cimTemplateCache.has(a))return s._cimTemplateCache.get(a);let r;switch(i.type){case"marker":r=s._createCIMMarker(i);break;case"line":r=s._createCIMLine(i);break;case"fill":r=s._createCIMFill(i);break;case"text":r=s._createCIMText(i)}return r.then(f=>s._cimTemplateCache.set(a,f)),r})()}_createDynamicCIM(i){const s=i.templateHash;if(this._cimTemplateCache.has(s))return this._cimTemplateCache.get(s);let a;switch(i.type){case"marker":a=ye.fromCIMMarker(i,this._tileInfo);break;case"line":a=xe.fromCIMLine(i,this._tileInfo);break;case"fill":a=_e.fromCIMFill(i,this._tileInfo);break;case"text":a=pe.fromCIMText(i,this._tileInfo)}return this._cimTemplateCache.set(s,a),a}_createPrimitiveMeshTemplates(i,s,a){switch(s.type){case"esriSMS":return qt(i,this._createSMS(s));case"esriPMS":return qt(i,this._createPMS(s));case"esriSFS":return qt(i,this._createSFS(s,a));case"line-marker":return qt(i,this._createLMS(s));case"esriPFS":return qt(i,this._createPFS(s,a));case"esriSLS":return qt(i,this._createSLS(s,!1));case"esriTS":return qt(i,this._createTS(s));default:return Vt.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),i}}_createMeshTemplates(i,s,a){if(-1!==s.type.indexOf("3d"))return Vt.error("3D symbols are not supported with MapView"),i;if("expanded-cim"===s.type){for(const r of s.layers)"function"==typeof r.materialHash?i.push(this._createDynamicCIM(r)):qt(i,this._createCIM(r));return i}if("composite-symbol"===s.type){for(const r of s.layers)this._createPrimitiveMeshTemplates(i,r,a);return i}return"cim"===s.type||"label"===s.type||"web-style"===s.type?i:this._createPrimitiveMeshTemplates(i,s,a)}}const Xe=l=>{if(!l.layers)return!1;for(const i of l.layers)if("function"==typeof i.materialHash)return!0;return!1}},51253:(bt,yt,_)=>{_.d(yt,{Z:()=>W});var tt=_(40295),at=_(75244),A=_(48197),E=_(20727),U=_(30603),q=_(47677),st=_(23155),D=_(28852),p=_(26387),d=_(82530);class W extends((0,p.Z)(d.Z)){constructor(n,h,y,I,J,N,O,V,R,M,z,P,S,C,b,ct,_t,w,m=!1,Q,et){super(),this._xOffset=(0,at.F2)(S),this._yOffset=(0,at.F2)(C),this._decoration=M||"none",this._color=J,this._haloColor=N,this._haloSize=Math.min(Math.floor(5*(0,at.F2)((0,at.t_)(y))),127),this._size=Math.min(Math.round((0,at.F2)(h)),127);const H=Math.min(Math.round((0,at.F2)(I||h)),127);this._referenceSize=Math.round(Math.sqrt(256*H)),this._scale=this._size/U.Ex,this._angle=P,this._justify=(0,A.Hd)(O||"center"),this._xAlignD=(0,A.kH)(O||"center"),this._yAlignD=(0,A.b7)(V||"baseline"),this._baseline="baseline"===(V||"baseline"),this._bitset=(1===R?1:0)|(z?1:0)<<1;const nt=st.m2.load(n);nt.sdf=!0,this._materialKey=nt.data,this._lineWidth=(0,at.F2)(b)||512,this._lineHeight=ct||1,this._textPlacement=_t,this._effects=w,this._isCIM=m,this._minMaxZoom=(0,q.UJ)(Math.round(Q*U.MI),Math.round(et*U.MI))}static fromText(n,h){const y=new W(n.materialKey,n.font.size,n.haloSize||0,n.font.size,n.color&&(0,E.aH)(n.color)||0,n.haloColor&&(0,E.aH)(n.haloColor)||0,n.horizontalAlignment,n.verticalAlignment,0,n.font.decoration,!1,n.angle||0,n.xoffset,n.yoffset,n.lineWidth,n.lineHeight,null,null,!1,D.Xe,D.eW),[,I]=(0,tt.E)(n.text);return y.bindTextInfo(h,I),y._vertexBoundsScale=n.maxVVSize?n.maxVVSize/n.font.size:1,y}static fromCIMText(n,h,y){const I=n.scaleFactor||1,J=n.size*n.sizeRatio*I,[N,O]=(0,D._f)(n.scaleInfo,y),V=new W(n.materialKey,J,n.outlineSize*n.sizeRatio,n.referenceSize,(0,E.t2)(n.color),(0,E.t2)(n.outlineColor),n.horizontalAlignment,n.verticalAlignment,n.alignment,n.decoration,n.colorLocked,n.angle,n.offsetX*n.sizeRatio*I,n.offsetY*n.sizeRatio*I,512,1,n.markerPlacement,n.effects,!0,N,O),[,R]=(0,tt.E)(n.text);return V.bindTextInfo(h,R),V._vertexBoundsScale=n.maxVVSize?n.maxVVSize/J:1,V}}},28852:(bt,yt,_)=>{_.d(yt,{eW:()=>at,Xe:()=>tt,TK:()=>q,NW:()=>D,_f:()=>n,mf:()=>st,Fv:()=>U,lu:()=>A});const tt=0,at=100;function A(h,y,I){return h[0]=y[0]-I[0],h[1]=y[1]-I[1],h}function E(h,y){return Math.sqrt(h*h+y*y)}function U(h){const y=E(h[0],h[1]);h[0]/=y,h[1]/=y}function q(h,y){return E(h[0]-y[0],h[1]-y[1])}function st(h){return"function"==typeof h}function D(h=2){return 1/Math.max(h,1)}function n(h,y){return[!!h.minScale&&y.scaleToZoom(h.minScale)||tt,!!h.maxScale&&y.scaleToZoom(h.maxScale)||at]}},7077:(bt,yt,_)=>{_.d(yt,{fL:()=>d});var tt=_(49996),at=_(61414),A=_(22345),E=_(72468),U=_(2999),q=_(56314),st=_(83184),D=_(90985);const p=A.Z.getLogger("esri/views/2d/engine/webgl/util/Matcher");function d(R,M,z,P){return B.apply(this,arguments)}function B(){return(B=(0,tt.Z)(function*(R,M,z,P){switch(R.type){case"simple":return W.fromBasicRenderer(R,M,z,P);case"map":return h.fromUVRenderer(R,M,z,P);case"interval":return n.fromCBRenderer(R,M,z,P);case"dictionary":return V.fromDictionaryRenderer(R,M,z,P);case"subtype":return u.fromSubtypes(R,M,z,P)}})).apply(this,arguments)}class W{constructor(){this.type="feature",this._defaultResult=null}static fromBasicRenderer(M,z,P,S){return(0,tt.Z)(function*(){const C=new W;if(M.symbol){const b=yield(0,D.B3)(M.symbol,P,S),ct=z.createTemplateGroup(b,null);C.setDefault(ct)}return C})()}size(){return 1}getDefault(){return this._defaultResult}setDefault(M){this._defaultResult=M}match(M,z,P,S,C){return this.getDefault()}analyze(M,z,P,S,C,b){return(0,tt.Z)(function*(){return null})()}}class u extends W{constructor(M,z){super(),this._subMatchers=M,this._subtypeField=z}static fromSubtypes(M,z,P,S){return(0,tt.Z)(function*(){const C=new Map,b=[];for(const ct in M.renderers){const _t=parseInt(ct,10),w=d(M.renderers[ct],z,P,S).then(m=>C.set(_t,m));b.push(w)}return yield Promise.all(b),new u(C,M.subtypeField)})()}match(M,z,P,S,C){const b=z.readAttribute(this._subtypeField),ct=this._subMatchers.get(b);return ct?ct.match(M,z,P,S,C):null}}class n extends W{constructor(M,z,P,S){super(),this.type="interval",this._intervals=[],this._isMaxInclusive=z,this._fieldIndex=S,this._field=M,this._normalizationInfo=P}static fromCBRenderer(M,z,P,S){return(0,tt.Z)(function*(){const{isMaxInclusive:C,normalizationField:b,normalizationTotal:ct,normalizationType:_t}=M,w=M.field,m=new n(w,C,{normalizationField:b,normalizationTotal:ct,normalizationType:_t},M.fieldIndex),Q=yield(0,D.B3)(M.backgroundFillSymbol,P,S);yield Promise.all(M.intervals.map(function(){var H=(0,tt.Z)(function*(nt){const pt=yield(0,D.B3)(nt.symbol,P,S),Lt=yield z.createTemplateGroup(pt,Q),Et={min:nt.min,max:nt.max};m.add(Et,Lt)});return function(nt){return H.apply(this,arguments)}}()));const et=yield(0,D.B3)(M.defaultSymbol,P,S);if(et){const H=yield z.createTemplateGroup(et,Q);m.setDefault(H)}return m})()}add(M,z){this._intervals.push({interval:M,result:z}),this._intervals.sort((P,S)=>P.interval.min-S.interval.min)}size(){return super.size()+this._intervals.length}match(M,z,P,S,C){if(null==this._fieldIndex&&!this._field)return this.getDefault();const b=null!=this._fieldIndex?z.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(z);if(!b&&(null==b||isNaN(b)))return this.getDefault();for(let ct=0;ct<this._intervals.length;ct++){const{interval:_t,result:w}=this._intervals[ct],m=b>=_t.min,Q=this._isMaxInclusive?b<=_t.max:b<_t.max;if(m&&Q)return w}return this.getDefault()}_needsNormalization(){const M=this._normalizationInfo;return M&&(M.normalizationField||M.normalizationTotal||M.normalizationType)}_getValueFromField(M){const z=M.readAttribute(this._field);if(!this._needsNormalization()||null==z)return z;const{normalizationField:P,normalizationTotal:S,normalizationType:C}=this._normalizationInfo,b=!!P&&M.readAttribute(P);if(C)switch(C){case"esriNormalizeByField":return b?z/b:void 0;case"esriNormalizeByLog":return Math.log(z)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return z/S*100;default:return void p.error(`Found unknown normalization type: ${C}`)}else p.error("Normalization is required, but no type was set!")}}class h extends W{constructor(M,z,P){super(),this.type="map",this._nullResult=null,this._resultsMap=new Map,this._fieldsIndex=P,this._fields=M,this._seperator=z||""}static fromUVRenderer(M,z,P,S){return(0,tt.Z)(function*(){const C=M.fieldDelimiter,b=[M.field];M.field2&&b.push(M.field2),M.field3&&b.push(M.field3);const ct=yield(0,D.B3)(M.backgroundFillSymbol,P,S),_t=new h(b,C,M.fieldIndex);yield Promise.all(M.map.map(function(){var m=(0,tt.Z)(function*(Q){const et=yield(0,D.B3)(Q.symbol,P,S),H=yield z.createTemplateGroup(et,ct);"<Null>"===Q.value?_t.setNullResult(H):_t.add(Q.value,H)});return function(Q){return m.apply(this,arguments)}}()));const w=yield(0,D.B3)(M.defaultSymbol,P,S);if(w){const m=yield z.createTemplateGroup(w,ct);_t.setDefault(m)}return _t})()}setNullResult(M){this._nullResult=M}add(M,z){this._resultsMap.set(M.toString(),z)}size(){return super.size()+this._resultsMap.size}match(M,z,P,S,C){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();const b=null!=this._fieldsIndex?z.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(z);if(null!==this._nullResult&&(null==b||""===b||"<Null>"===b))return this._nullResult;if(!b&&null==b)return this.getDefault();const ct=b.toString();return this._resultsMap.has(ct)?this._resultsMap.get(ct):this.getDefault()}_getValueFromFields(M){const z=[];for(const P of this._fields){const S=M.readAttribute(P);null==S||""===S?z.push("<Null>"):z.push(S)}return z.join(this._seperator)}}function I(){return(I=(0,tt.Z)(function*(R,M){const z=R||1;if("number"==typeof z)return(S,C,b)=>z;const P=yield(0,U.Yi)(z,M.spatialReference,M.fields);return(S,C,b)=>(0,st.Z)(P,S,{$view:b},M.geometryType,C)||1})).apply(this,arguments)}let J;function N(){return O.apply(this,arguments)}function O(){return(O=(0,tt.Z)(function*(){return J||(J=_.e(390).then(_.bind(_,40390))),J})).apply(this,arguments)}class V extends W{constructor(M,z,P,S,C){super(),this.type="dictionary",this._groupIdCache=new E.Z(100),this._renderer=M,this._fieldMap=M.fieldMap,this._symbolFields=M.getSymbolFields(),this._templates=z,this._info=P,this._scaleFn=S,this._schemaUtilsModule=C}static fromDictionaryRenderer(M,z,P,S){return(0,tt.Z)(function*(){const[{default:C},b]=yield Promise.all([Promise.resolve().then(_.bind(_,15206)),N()]),ct=C.fromJSON(M.renderer);yield ct.fetchResources({spatialReference:P.spatialReference,fields:P.fields});const _t=yield function(R,M){return I.apply(this,arguments)}(ct.scaleExpression,P);return new V(ct,z,P,_t,b)})()}_analyzeFeature(M,z,P,S,C){var b=this;return(0,tt.Z)(function*(){const ct=M.readLegacyFeature(),_t=b._scaleFn(ct,P,S),w=b._attributeHash(ct)+"-"+_t,m=b._groupIdCache.get(w);if(m)return m;const Q=ae(ne({},S),{spatialReference:b._info.spatialReference,abortOptions:C,fields:b._info.fields}),et=yield b._renderer.getSymbolAsync(ct,Q),H=b._schemaUtilsModule.createSymbolSchema(et,b._renderer),nt=(0,D.B3)(H,b._info,z,C).then(pt=>{if("expanded-cim"!==pt.type)return p.error(new at.Z("mapview-bad-type",`Found unexpected type ${pt.type} in dictionary response`)),null;pt.hash+="-"+_t;for(const Lt of pt.layers)Lt.scaleFactor=_t,Lt.templateHash+="-"+_t,"text"===Lt.type&&"string"==typeof Lt.text&&Lt.text.indexOf("[")>-1&&(Lt.text=(0,q.Qs)(b._fieldMap,Lt.text,Lt.cim.textCase));return b._templates.createTemplateGroup(pt,null)});return b._groupIdCache.put(w,nt,1),nt})()}analyze(M,z,P,S,C,b){var ct=this;return(0,tt.Z)(function*(){const _t=z.getCursor(),w=[];for(;_t.next();)w.push(ct._analyzeFeature(_t,P,S,C,b));return Promise.all(w)})()}match(M,z,P,S,C){return null}_attributeHash(M){let z="";for(const P of this._symbolFields){const S=this._fieldMap[P];S&&(z+=M.attributes[S]+"-")}return z}}},81476:(bt,yt,_)=>{_.d(yt,{ok:()=>at});var tt=_(61414);function at(A,E){if(A&&"name"in A){const U=A;return E&&E.error(new tt.Z(U.name,U.message,U.details)),!1}return!0}},29541:(bt,yt,_)=>{_.d(yt,{Z:()=>at});class at{constructor(E,U){this._pos=0;const q=U?this._roundToNearest(U,E.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(q),this._buffer=new E(this._array),this._ctor=E,this._i16View=new Int16Array(this._array)}get length(){return this._pos}_roundToNearest(E,U){const q=Math.round(E);return q+(U-q%U)}_ensureSize(E){if(this._pos+E>=this._buffer.length){const U=this._roundToNearest(1.25*(this._array.byteLength+E*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),q=new ArrayBuffer(U),st=new this._ctor(q);st.set(this._buffer,0),this._array=q,this._buffer=st,this._i16View=new Int16Array(this._array)}}ensureSize(E){this._ensureSize(E)}writeF32(E){this._ensureSize(1);const U=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=E,this._pos++,U}push(E){this._ensureSize(1);const U=this._pos;return this._buffer[this._pos++]=E,U}writeFixed(E){this._buffer[this._pos++]=E}setValue(E,U){this._buffer[E]=U}i1616Add(E,U,q){this._i16View[2*E]+=U,this._i16View[2*E+1]+=q}getValue(E){return this._buffer[E]}incr(E){if(this._buffer.length<E)throw new Error("Increment index overflows the target buffer");this._buffer[E]++}decr(E){this._buffer[E]--}writeRegion(E){this._ensureSize(E.length);const U=this._pos;return this._buffer.set(E,this._pos),this._pos+=E.length,U}writeManyFrom(E,U,q){this._ensureSize(q-U);for(let st=U;st!==q;st++)this.writeFixed(E._buffer[st])}buffer(){const E=this._array.slice(0,4*this._pos);return this.destroy(),E}toArray(){const E=this._array,U=[];for(let q=0;q<E.byteLength/4;q++)U.push(E[q]);return U}seek(E){this._pos=E}destroy(){this._array=null,this._buffer=null}}},66998:(bt,yt,_)=>{_.d(yt,{M:()=>A});_(65533);function A(E,U,q,st){const D=E.clone(),p=1<<D.level,d=D.col+U,B=D.row+q;return st&&d<0?(D.col=d+p,D.world-=1):d>=p?(D.col=d-p,D.world+=1):D.col=d,D.row=B,D}},77439:(bt,yt,_)=>{function tt(at){const A=new Array(at.length);for(let E=0;E<at.length;E++)A[E]=at.charCodeAt(E);return A}_.d(yt,{_:()=>tt})},90985:(bt,yt,_)=>{_.d(yt,{xS:()=>z,B3:()=>M});var tt=_(49996),at=_(77600),A=_(31620),E=_(23155);const U={marker:A.LW.MARKER,fill:A.LW.FILL,line:A.LW.LINE,text:A.LW.TEXT};class q{constructor(S,C,b,ct){const _t={minScale:null==C?void 0:C.minScale,maxScale:null==C?void 0:C.maxScale},w=(P=_t).minScale||P.maxScale?P.minScale+"-"+P.maxScale:"";var P;this.layers=S,this.data=C,this.hash=this._createHash()+w,this.rendererKey=b;const m={isOutline:!1,isOutlinedFill:!1,placement:null,stride:{fill:"default"},vvFlags:b};for(const Q of S){const et=U[Q.type];Q.materialKey=(0,E.jj)(et,m),Q.maxVVSize=ct,Q.scaleInfo=_t,Q.templateHash+=w}}get type(){return"expanded-cim"}_createHash(){let S="";for(const C of this.layers)S+=C.templateHash;return S}}var D=_(56648),p=_(61414),d=_(7808),B=_(30164),W=_(70658),u=_(26912),n=_(80415);function h(P,S,C){return y.apply(this,arguments)}function y(){return(y=(0,tt.Z)(function*(P,S,C){if(!P.name)return Promise.reject(new p.Z("style-symbol-reference-name-missing","Missing name in style symbol reference"));if(P.styleName&&"Esri2DPointSymbolsStyle"===P.styleName)return I(P,C);try{return N(yield(0,n.n2)(P,S,C),P.name,S,C)}catch(b){return(0,d.k_)(b),null}})).apply(this,arguments)}function I(P,S){return J.apply(this,arguments)}function J(){return(J=(0,tt.Z)(function*(P,S){const C=n.wm.replace(/\{SymbolName\}/gi,P.name);try{const b=yield(0,n.EJ)(C,S);return(0,n.KV)(b.data)}catch(b){return(0,d.k_)(b),null}})).apply(this,arguments)}function N(P,S,C,b){return O.apply(this,arguments)}function O(){return(O=(0,tt.Z)(function*(P,S,C,b){const ct=P.data,_t={portal:C&&C.portal||W.Z.getDefault(),url:(0,B.mN)(P.baseUrl),origin:"portal-item"},w=ct.items.find(Q=>Q.name===S);if(!w)throw new p.Z("symbolstyleutils:symbol-name-not-found",`The symbol name '${S}' could not be found`,{symbolName:S});let m=(0,u.f)((0,n.v9)(w,"cimRef"),_t);(0,D.XO)()&&(m=(0,D.pJ)(m));try{const Q=yield(0,n.EJ)(m,b);return(0,n.KV)(Q.data)}catch(Q){return(0,d.k_)(Q),null}})).apply(this,arguments)}const R=function(){var P=(0,tt.Z)(function*(S,C,b){return new q(yield(0,at.c)(S.data,C,b),S.data,S.rendererKey,S.maxVVSize)});return function(C,b,ct){return P.apply(this,arguments)}}(),M=function(){var P=(0,tt.Z)(function*(S,C,b,ct){if(!S)return null;if("cim"===S.type)return R(S,C,b);if("web-style"===S.type){const _t={type:"cim",data:yield h(S,null,ct),rendererKey:S.rendererKey,maxVVSize:S.maxVVSize};return R(_t,C,b)}return S});return function(C,b,ct,_t){return P.apply(this,arguments)}}();function z(P){if(!P)return null;const{type:S,cim:C,url:b,materialHash:ct}=P,_t={cim:C,type:S,mosaicHash:ct,url:b,size:null,dashTemplate:null,path:null,text:null,fontName:null};switch(S){case"marker":_t.size=P.size,_t.path=P.path;break;case"line":_t.dashTemplate=P.dashTemplate;break;case"text":_t.text=P.text,_t.fontName=P.fontName}return _t}}}]);
//# sourceMappingURL=5333.5d6a1e9c6b23eb0dcc76.js.map